---
title: Webpack + React + TypeScript æ„å»ºä¸€ä¸ªæ ‡å‡†åŒ–åº”ç”¨
date: 2021-08-18 22:09:02
permalink: /pages/c3ea73/
categories:
  - æ–‡ç« 
tags:
  - webpack
  - react
---

é¡¹ç›®åŠå·¥ç¨‹åŒ–é…ç½®ä»¥åŠä¸»è¦åŠŸèƒ½é…ç½®ã€è§„èŒƒåŒ–ç®¡ç†å’Œä½¿ç”¨ç»†èŠ‚åº”è¯¥éƒ½æ²¡å•¥é—®é¢˜äº†ã€‚

åé¢è‹¥å‘ç°æ„å»ºåŠé…ç½®é—®é¢˜ã€ä»¥åŠå¯ä¼˜åŒ–çš„ç»†èŠ‚éƒ¨åˆ†ã€åŒ…æ‹¬åŠŸèƒ½çš„è¿›ä¸€æ­¥è¿­ä»£ä¹Ÿä¼šä½¿é¡¹ç›®ä¸æ–­æ›´æ–°å®Œå–„çš„~

ç›®å‰ä¸»è¦æ˜¯åšäº†è§„èŒƒåŠå·¥ç¨‹åŒ–çš„é…ç½®ï¼ŒåæœŸæ‰“ç®—å¼€å‘å¹¶å¼€æºä¸€ä¸ª`react-admin`æ ‡å‡†åå°ç®¡ç†ç³»ç»Ÿï¼Œç”¨äºå®è·µå¹¶å·©å›ºä¸€äº›å‰ç«¯æŠ€æœ¯æ¡†æ¶ä¸ç»„ä»¶å¼€å‘ç­‰ã€‚

![hello](https://cdn.jsdelivr.net/gh/JS-banana/images/emoji/2.jpg)

<!-- more -->

## æ•ˆæœå›¾

æœ€ç®€å•çš„demoè¿è¡Œæ•ˆæœ

![æœ€ç»ˆæ•ˆæœ](https://cdn.jsdelivr.net/gh/JS-banana/images/vuepress/webpack-react-ts-1.gif)

## èƒŒæ™¯

ä¸ºä»€ä¹ˆè¦è‡ªå·±æ­å»ºä¸€ä¸ª`webpack-react-ts`çš„æ ‡å‡†åŒ–é¡¹ç›®ï¼Ÿ

#### åŸå› ä¹‹ä¸€

åœ¨å¾ˆæ—©ä¹‹å‰çš„å…¬å¸æ—¶ï¼Œé¡¹ç›®å®é™…å¼€å‘è¿‡ç¨‹ä¸­äº§ç”Ÿè¿‡è¿™ç§éœ€æ±‚ï¼š

1. æ¯æ¬¡å¼€å‘æ–°é¡¹ç›®æ—¶å¸Œæœ›æœ‰ä¸ªå®Œæ•´åŠŸèƒ½ã€é…ç½®å¥½ç”¨ã€æ ‡å‡†åŒ–è§„èŒƒçš„æ¨¡æ¿å¯ä»¥å¿«é€Ÿä½¿ç”¨

2. å®Œæ•´åŠŸèƒ½ï¼šå¦‚æœæ˜¯ä½¿ç”¨`create-react-app`åˆ›å»ºé¡¹ç›®ï¼Œå±äºæœ€ç®€æ˜“ç‰ˆçš„ä¸€ä¸ªå®ç°äº†ï¼Œå„ç§`loader`ã€`plugin`ã€`babel`ç­‰`webpack`é…ç½®ç¼ºå¤±ï¼Œä½œä¸ºç°ä»£å‰ç«¯å¼€å‘ä¸å¯æˆ–ç¼ºçš„æ„å»ºå·¥å…·ï¼Œå…¶å¯¹é¡¹ç›®çš„å¤§éƒ¨åˆ†åŠŸèƒ½æ”¯æŒæ˜¯å¿…é¡»çš„ã€‚

3. é…ç½®å¥½ç”¨ï¼š`webpack`å¯¹å„ç§æ’ä»¶çš„é…ç½®ä¸é›†æˆï¼ŒåŸºæœ¬è·¯ç”±æ¨¡å—ã€é¡µé¢æ¨¡å—ã€ç»„ä»¶æ¨¡å—ã€storeçŠ¶æ€ç®¡ç†æ¨¡å—ç­‰åŸºæœ¬å¸¸ç”¨åŠŸèƒ½çš„ç®€è¦ç¤ºä¾‹åŠdemoï¼Œè¦æœ‰ä¸€å®šçš„è¦†ç›–ç‡ã€‚

4. æ ‡å‡†è§„èŒƒï¼šè¿™ä¸ªå¯èƒ½æ˜¯å·¥ç¨‹åŒ–æ„å»ºæœ€é‡è¦çš„éƒ¨åˆ†ä¹‹ä¸€äº†ï¼Œ`eslint`ã€`prettier`ã€`stylelint`ã€`commitlint`ç­‰lintè§„èŒƒå’Œæ ¼å¼åŒ–ä»¥åŠtestæµ‹è¯•ï¼Œè¿˜æœ‰ç›®å½•ç»“æ„è§„èŒƒã€å‘½åè§„èŒƒç­‰ã€‚å¯¹äºè§„èŒƒåŒ–çš„æ„ä¹‰å…¶é‡è¦æ€§ä¸è¨€è€Œå–»ï¼Œå¯è¯»æ€§ã€å¯ç»´æŠ¤æ€§ã€å¼€å‘æ•ˆç‡ã€bugç‡ç­‰å¯è§ä¸€æ–‘

#### åŸå› ä¹‹äºŒ

å½“ç„¶ç½‘ä¸Šè‚¯å®šæœ‰å¾ˆå¤šä¼˜ç§€çš„è½®å­ä¾›æˆ‘ä»¬ä½¿ç”¨ï¼Œä»–ä»¬æœ‰çš„åŠŸèƒ½æ›´å…¨ã€æœ‰çš„ç»†èŠ‚æ›´å¥½ï¼Œæœ‰çš„ç¤ºä¾‹æ›´å®Œæ•´ã€‚è¿™éƒ½æ˜¯æˆ‘ä»¬å­¦ä¹ çš„æ¦œæ ·ï¼Œå¯¹äºå…¶æºç é˜…è¯»å’Œå­¦ä¹ ä¹Ÿæ˜¯æä¸ºæœ‰ç›Šçš„ï¼Œä¸è¿‡ï¼Œå§‹ç»ˆé¿å…ä¸äº†ä¸€ç‚¹ï¼Œçœ‹çš„å†å¤šéƒ½ä¸å¦‚è‡ªå·±å®è·µæ¥çš„æœ‰æ•ˆæœï¼Œæ‰€ä»¥ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘è€ƒè™‘çš„åŸå› ä¹‹ä¸€ï¼Œä¸ºäº†è‡ªå·±å®è·µå’Œæ“ä½œæ¥æå‡æŠ€æœ¯ç†Ÿç»ƒåº¦ã€‚

#### åŸå› ä¸‰

è¿™ä¹Ÿæ˜¯æºäºåœ¨å®é™…å¼€å‘è¿‡ç¨‹ä¸­çš„éœ€æ±‚ï¼Œå³ï¼Œä¸åŒæŠ€æœ¯å¹³å°åŠåœºæ™¯é€‚åº”äºä¸åŒçš„æŠ€æœ¯æ¡†æ¶å’Œè·¯çº¿ã€‚

ä¸¾ä¸ªæ —å­ï¼Œ

1. ç®¡ç†åå°ç³»ç»Ÿï¼šè¿™ä¸ªå¤šé€‚ç”¨äºPCç«¯ï¼Œä½¿ç”¨å•é¡µé¢åº”ç”¨å¼€å‘ï¼Œä¸»æµæŠ€æœ¯æ¡†æ¶ `React`ã€`Vue`ã€`Angular`ç­‰

2. ç½‘ç«™ç±»ï¼šè¿™ç±»é¡¹ç›®ä¸€èˆ¬è¿½æ±‚ç¾è§‚å’ŒSEOæœç´¢çš„é‡è¦æ€§ï¼Œè€Œä¸ä¼šåƒç®¡ç†åå°ç³»ç»Ÿä¸€æ ·æœ‰å¾ˆå¤æ‚çš„é€»è¾‘ï¼Œæ›´å¤šçš„æ˜¯ä¸€äº›åŠ¨æ•ˆåŠUIäº¤äº’ï¼Œå› ä¸º`SPA`çš„é¦–å±åŠ è½½åŠ`SEO`é—®é¢˜ï¼Œç¤¾åŒºæœ‰æˆç†Ÿçš„æœåŠ¡ç«¯æ¸²æŸ“`SSR`æ–¹æ¡ˆï¼š`next`ã€`nuxt`ï¼Œåˆ†åˆ«å¯¹åº”`react`å’Œ`vue`æŠ€æœ¯æ ˆï¼Œå¯¹äºä¹ æƒ¯äº†å•é¡µé¢å¼€å‘çš„åŒå­¦è¿˜æ˜¯å¾ˆå‹å¥½çš„ã€‚

3. ç§»åŠ¨ç«¯ï¼šè½»é‡åŒ–ã€è½»é‡åŒ–ã€è½»é‡åŒ–ï¼Œé‡è¦çš„äº‹æƒ…è¯´ä¸‰éã€‚æ‰‹æœºç«¯æµé‡ç¬¬ä¸€ï¼Œé¡¹ç›®è¶Šå°è¶Šè½»é‡æ€§èƒ½è¶Šå¥½åŠ è½½ä¹Ÿå°±è¶Šå¿«ï¼Œå¯¹äºç”¨æˆ·ä½“éªŒä¹Ÿå°±è¶Šå¥½ã€‚æ¯”è¾ƒæ‰‹æœºç«¯ä¸€èˆ¬å¯¹åº”çš„éƒ½æ˜¯Cç«¯ç”¨æˆ·ï¼Œä¸åƒç®¡ç†åå°ä¸»è¦æ˜¯ç»™Bç«¯åŠå…¬å¸å†…éƒ¨ä½¿ç”¨ã€‚ç”¨æˆ·ä½“éªŒè¦æ±‚æ˜¯å®Œå…¨ä¸ä¸€æ ·çš„ã€‚å¦‚ï¼Œç§»åŠ¨ç«¯ç‰ˆ`react`â€”â€”`preact`ï¼Œåˆå¦‚`svelte`ã€`solidjs`ç­‰æ— è™šæ‹Ÿ`DOM`æ¡†æ¶ï¼Œå‡å°‘å¤§é‡è¿è¡Œæ—¶ä»£ç ã€‚

æ‰€ä»¥ï¼Œæˆ‘è®¤ä¸ºæ¯ä¸ªæŠ€æœ¯éƒ½æœ‰å…¶å¯¹åº”çš„ä¼˜åŠ¿å’Œé€‚åˆçš„åœºæ™¯ï¼Œå•ä¸€æ¡†æ¶å¹¶ä¸æ˜¯å®Œå…¨é€‚åˆæ¢­å“ˆåˆ°åº•çš„ã€‚

è¿™ä¹Ÿæ˜¯æˆ‘å¼€å‘çš„`node-cli`è‡ªåŠ¨åŒ–åˆå§‹åŒ–é¡¹ç›®çš„ä¸€ä¸ªæ¡†æ¶æ¨¡æ¿ä¹‹ä¸€ã€‚

æ¥ä¸‹æ¥å¯¹å„ä¸ªä¸åŒæŠ€æœ¯æ–¹æ¡ˆåŠæœ€ä½³å®è·µä¹Ÿä¼šè€ƒè™‘æ„å»ºå…·æœ‰å®æˆ˜æ„ä¹‰çš„æ¨¡æ¿ä»¥ä¾›ä½¿ç”¨

ä¸»è¦æ–¹å‘å¤§æ¦‚åˆ†ä¸ºï¼š`webpack+react/vue+typescript`ç­‰`webpack`æ–¹å‘ã€`vite+react/vue+typescript`ç­‰`vite`æ–¹å‘ã€`nuxt/next/egg/koa`ç­‰æœåŠ¡ç«¯æ¸²æŸ“`SSR`æ–¹å‘ã€`svelte/solidjs`ç­‰æ— è™šæ‹Ÿ`DOM`çš„è½»é‡çº§æ¡†æ¶æ–¹å‘ã€`rollup/parcel`ç­‰æ„å»ºå·¥å…·æ–¹å‘ã€`esbuild/swc`ç­‰æ–°å‹ç¼–è¯‘å™¨ä¸æ„å»ºå·¥å…·çš„ç»“åˆä½¿ç”¨ç­‰ã€ä»¥åŠå°ç¨‹åº/è·¨å¹³å°ç­‰ã€‚

æœ‰ç‚¹é£˜å•Šï¼Œæƒ³æ³•è¿˜æŒºå¤šçš„ğŸ¤“~

## å¼€æ

### ç›®æ ‡

- æŠ€æœ¯æ ˆï¼š`Webpack5.x` + `React17.x` + `Antd4.x` + `TypeScript4.x` + `Less`
- å·¥ç¨‹è§„èŒƒ/æ ¼å¼åŒ–ï¼š`Eslint` + `Stylelint` + `Prettier` + `Commitlint`
- `ES6`ã€`JSX`ï¼Œ`Babel`æ”¯æŒ
- æ”¯æŒ`HMR`çƒ­æ›´æ–°
- æ”¯æŒä½ç‰ˆæœ¬æµè§ˆå™¨å…¼å®¹
- æ”¯æŒ`Antd`æŒ‰éœ€åŠ è½½ã€è‡ªå®šä¹‰ä¸»é¢˜ã€`css module`
- æ”¯æŒ`js`ã€`css`å‹ç¼©ã€`chunk`æ‹†åˆ†ã€`Gzip`

### ä¾èµ–

`dependencies`

```json
"dependencies": {
  "antd": "^4.16.10", // æ‡‚å¾—éƒ½æ‡‚
  "axios": "^0.21.1", // æ‡‚å¾—éƒ½æ‡‚
  "clsx": "^1.1.1", // æ¡ä»¶å¤„ç† React className ç±»å
  "core-js": "3", // ç°ä»£JSè¯­æ³•polyfillsåº“ï¼Œç”¨äºå…¼å®¹æµè§ˆå™¨åŠES6ã€ES7è¯­æ³•
  "dayjs": "^1.10.6", // æ—¥æœŸå¤„ç†åº“ï¼Œæ¯”momentå°å¾ˆå¤šï¼Œåªæœ‰å‡ kb
  "history": "^5.0.1", // H5 historyåº“
  "lodash": "^4.17.21", // éå¸¸å…¨é¢çš„æ–¹æ³•åº“
  "react": "^17.0.2", // æ‡‚å¾—éƒ½æ‡‚
  "react-dom": "^17.0.2", // æ‡‚å¾—éƒ½æ‡‚
  "react-helmet-async": "^1.0.9", // åœ¨reactä¸­ä¼˜é›…çš„æ·»åŠ  HTML header å„ç§å±æ€§
  "react-router-dom": "^5.2.0" // react è·¯ç”±åº“ï¼Œç»å…¸ react ä¸‰ä»¶å¥—
}
```

`devDependencies`

```json
"devDependencies": {
  // babel
  "@babel/cli": "^7.14.8", // å¯ä»¥è®©babelä»¥cliçš„æ–¹å¼æ‰§è¡Œ  å¦‚ï¼šbabel src --out-dir dist --watch
  "@babel/core": "^7.15.0", // babel æ ¸å¿ƒåŒ…
  "@babel/plugin-proposal-class-properties": "^7.14.5", // @babel/preset-env æ’ä»¶å·²åŒ…å«
  "@babel/plugin-syntax-dynamic-import": "^7.8.3", // åŠ¨æ€å¯¼å…¥ã€æ‡’åŠ è½½
  "@babel/plugin-transform-modules-commonjs": "^7.15.0", // è½¬åŒ–æˆCommonJS è§„èŒƒçš„ä»£ç 
  "@babel/plugin-transform-react-constant-elements": "^7.14.5", // React å¸¸é‡å…ƒç´ è½¬æ¢å™¨ : å®ƒä¼šå¯»æ‰¾ä¸éš props æ”¹å˜çš„æ‰€æœ‰é™æ€å…ƒç´ ï¼Œå¹¶å°†å®ƒä»¬ä»æ¸²æŸ“æ–¹æ³•(æˆ–è€…æ— çŠ¶æ€å‡½æ•°å¼ç»„ä»¶)ä¸­æŠ½ç¦»å‡ºæ¥ï¼Œä»¥é¿å…å¤šä½™åœ°è°ƒç”¨ createElement
  "@babel/plugin-transform-react-inline-elements": "^7.14.5", // React è¡Œå†…å…ƒç´ è½¬æ¢å™¨ : å®ƒä¼šå°†æ‰€æœ‰ JSX å£°æ˜(æˆ– è€… createElement è°ƒç”¨)æ›¿æ¢æˆä¼˜åŒ–è¿‡çš„ç‰ˆæœ¬ï¼Œä»¥ä¾¿ä»£ç å¯ä»¥æ›´å¿«æ‰§è¡Œ
  "@babel/plugin-transform-runtime": "^7.15.0", // æŠ½ç¦»æå– Babelçš„æ³¨å…¥ä»£ç ï¼Œé˜²æ­¢é‡å¤åŠ è½½ï¼Œå‡å°ä½“ç§¯
  "@babel/preset-env": "^7.15.0", // æä¾›çš„é¢„è®¾ï¼Œå…è®¸æˆ‘ä»¬ä½¿ç”¨æœ€æ–°çš„JavaScript
  "@babel/preset-react": "^7.14.5", // react æ”¯æŒ
  "@babel/preset-typescript": "^7.15.0", // typescript æ”¯æŒ
  "babel-plugin-dynamic-import-node": "^2.3.3", // ä¸ºnodeæä¾›åŠ è½½è½¬æ¢ import => require
  "babel-plugin-import": "^1.13.3", // æŒ‰éœ€å¼•å…¥ã€åŠ è½½
  "babel-plugin-lodash": "^3.3.4", // æŒ‰éœ€åŠ è½½
  "babel-plugin-transform-react-remove-prop-types": "^0.4.24", // ä»ç”Ÿäº§ç”Ÿæˆä¸­åˆ é™¤ä¸å¿…è¦çš„ç±»å‹

  // commitlint æ˜¯ git commit æ‰§è¡Œè§„åˆ™ç›¸å…³æ’ä»¶
  "@commitlint/cli": "^13.1.0", 
  "@commitlint/config-conventional": "^13.1.0",

  // react hot é…åˆwebpackå®ç°çƒ­æ›´æ–°æ’ä»¶
  "react-refresh": "^0.10.0",
  "@pmmmwh/react-refresh-webpack-plugin": "^0.4.3",

  // @types å¼€å¤´çš„æ˜¯å¯¹åº”åŒ…çš„ TypeScript ç±»å‹å£°æ˜
  "@types/enzyme": "^3.10.9",
  "@types/enzyme-adapter-react-16": "^1.0.6",
  "@types/enzyme-to-json": "^1.5.4",
  "@types/react-dom": "^17.0.9",
  "@types/react-helmet": "^6.1.2",
  "@types/react-router-dom": "^5.1.8",
  "@types/webpack-env": "^1.16.2",

  // enzyme æµ‹è¯•åº“
  "enzyme": "^3.11.0",
  "enzyme-adapter-react-16": "^1.15.6",
  "enzyme-to-json": "^3.6.2",

  // eslint
  "eslint": "^7.32.0",
  "eslint-config-airbnb-typescript": "^12.3.1", // airbnb è§„èŒƒ
  "eslint-config-prettier": "^8.3.0", // å…³é—­æ‰€æœ‰ä¸å¿…è¦æˆ–å¯èƒ½ä¸[Prettier]å†²çªçš„è§„åˆ™ã€‚
  "eslint-import-resolver-typescript": "^2.4.0", // æ·»åŠ  ts è¯­æ³•æ”¯æŒ  eslint-plugin-import
  "eslint-import-resolver-webpack": "^0.13.1", // æ”¯æŒ eslint-plugin-import è¯»å†™æ¨¡å—è§£æ
  "eslint-plugin-import": "^2.23.4", // ES6+  import/export è¯­æ³•æ”¯æŒ
  "eslint-plugin-jsx-a11y": "^6.4.1", // JSXå…ƒç´ çš„å¯è®¿é—®æ€§è§„åˆ™çš„é™æ€ASTæ£€æŸ¥å™¨ 
  "eslint-plugin-prettier": "^3.4.0", // ä»¥ eslintçš„è§„åˆ™è¿è¡Œ prettier æ ¼å¼åŒ–
  "eslint-plugin-react": "^7.24.0", // react ç›¸å…³è§„åˆ™
  "eslint-plugin-react-hooks": "^4.2.0", // react-hooks ç›¸å…³è§„åˆ™
  "eslint-plugin-redux-saga": "^1.2.1", // redux-saga ç›¸å…³è§„åˆ™
  "@typescript-eslint/eslint-plugin": "^4.29.0", // ä½¿ eslint æ”¯æŒ typescriptï¼Œ.eslintrc.js çš„ plugins å‚æ•°
  "@typescript-eslint/parser": "^4.29.0", // ä½¿ eslint æ”¯æŒ typescript ï¼Œ.eslintrc.js çš„ parser å‚æ•°

  // webpack
  "webpack": "^5.49.0",
  "webpack-bundle-analyzer": "^4.4.2", // åŒ…ä¾èµ–åˆ†æ å¯è§†åŒ–
  "webpack-cli": "^4.7.2", // cli
  "webpack-dev-middleware": "^5.0.0", // ä¸­é—´ä»¶ï¼Œå¯é…åˆ expressä»¥æœåŠ¡çš„æ–¹å¼å¼€å‘ä½¿ç”¨
  "webpack-dev-server": "^3.11.2", // dev-server
  "webpack-hot-middleware": "^2.25.0", // çƒ­åŠ è½½
  "webpack-pwa-manifest": "^4.3.0", // ç”Ÿæˆ pwa ç›¸å…³é…ç½®

  // webpack loaderï¼šè§£æå¯¹åº”æ–‡ä»¶
  "babel-loader": "^8.2.2",
  "style-loader": "^3.2.1", // æ·»åŠ  css åˆ° HTML
  "css-loader": "^6.2.0", // cssåŠ è½½å™¨ å¤„ç† @import/url()
  "postcss-loader": "^6.1.1", // å¤„ç† css
  "less-loader": "^10.0.1", // less => css
  "file-loader": "^6.2.0", // é€šè¿‡ import/require() åŠ è½½çš„å›¾ç‰‡ç­‰è§£æä¸º url
  "html-loader": "^2.1.2", // å‹ç¼©HTML
  "svg-url-loader": "^7.1.1",
  "url-loader": "^4.1.1",

  // webpack plugin
  "html-webpack-plugin": "^5.3.2", // ç®€åŒ–HTMLæ–‡ä»¶çš„åˆ›å»º ï¼Œé…åˆwebpackåŒ…å«hashçš„bundleä½¿ç”¨
  "mini-css-extract-plugin": "^2.2.0", // css å‹ç¼©
  "terser-webpack-plugin": "^5.1.4", // ä½¿ç”¨ terser å‹ç¼© js ï¼ˆterser æ˜¯ä¸€ä¸ªç®¡ç†å’Œå‹ç¼© ES6+ çš„å·¥å…·ï¼‰
  "clean-webpack-plugin": "^4.0.0-alpha.0", // ç”¨äºåˆ é™¤/æ¸…ç†ç”Ÿæˆçš„ build æ–‡ä»¶ 
  "compression-webpack-plugin": "^8.0.1", // Gzipå‹ç¼©

  // prettier æ ¼å¼åŒ–
  "prettier": "^2.3.2",
  "pretty-quick": "^3.1.1", // åœ¨æ›´æ”¹çš„æ–‡ä»¶ä¸Šè¿è¡Œ prettier

  // stylelint cssæ ·å¼è§„èŒƒ
  "stylelint": "^13.13.1",
  "stylelint-config-recess-order": "^2.4.0", // æŒ‰ç…§sessionå’ŒBootstrapçš„æ–¹å¼å¯¹CSSå±æ€§è¿›è¡Œæ’åºã€‚
  "stylelint-config-standard": "^22.0.0", // åŸºæœ¬è§„èŒƒ

  // å·¥å…·
  "husky": "^7.0.1", // è‡ªåŠ¨é…ç½® Git hooks é’©å­
  "lint-staged": "^11.1.2", // å¯¹æš‚å­˜çš„gitæ–‡ä»¶è¿è¡Œlinter
  "rimraf": "^3.0.2", // åˆ é™¤cliï¼Œå…¼å®¹ä¸åŒå¹³å° 
  "yargs": "^17.1.0", // è¯»å–å‘½ä»¤å‚æ•°

  // å…¶ä»–
  "typescript": "^4.3.5",
  "less": "^4.1.1", // less çš„è§£æåº“
  "postcss": "^8.3.6", // ä¸“é—¨å¤„ç†æ ·å¼çš„å·¥å…·
  "postcss-nested": "^5.0.6", // è§£æå¤„ç†åµŒå¥—è§„åˆ™
  "autoprefixer": "^10.3.1", // è‡ªåŠ¨ç”Ÿæˆå„æµè§ˆå™¨å‰ç¼€ postcss çš„ä¸€ä¸ªæ’ä»¶
  "serve": "^12.0.0", // æœ¬åœ°å¯åŠ¨ä¸€ä¸ªæœåŠ¡ï¼Œå¯ä»¥æŸ¥çœ‹é™æ€æ–‡ä»¶
}
```

### ç›®å½•è§„åˆ’

```js
â”œâ”€â”€ dist                                // é»˜è®¤çš„ build è¾“å‡ºç›®å½•
â”œâ”€â”€ .husky                              // pre-commit hook
â”œâ”€â”€ config                              // å…¨å±€é…ç½®æ–‡ä»¶åŠwebpacké…ç½®æ–‡ä»¶
â”œâ”€â”€ public                              // é™æ€æ–‡ä»¶
â”œâ”€â”€ test                                // æµ‹è¯•ç›®å½•
â””â”€â”€ src                                 // æºç ç›®å½•
    â”œâ”€â”€ assets                          // å…¬å…±çš„æ–‡ä»¶ï¼ˆå¦‚imageã€cssã€fontç­‰ï¼‰
    â”œâ”€â”€ components                      // é¡¹ç›®ç»„ä»¶
    â”œâ”€â”€ constants                       // å¸¸é‡/æ¥å£åœ°å€ç­‰
    â”œâ”€â”€ layout                          // å…¨å±€å¸ƒå±€
    â”œâ”€â”€ routes                          // è·¯ç”±
    â”œâ”€â”€ store                           // çŠ¶æ€ç®¡ç†å™¨
    â”œâ”€â”€ utils                           // å·¥å…·åº“
    â”œâ”€â”€ pages                           // é¡µé¢æ¨¡å—
        â”œâ”€â”€ Home                        // Homeæ¨¡å—ï¼Œå»ºè®®ç»„ä»¶ç»Ÿä¸€å¤§å†™å¼€å¤´
        â”œâ”€â”€ ...
    â”œâ”€â”€ App.tsx                         // reacté¡¶å±‚æ–‡ä»¶
    â”œâ”€â”€ main.ts                         // é¡¹ç›®å…¥å£æ–‡ä»¶
    â”œâ”€â”€ typing.d.ts                     // tsç±»å‹æ–‡ä»¶
â”œâ”€â”€ .editorconfig                       // IDEæ ¼å¼è§„èŒƒ
â”œâ”€â”€ .eslintignore                       // eslintå¿½ç•¥
â”œâ”€â”€ .eslintrc                           // eslinté…ç½®æ–‡ä»¶
â”œâ”€â”€ .gitignore                          // gitå¿½ç•¥
â”œâ”€â”€ .npmrc                              // npmé…ç½®æ–‡ä»¶
â”œâ”€â”€ .prettierignore                     // prettiercå¿½ç•¥
â”œâ”€â”€ .prettierrc                         // prettiercé…ç½®æ–‡ä»¶
â”œâ”€â”€ .stylelintignore                    // stylelintå¿½ç•¥
â”œâ”€â”€ .stylelintrc                        // stylelinté…ç½®æ–‡ä»¶
â”œâ”€â”€ babel.config.js                     // babelé…ç½®æ–‡ä»¶
â”œâ”€â”€ commitlint.config.js                // commité…ç½®æ–‡ä»¶
â”œâ”€â”€ LICENSE.md                          // LICENSE
â”œâ”€â”€ package.json                        // package
â”œâ”€â”€ postcss.config.js                   // postcss
â”œâ”€â”€ README.md                           // README
â”œâ”€â”€ setupEnzyme.ts                      // Enzymeæµ‹è¯•é…ç½®æ–‡ä»¶
â”œâ”€â”€ tsconfig.json                       // typescripté…ç½®æ–‡ä»¶
```

ä½¿ç”¨ `npx create-react-app xxx --typescript` å¯ä»¥å¿«é€Ÿåˆ›å»º TS é¡¹ç›®ï¼Œæˆ‘ä»¬å¯ä»¥åŸºäºåˆ›å»ºå®Œçš„é¡¹ç›®å†è¿›è¡Œä¸€äº›è‡ªå®šä¹‰é…ç½®ã€‚

### ES6+ã€JSX ã€TypeScript æ”¯æŒ

è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ `babel` å¤„ç†ï¼Œå½“ç„¶å¯¹äº `TypeScript` ä¹Ÿå¯ä»¥ä½¿ç”¨ `ts-loader` è§£æï¼Œè¿™é‡Œå°±ä¸åšæ¼”ç¤ºäº†ï¼Œç½‘ä¸Šä¹Ÿæœ‰å¾ˆå¤šå¯¹æ¯”æµ‹è¯•

#### JavaScript è¯­æ³•ç‰¹æ€§æ”¯æŒ
  
- é¦–å…ˆå®‰è£… `babel` ç›¸å…³ä¾èµ–ï¼š `yarn add @babel/preset-env -D`
- ç„¶ååœ¨ `.babelrc.js` ä¸­æ·»åŠ é¢„è®¾

```js
module.exports = {
  presets: [
    [
      '@babel/preset-env',
      {
        // è¿™é‡Œå¯ä»¥é…ç½®ç›¸å…³æµè§ˆå™¨å…¼å®¹è§„åˆ™ï¼Œæš‚æ—¶æˆ‘ä»¬å…ˆä¸ç®¡
        // corejs: 3, 
        // debug: true,
        // useBuiltIns: 'usage', // å¼€å¯æµè§ˆå™¨å…¼å®¹ polyfillsï¼Œä¼šæ ¹æ®browserslisté…ç½®ï¼Œå¼•å…¥éœ€è¦çš„åº“ï¼Œéœ€è¦å®‰è£…å¯¹åº”ç‰ˆæœ¬çš„ core-js@3
      }
    ]
  ]
}
```

#### Reactçš„JSXè¯­æ³•æ”¯æŒ

- å®‰è£…ä¾èµ–ï¼š`yarn add @babel/preset-react -D`
- ç„¶ååœ¨ `.babelrc.js` ä¸­æ·»åŠ é¢„è®¾

```js
module.exports = {
  presets: ['@babel/preset-env', '@babel/preset-react']
}
```

#### TypeScript æ”¯æŒ

- å®‰è£…ä¾èµ–ï¼š`yarn add typescript @babel/preset-typescript -D`
- ç„¶ååœ¨ `.babelrc.js` ä¸­æ·»åŠ é¢„è®¾

```js
module.exports = {
  presets: ['@babel/preset-env', '@babel/preset-react', '@babel/preset-typescript']
}
```

- æ¥ä¸‹æ¥åœ¨ `webpack` ä¸­é…ç½® `loader`

```js
module.exports = {
  module: {
    rules: [
      // .ts .tsx
      {
        test: /\.(ts|tsx)$/,
        use: 'babel-loader',
        exclude: /node_modules/,
      },
    ]
  }
}
```

### AntdæŒ‰éœ€åŠ è½½ã€ä¸»é¢˜å®šåˆ¶

`antd`ä½œä¸º`react`çš„å¥½åŸºå‹ï¼Œåœ¨å›½å†…åå°ç³»ç»Ÿå¼€å‘ä¸­å‡ ä¹å¿«æˆä¸ºæ ‡é…äº†ï¼Œæˆ‘ä»¬ä»¥`antd`ä¸ºä¾‹é…ç½®æŒ‰éœ€åŠ è½½å’Œä¸»é¢˜å®šåˆ¶åŒ–

#### babelé…ç½®æŒ‰éœ€åŠ è½½

- å®‰è£…antdï¼š`yarn add antd`
- å®‰è£…ä¾èµ–ï¼š`yarn add babel-plugin-import -D`
- ç„¶ååœ¨ `.babelrc.js` ä¸­é…ç½®`plugins`

```js
module.exports = {
  presets: [],
  plugins: [
    [
      'import',
      {
        libraryName: 'antd',
        libraryDirectory: 'es',
        style: true, // or 'css'
      },
      'antd',
    ]
  ]
}
```

#### webpack/loaderé…ç½®antdä¸»é¢˜

> css-loaderã€style-loader ä¹Ÿæ˜¯å¿…é¡»çš„

```js
module.exports = {
  module: {
    rules: [
      // å¤„ç† .css
      {
        test: /\.css$/,
        use: ['style-loader', 'css-loader'],
      },
      // å¤„ç† .less
      {
        test: /\.less$/,
        use: [
          'style-loader',
          'css-loader',
          // less-loader
          {
            loader: 'less-loader',
            options: {
              lessOptions: {
                // æ›¿æ¢antdçš„å˜é‡ï¼Œå»æ‰ @ ç¬¦å·å³å¯
                // https://ant.design/docs/react/customize-theme-cn
                modifyVars: {
                  'primary-color': '#1DA57A',
                },
                javascriptEnabled: true, // æ”¯æŒjs
              },
            },
          },
        ],
      },
    ]
  }
}
```

### å·¥ç¨‹åŒ–è§„èŒƒé…ç½®

#### Eslintä»£ç æ£€æŸ¥

- å®‰è£…tsè§£æå™¨ï¼š`yarn add @typescript-eslint/parser -D`
- å®‰è£…ç›¸å…³æ‹“å±•ï¼š`yarn add eslint-config-airbnb-typescript eslint-plugin-prettier -D`
- å®‰è£…ç›¸å…³æ’ä»¶ï¼š`yarn add eslint-plugin-react eslint-plugin-react-hooks eslint-plugin-jsx-a11y @typescript-eslint/eslint-plugin -D`

- æ·»åŠ  `.eslintrc.js`

```js
module.exports = {
  parser: '@typescript-eslint/parser',
  // ä½¿ç”¨ airbnb æ‹“å±•æ’ä»¶è§„èŒƒç›¸å…³åº“
  // prettier å·²å†…ç½®äº†è®¸å¤šç›¸å…³æ’ä»¶
  extends: ['airbnb-typescript', 'prettier'],
  // æ‹“å±•å’Œæ”¯æŒç›¸å…³èƒ½åŠ›çš„æ’ä»¶åº“
  plugins: ['prettier', 'react', 'react-hooks', 'jsx-a11y', '@typescript-eslint'],
}
```

- ES6+è§„èŒƒ import/export å¯¼å…¥å¯¼å‡ºé…ç½®ï¼š`yarn add eslint eslint-plugin-import eslint-import-resolver-typescript eslint-import-resolver-webpack -D`

```js
module.exports = {
  parser: '@typescript-eslint/parser',
  // ä½¿ç”¨ airbnb æ‹“å±•æ’ä»¶è§„èŒƒç›¸å…³åº“
  // prettier å·²å†…ç½®äº†è®¸å¤šç›¸å…³æ’ä»¶
  extends: ['airbnb-typescript', 'prettier'],
  // æ‹“å±•å’Œæ”¯æŒç›¸å…³èƒ½åŠ›çš„æ’ä»¶åº“
  plugins: ['prettier', 'react', 'react-hooks', 'jsx-a11y', '@typescript-eslint'],
  settings: {
    'import/parsers': {
      '@typescript-eslint/parser': ['.ts', '.tsx'],
    },
    'import/resolver': {
      webpack: {
        config: './config/webpack.base.js',
      },
      typescript: {
        alwaysTryTypes: true, // always try to resolve types under `<root>@types` directory even it doesn't contain any source code, like `@types/unist`
        directory: './tsconfig.json',
      },
    },
    'import/ignore': ['types'], // Weirdly eslint cannot resolve exports in types folder (try removing this later)
  }
}
```

#### Prettier ä»£ç æ ¼å¼åŒ–

- Eslinté…ç½®ä¸­æˆ‘ä»¬å·²ç»æ·»åŠ `prettier`æ’ä»¶ï¼Œæ”¯æŒä»¥`eslint`çš„è§„èŒƒè¿›è¡Œæ ¼å¼åŒ–ï¼Œå¹¶æä¾›ä¿å­˜æ—¶å­˜åœ¨å†²çªæ—¶çš„è§£å†³æ–¹æ¡ˆ
- æ·»åŠ  `.prettierrc`ï¼Œè¿™é‡Œå†å®šä¹‰ä¸‹æ ¼å¼åŒ–åŸºæœ¬é£æ ¼

`yarn add prettier -D`

```sh
{
  "printWidth": 100, 
  "tabWidth": 2,
  "useTabs": false,
  "semi": true,
  "singleQuote": true,
  "trailingComma": "all",
  "arrowParens": "avoid",
  "endOfLine": "auto"
}
```

#### Stylelint æ ·å¼è§„èŒƒ

- å®‰è£…ä¾èµ–ï¼š`yarn add stylelint stylelint-config-recess-order stylelint-config-standard -D`
- æ·»åŠ `.stylelintrc.js`

```js
module.exports = {
  extends: ['stylelint-config-standard', 'stylelint-config-recess-order'],
};
```

é’ˆå¯¹ä»¥ä¸Šä»£ç è§„èŒƒæ£€æŸ¥ï¼Œæˆ‘ä»¬ä¹Ÿåº”è¯¥æ·»åŠ å¯¹åº” **ignore** æ–‡ä»¶ä»¥å¿½ç•¥éå¿…è¦çš„æ£€æŸ¥æ–‡ä»¶ï¼Œä»¥ä¼˜åŒ–æ€§èƒ½

å¦‚ï¼š`.eslintignore`

```txt
node_modules
dist
```

#### Commitlint ä»£ç æäº¤è§„èŒƒ

`git hook` é’©å­çš„å®ç°ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ `husky` + `lint-staged` æ–¹æ¡ˆ

- å®‰è£…ä¾èµ–ï¼š`yarn add husky lint-staged -D`

`git commit` è§„èŒƒï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ `@commitlint/config-conventional`

- å®‰è£…ä¾èµ–ï¼š`yarn add "@commitlint/cli @commitlint/config-conventional -D`

> è¿™é‡Œä¹Ÿå¯ä»¥ä½¿ç”¨`pretty-quick`ä»£æ›¿`prettier`æ ¼å¼åŒ–ï¼š`yarn add pretty-quick -D`ï¼Œä½¿å¾—`prettier`æ ¼å¼åŒ–æ›´ç®€å•æ˜“ç”¨

- æ ¹ç›®å½•ä¸‹åˆ›å»º `.husky` æ–‡ä»¶å¤¹ä¸`commitlint.config.js`æ–‡ä»¶ï¼Œå¹¶åœ¨`.husky` æ–‡ä»¶å¤¹ä¸‹æ·»åŠ  `precommit`ã€`commit-msg`ã€ä»¥åŠ`.gitignore`

`commitlint.config.js` ç”¨äºé…ç½® `commitlint` ç›¸å…³è§„èŒƒ

```js
// git commit è§„èŒƒ
// <ç±»å‹>[å¯é€‰çš„ä½œç”¨åŸŸ]: <æè¿°>

// # ä¸»è¦type
// feat:     å¢åŠ æ–°åŠŸèƒ½
// fix:      ä¿®å¤bug

// # ç‰¹æ®Štype
// docs:     åªæ”¹åŠ¨äº†æ–‡æ¡£ç›¸å…³çš„å†…å®¹
// style:    ä¸å½±å“ä»£ç å«ä¹‰çš„æ”¹åŠ¨ï¼Œä¾‹å¦‚å»æ‰ç©ºæ ¼ã€æ”¹å˜ç¼©è¿›ã€å¢åˆ åˆ†å·
// build:    æ„é€ å·¥å…·çš„æˆ–è€…å¤–éƒ¨ä¾èµ–çš„æ”¹åŠ¨ï¼Œä¾‹å¦‚webpackï¼Œnpm
// refactor: ä»£ç é‡æ„æ—¶ä½¿ç”¨
// revert:   æ‰§è¡Œgit revertæ‰“å°çš„message

// # æš‚ä¸ä½¿ç”¨type
// test:     æ·»åŠ æµ‹è¯•æˆ–è€…ä¿®æ”¹ç°æœ‰æµ‹è¯•
// perf:     æé«˜æ€§èƒ½çš„æ”¹åŠ¨
// ci:       ä¸CIï¼ˆæŒç»­é›†æˆæœåŠ¡ï¼‰æœ‰å…³çš„æ”¹åŠ¨
// chore:    ä¸ä¿®æ”¹srcæˆ–è€…testçš„å…¶ä½™ä¿®æ”¹ï¼Œä¾‹å¦‚æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨

module.exports = {
  extends: ['@commitlint/config-conventional'],
  // rules: [] // å¯ä»¥è‡ªå®šä¹‰è§„åˆ™
};
```

`precommit` gitæä¾›çš„é’©å­å‡½æ•°ï¼Œåœ¨è¯¥é˜¶æ®µæ‰§è¡Œ`eslint`ç­‰éªŒè¯è§„èŒƒï¼Œå†æ ¹æ®æ‰§è¡Œç»“æœåˆ¤æ–­æ˜¯å¦æäº¤

```sh
#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

# npx --no-install pretty-quick --staged
npx --no-install lint-staged
```

`commit-msg` éªŒè¯ `git commit -m "xx"` æäº¤çš„ `message` ä¿¡æ¯æ ¼å¼å’Œè§„èŒƒ

```sh
#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

npx --no-install commitlint --edit $1
```

`.gitignore` ä½œç”¨æ˜¯ä¸ºäº†å¿½ç•¥ `husky`å®‰è£…äº§ç”Ÿçš„éé¡¹ç›®ä»£ç æ–‡ä»¶

```txt
_
```

`package.json`é…ç½®

```json
"scripts": {
  // è¿™é‡Œæ¢æˆ postinstall ä¹Ÿå¯ä»¥ï¼Œnpmæä¾›çš„ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸé’©å­
  // ä¸»è¦æ˜¯ä¸ºäº†æˆ‘ä»¬åœ¨å®‰è£…å®Œ huskyä¾èµ–åå¯ä»¥æ‰§è¡Œhuskyè„šæœ¬ï¼Œä½¿git hooké’©å­ç”Ÿæ•ˆ
  "prepare": "husky install", 
  "commitlint": "commitlint --from=master",

  // lint ç›¸å…³è§„åˆ™å’Œè§„èŒƒæ‰§è¡Œå‘½ä»¤
  "lint:eslint:fix": "eslint --ext .ts,.tsx --no-error-on-unmatched-pattern --quiet --fix",
  "lint:style": "stylelint --fix \"src/**/*.less\" --syntax less",
  "lint": "npm run lint:eslint:fix && npm run lint:style",

  // prettier æ ¼å¼åŒ–çš„ä¸€ä¸ªæ‹“å±•åº“
  "pretty-quick": "pretty-quick",
},
"lint-staged": {
  "*.{ts,tsx}": [
    "npm run lint:eslint:fix",
    "git add --force"
  ],
  "*.{md,json}": [
    "pretty-quick --staged",
    "git add --force"
  ]
}
```

#### vscode é…ç½®

- å®‰è£… `eslint`ã€`prettier` æ‹“å±•æ’ä»¶
- æ·»åŠ  `.vscode/settings.json` é…ç½®æ–‡ä»¶ï¼Œæˆ–è€…å…¨å±€è®¾ç½® `vscode settings.json`

```jsonc
// ä¿å­˜æ—¶æ ¼å¼åŒ–
"editor.formatOnSave": true, 
// ç›¸å½“äºæ˜¯ vscode ä¿å­˜æ—¶è°ƒç”¨çš„é’©å­äº‹ä»¶
"editor.codeActionsOnSave": {
  // ä¿å­˜æ—¶ä½¿ç”¨ ESLint ä¿®å¤å¯ä¿®å¤é”™è¯¯
  "source.fixAll.eslint": true
}
// é’ˆå¯¹å¯¹åº”æ–‡ä»¶è®¾ç½®é»˜è®¤æ ¼å¼åŒ–æ’ä»¶
"[javascript]": {
  "editor.defaultFormatter": "esbenp.prettier-vscode"
},
"[javascriptreact]": {
  "editor.defaultFormatter": "esbenp.prettier-vscode"
},
"[typescript]": {
  "editor.defaultFormatter": "esbenp.prettier-vscode"
},
"[typescriptreact]": {
  "editor.defaultFormatter": "esbenp.prettier-vscode"
},
```

### HMR çƒ­æ›´æ–°é…ç½®

è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ `react-refresh`+`webpack` æ–¹æ¡ˆ

- å®‰è£…ä¾èµ–ï¼š`yarn add react-refresh @pmmmwh/react-refresh-webpack-plugin -D`
- æ·»åŠ `webpack`é…ç½®

```js
const { HotModuleReplacementPlugin } = require('webpack');
const ReactRefreshWebpackPlugin = require('@pmmmwh/react-refresh-webpack-plugin');

module.exports = {
  devServer: {
    port: 3010, // ç«¯å£
    publicPath: '/', // åŸºç¡€è·¯å¾„
    open: true, // æ‰“å¼€é¡µé¢
    hot: true, // å¼€å¯çƒ­æ›´æ–°
    historyApiFallback: true, // æŠŠ404å“åº”å®šä½åˆ° index.html
    // proxy:{} // å¼€å‘ç¯å¢ƒï¼Œæ¥å£ä»£ç†
  },
  plugins: [new HotModuleReplacementPlugin(), new ReactRefreshWebpackPlugin()]
}
```

### ç”Ÿäº§ç¯å¢ƒæ‰“åŒ…å‹ç¼©ã€chunkæ‹†åˆ†

- å®‰è£…`css`å‹ç¼©æ’ä»¶ï¼š`yarn add mini-css-extract-plugin css-minimizer-webpack-plugin -D`
- å®‰è£…`js`å‹ç¼©æ’ä»¶ï¼š`yarn add terser-webpack-plugin -D`
- å®‰è£…`gzip`å‹ç¼©æ’ä»¶ï¼š`yarn add compression-webpack-plugin -D`
- å¦‚æœæƒ³æŸ¥çœ‹å¯¹åŒ…æ¨¡å—çš„å¯è§†åŒ–åˆ†æå¯ä½¿ç”¨æ’ä»¶ï¼š`webpack-bundle-analyzer`

`css`å‹ç¼©çš„`webpack`é…ç½®ï¼š

```js
const MiniCssExtractPlugin = require('mini-css-extract-plugin');
const CssMinimizerPlugin = require("css-minimizer-webpack-plugin");
// æ”¯æŒåŠ¨æ€æ³¨å…¥ link æ ‡ç­¾åˆ° htmlä¸­
const HtmlWebpackPlugin = require('html-webpack-plugin');

module.exports = {
  module: {
    rules: [
      // .css
      {
        test: /\.css$/,
        use: [
          // è¯¥æ’ä»¶æ˜¯ä¸ºäº†æŠŠ CSSæå–åˆ°å•ç‹¬çš„æ–‡ä»¶ä¸­
          MiniCssExtractPlugin.loader, 
          'css-loader'
        ],
      },
      // less
      {
        test: /\.less$/,
        use: [
          MiniCssExtractPlugin.loader,
          'css-loader',
          'less-loader'
        ],
      },
    ]
  },
  plugins: [
    // ç®€åŒ– HTML æ–‡ä»¶çš„åˆ›å»º
    new HtmlWebpackPlugin({
      template: 'public/index.html',
    }),

    // MiniCss
    new MiniCssExtractPlugin({
      filename: "[name].css",
      chunkFilename: "[id].css",
    }),
  ],

  optimization: {
    minimizer: [
      // å‹ç¼©
      new CssMinimizerPlugin(),
    ]
  }
}
```

`js`å‹ç¼©çš„`webpack`é…ç½®ï¼š

webpack5.xå†…ç½®æœ‰`terser-webpack-plugin`ï¼Œä¸è¿‡å¦‚æœæƒ³è¦è‡ªå®šä¹‰é…ç½®è¿˜æ˜¯éœ€è¦å®‰è£…çš„

```js
// ä½¿ç”¨ terser å‹ç¼© JavaScript
const TerserPlugin = require("terser-webpack-plugin");

module.exports = {
  optimization: {
    minimize: true, // å¼€å¯å‹ç¼©
    minimizer: [
      // 1. ç®€å•ä½¿ç”¨é»˜è®¤é…ç½®
      new TerserPlugin() // ä½¿ç”¨æ’ä»¶
      // 2. è‡ªå®šä¹‰é…ç½®ä¸€äº›å‚æ•°
      new TerserPlugin({
        terserOptions: {
          output: {
            comments: false, // åœ¨è¾“å‡ºä¸­çœç•¥æ³¨é‡Š
          },
          // ie8: true å¼€å¯ ie8 æ”¯æŒ
        },
      }),
    ],
  },
}
```

`chunk`æ‹†åˆ†

è¿™é‡Œçš„å¯ç©æ€§è¿˜æ˜¯æ¯”è¾ƒé«˜çš„ï¼Œå„ç§æ€§èƒ½ä¼˜åŒ–å•¥çš„ï¼Œæœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥ç ”ç©¶ç ”ç©¶ï¼Œæˆ‘ä»¬è¿™é‡Œåªåšç®€å•ä½¿ç”¨é…ç½®ğŸ‘€~

```js
module.exports = {
  optimization: {
    splitChunks: {
      chunks: 'all', // å¤„ç†å“ªç§chunkï¼Œå¯é€‰å€¼ä¸ºï¼šallã€asyncã€initialï¼ˆallåŒ…æ‹¬å¼‚æ­¥å’Œéå¼‚æ­¥ï¼‰
      maxInitialRequests: 10, // å…¥å£ç‚¹çš„æœ€å¤§å¹¶è¡Œè¯·æ±‚æ•°ã€‚
      minSize: 0, // ç”Ÿæˆ chunk çš„æœ€å°ä½“ç§¯ï¼ˆä»¥ bytes ä¸ºå•ä½ï¼‰
      // ç¼“å­˜ç»„ï¼Œè¯¥ç»„å†…é…ç½®å¯ç»§æ‰¿ã€è¦†ç›–splitChunksä¸­çš„é…ç½®
      cacheGroups: {
        vendor: {
          test: /[\\/]node_modules[\\/]/, // [\\/] æ˜¯ä¸ºäº†åˆ†åˆ«åŒ¹é… winã€Unixç³»ç»Ÿè·¯å¾„
          // æ‹†åˆ† vendorï¼Œè‡ªå®šä¹‰nameï¼ˆvendoré»˜è®¤æ˜¯åˆå¹¶ä¸ºä¸€ä¸ª chunkï¼‰
          name(module) {
            // æŠŠ npm åº“æ‹†åˆ†ç‹¬ç«‹æ‰“åŒ…
            const packageName = module.context.match(/[\\/]node_modules[\\/](.*?)([\\/]|$)/)[1];
            return `npm.${packageName.replace('@', '')}`;
          },
        },
      },
    }
  },
}
```

`Gzip`å‹ç¼©

```js
const CompressionPlugin = require('compression-webpack-plugin');

module.exports = {
  plugins: [
    new CompressionPlugin({
      algorithm: 'gzip', // å‹ç¼©ç®—æ³•
      test: /\.js$|\.css$|\.html$/,
      threshold: 10240, // åªå‹ç¼©å¤§äº 10240 bytes çš„chunk
      minRatio: 0.8, // åªå‹ç¼©å¤§äºè¯¥å€¼çš„ minRatio = Compressed Size / Original Size
    })
  ]
}
```

#### ã€å›¾ 1ã€‘chunkæ‹†åˆ†ã€gzipå‹ç¼©åçš„æ•ˆæœ

![å‹ç¼©äº§ç‰©](https://cdn.jsdelivr.net/gh/JS-banana/images/vuepress/webpack-react-ts-2.jpg)

#### ã€å›¾ 2ã€‘Analyzerå¯è§†åŒ–åˆ†æ

![Analyzeråˆ†æ](https://cdn.jsdelivr.net/gh/JS-banana/images/vuepress/webpack-react-ts-3.jpg)

## æ€»ç»“

æœ¬æ–‡ç€é‡æè¿°äº†é¡¹ç›®çš„å·¥ç¨‹åŒ–é…ç½®ï¼Œæ¶‰åŠç›¸å…³ä»£ç è§„èŒƒã€å¼€å‘ç¯å¢ƒæ­å»ºã€ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–ç­‰ï¼Œæ—¨åœ¨æ‰“é€ å‡ºä¸€ä¸ªå¯å¿«é€Ÿä½¿ç”¨çš„ç°ä»£åŒ–`webpack+react+typescript`æ¨¡æ¿ï¼Œä»¥ä¾›åœ¨ä»¥åçš„å®é™…ä¸šåŠ¡åœºæ™¯éœ€æ±‚ä¸­é›¶æˆæœ¬ä½¿ç”¨ã€‚

ç›®å‰è¿™åªç®—æ˜¯æœ€ç®€é™‹çš„ä¸€ä¸ªdemoï¼Œå¯¹`webpack`ç›¸å…³çš„å„ç§è°ƒä¼˜ä¸é¡¹ç›®ä¼˜åŒ–è¿˜æœ‰å¾ˆå¤šæ–¹å‘å¯ç ”ç©¶ã€‚

æ¥ä¸‹æ¥å°±æ˜¯æå®é™…åœºæ™¯çš„ä¸šåŠ¡ç»„ä»¶çš„å¼€å‘ã€ç¬¬ä¸‰æ–¹å¼€æºç»„ä»¶çš„é›†æˆä½¿ç”¨ã€é€šç”¨ç»„ä»¶çš„ä½¿ç”¨å’Œå¼€å‘å°è£…äº†~

é¡¹ç›®åœ°å€ï¼š<https://github.com/JS-banana/webpack-react-ts>

![å‘Šè¾](https://cdn.jsdelivr.net/gh/JS-banana/images/emoji/1.jpg)

## å‚è€ƒ

- [webpack](https://webpack.docschina.org/)
- [Babel](https://www.babeljs.cn/docs/)
- [How to Format Code on Save in VS Code with ESlint](https://www.aleksandrhovhannisyan.com/blog/format-code-on-save-vs-code-eslint/)
