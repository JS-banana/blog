---
title: æ€§èƒ½çˆ†è¡¨çš„SolidJs
date: 2021-11-15 21:30:58
permalink: /pages/1c6866/
categories:
  - æ–‡ç« 
  - å‰ç«¯
tags:
  - solidjs
---

:::tip
ä½¿ç”¨é¢„ç¼–è¯‘ã€æ— è™šæ‹ŸDOMã€ç©¶æèåˆæ€ªã€æ€§èƒ½çˆ†è¡¨ã€Reactçš„å¼‚çˆ¶å¼‚æ¯äº²å…„å¼Ÿâ€”â€”SolidJs
:::

<!-- more -->

<table with="100%">
  <tr>
    <td width="50%">
      <img src="https://cdn.jsdelivr.net/gh/JS-banana/images/vuepress/solidjs-1.png">
    </td>
    <td width="50%">
      <img src="https://cdn.jsdelivr.net/gh/JS-banana/images/vuepress/solidjs-2.png">
    </td>
  </tr>
</table>

## èƒŒæ™¯

å‰æ®µæ—¶é—´ï¼Œäº§å“æäº†ä¸ªä¸´æ—¶éœ€æ±‚ï¼Œè®©æˆ‘ç»™å¼€å‘ä¸€ä¸ªç‹¬ç«‹éƒ¨ç½²çš„é¦–é¡µå¯è§†åŒ–é¡µé¢ï¼Œå› ä¸ºç›®å‰æˆ‘ä»¬ç³»ç»Ÿæä¾›ä»¥`iframe`çš„æ–¹å¼å®ç°ç”¨æˆ·è‡ªå·±é€‰æ‹©`URL`é…ç½®ä¸€ä¸ªé¡µé¢ï¼Œä½œä¸ºåº”ç”¨çš„å…¶ä¸­ä¸€ä¸ªè·¯ç”±é¡µé¢ä½¿ç”¨~

æƒ³ç€å°±å•ç‹¬éƒ¨ç½²ä¸€ä¸ªé¡µé¢ï¼Œä¹Ÿæ²¡å¿…è¦ä½¿ç”¨`React`æˆ–è€…`Vue`äº†ï¼Œç®€å•ç”»ä¸ªé¡µé¢å®Œäº‹ï¼Œ`jq`æˆ‘æ˜¯ç”¨ä¸åŠ¨äº†

æƒ³ç€æœ€è¿‘å‡ºç¤¾åŒºä¹Ÿæ¶Œç°äº†ä¸å°‘æœ‰è¶£çš„æ¡†æ¶ï¼Œä¹‹å‰çœ‹`svelte`ï¼Œå°±è§‰å¾—æŒºæœ‰æ„æ€çš„ï¼Œæ„Ÿè§‰ä¹Ÿæ¯”è¾ƒç¬¦åˆæˆ‘çš„ä½¿ç”¨åœºæ™¯ï¼Œæ­£å‡†å¤‡ç”¨è¿™ä¸ªä¸Šæ‰‹æä¸€æ³¢å‘¢

ç„¶åï¼Œåœ¨GitHubå‘ç°äº†`solidjs`è¿™ä¸ªé¡¹ç›®ï¼Œå¤§è‡´çœ‹äº†ä¸‹ï¼Œå¥½å®¶ä¼™ï¼Œè¿™ç®€ç›´æ¯”`react`è¿˜`react`ğŸ˜†~

çœ‹äº†ä¸‹æ–‡æ¡£ï¼Œå†™äº†demoè¯•äº†ä¸‹ï¼Œå¾ˆå®¹æ˜“ä¸Šæ‰‹ï¼Œåˆçœ‹äº†ä¸€äº›å¯¹æ¯”æµ‹è¯•å’Œåšå®¢ä»‹ç»ï¼Œæ„Ÿè§‰æ€§èƒ½å¾ˆå¼ºå•Šï¼Œå’Œ`svelte`ä¸€æ ·éƒ½æ˜¯é¢„ç¼–è¯‘ï¼Œæ²¡æœ‰è¿è¡Œæ—¶ï¼Œæ„å»ºäº§ç‰©åå‡ kbï¼Œä¸åŸç”Ÿjsç›¸å·®æ— å‡ ï¼Œä»¤äººæƒŠå¹~

å¯¹äºæˆ‘è¿™ç§å°é¡¹ç›®è¿˜æ˜¯æ¯”è¾ƒé€‚åˆçš„~

ä¸å¤šé€¼é€¼ï¼Œç›´æ¥ä¸Šæ‰‹å¹²ğŸ§ğŸ§~

## ä»‹ç»

> å®˜æ–¹ä»‹ç»ï¼šç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢çš„å£°æ˜å¼ã€é«˜æ•ˆä¸”çµæ´»çš„ JavaScript

`Solid` ä½¿ç”¨äº†ç±»ä¼¼ `Svelte` çš„é¢„ç¼–è¯‘ï¼Œè¯­æ³•ä½¿ç”¨ä¸Šç±»ä¼¼äº `React`ï¼Œä½¿ç”¨ `JSX` è¯­æ³•å’Œéå¸¸ç›¸åƒçš„APIï¼Œä½†ä¸åŒäº `React`ï¼Œç»„ä»¶åªä¼šåˆå§‹åŒ–ä¸€æ¬¡ï¼Œå¹¶ä¸æ˜¯ `state` æ”¹å˜å°±é‡æ–°è¿è¡Œæ¸²æŸ“æ•´ä¸ªç»„ä»¶ï¼Œè¿™ç±»ä¼¼äº `Vue3` çš„ `setup`å’Œå“åº”å¼æ›´æ–°ï¼ˆæ›´æ–°é¢—ç²’åº¦ä¸ºèŠ‚ç‚¹çº§ï¼‰

å®˜æ–¹ç»™å‡ºçš„ç†ç”±ï¼š

- **é«˜æ€§èƒ½** - å§‹ç»ˆåœ¨å…¬è®¤çš„ UI é€Ÿåº¦å’Œå†…å­˜åˆ©ç”¨ç‡åŸºå‡†æµ‹è¯•ä¸­ååˆ—å‰èŒ…
- **å¼ºå¤§** - å¯ç»„åˆçš„ååº”å¼åŸè¯­ä¸ JSX çš„çµæ´»æ€§ç›¸ç»“åˆ
- **åŠ¡å®** - åˆç†ä¸”é‡èº«å®šåˆ¶çš„ API ä½¿å¼€å‘å˜å¾—æœ‰è¶£è€Œç®€å•
- **ç”Ÿäº§åŠ›** - äººä½“å·¥ç¨‹å­¦å’Œç†Ÿæ‚‰ç¨‹åº¦ä½¿æ„å»ºç®€å•æˆ–å¤æ‚çš„ä¸œè¥¿å˜å¾—è½»è€Œæ˜“ä¸¾

### ä¸»è¦ä¼˜åŠ¿

- é«˜æ€§èƒ½ - æ¥è¿‘åŸç”Ÿçš„æ€§èƒ½ï¼Œåœ¨ **js-framework-benchmark** æ’åä¸­ååˆ—å‰èŒ…
- æå°çš„æ‰“åŒ…ä½“ç§¯ - ç¼–è¯‘ä¸ºç›´æ¥çš„`DOMæ“ä½œ`ï¼Œæ— `è™šæ‹ŸDOM`ï¼Œæå°çš„è¿è¡Œæ—¶ï¼ˆç±»ä¼¼äº `Svelte`ï¼‰ï¼Œé€‚åˆæ‰“ä¸ºç‹¬ç«‹çš„ `webComponent` åœ¨å…¶å®ƒåº”ç”¨ä¸­åµŒå…¥
- æ˜“äºä½¿ç”¨ - è¿‘ä¼¼ `React` çš„ä½¿ç”¨ä½“éªŒï¼Œä¾¿äºå¿«é€Ÿä¸Šæ‰‹

## å¯¹æ¯”åˆ†æ

æˆ‘ä»¬æŠŠå…³æ³¨ç‚¹èšç„¦äºæ˜¯å¦ä½¿ç”¨è™šæ‹ŸDOMï¼Œä»¥åŠæ•°æ®çš„å“åº”å¤„ç†ã€‚

### è™šæ‹ŸDOMçš„åˆ†æ

é¦–å…ˆï¼Œè™šæ‹ŸDOMå¹¶ä¸æ˜¯ä¸€å®šæ¯”åŸç”Ÿæ€§èƒ½å¥½ï¼Œæˆ–è€…è¯´æ˜¯æ›´å¿«ï¼ŒæŠ›å¼€çœŸå®åœºæ™¯ä¸è°ˆéƒ½æ˜¯çæ‰¯æ·¡ï¼Œæ¡†æ¶çš„è®¾è®¡å’Œåº”ç”¨åœºæ™¯æ˜¯æœ‰å®ƒè‡ªèº«è€ƒé‡çš„ã€‚

åœ¨çŠ¶æ€ä¸Domæ“ä½œä¹‹é—´æŠ½è±¡å‡ºä¸€å±‚è™šæ‹ŸDomï¼Œéœ€è¦ç‰ºç‰²ä¸€å®šçš„è¿è¡Œæ—¶æ€§èƒ½ï¼Œå¹¶ä¸ä¸€å®šæ¯”ç›´æ¥æ“ä½œåŸç”ŸDomå¿«ï¼Œè¦çœ‹æƒ…å†µï¼Œæ¯•ç«Ÿ`diff`å¹¶ä¸æ˜¯å…è´¹çš„ã€‚

1. ä¸ç®¡ä½ çš„æ•°æ®å˜åŒ–å¤šå°‘ï¼Œæ¯æ¬¡é‡ç»˜çš„æ€§èƒ½éƒ½æ˜¯å¯ä»¥æ¥å—ï¼ˆæä¾›è¿‡çš„å»çš„æ€§èƒ½ï¼‰ã€‚
2. ä½ ä¾ç„¶å¯ä»¥ç”¨ç±»ä¼¼ `innerHTML` çš„æ€è·¯å»å†™ä½ çš„åº”ç”¨ã€‚
3. æœ€æœ€é‡è¦çš„ä¸€ç‚¹ï¼Œå®ç°äº†è·¨å¹³å°ã€‚

> å¦‚`react`ï¼Œå¯¹äºwebç«¯çš„æ¸²æŸ“å¯ä»¥ä½¿ç”¨`react-dom`ï¼Œå¯¹äºnativeçš„æ¸²æŸ“å¯ä»¥ä½¿ç”¨`react-native`ã€ä»¥åŠæœåŠ¡ç«¯æ¸²æŸ“ç­‰ï¼Œä»–ä»¬çš„å¼€å‘æ¨¡å¼éå¸¸ç±»ä¼¼ï¼ŒæŒ‰ç…§`react`çš„è¯­æ³•è§„åˆ™è¿›è¡Œå³å¯ï¼Œä½†æ˜¯åœ¨`render`å±‚ï¼Œåªè¦ç¬¦åˆ`react api`è§„èŒƒï¼Œä½ å¯ä»¥æä¾›å„ç§ä¸åŒçš„`render`æ¸²æŸ“å‡½æ•°ï¼Œè¿›è¡Œè·¨å¹³å°çš„æ¸²æŸ“å®ç°ã€‚

### æ ¸å¿ƒåŸç†çš„é€‰æ‹©

æ‹¿æˆ‘ä»¬ç†Ÿæ‚‰çš„`react`å’Œ`vue`è¯´æ˜ï¼š

- Reactå¯¹æ•°æ®çš„å¤„ç†æ˜¯ä¸å¯å˜ï¼ˆ`immutable`ï¼‰ï¼šå…·ä½“è¡¨ç°æ˜¯æ•´æ ‘æ›´æ–°ï¼Œæ›´æ–°æ—¶ï¼Œä¸å…³æ³¨æ˜¯å…·ä½“å“ªä¸ªçŠ¶æ€å˜åŒ–äº†ï¼Œåªè¦æœ‰çŠ¶æ€æ”¹å˜ï¼Œç›´æ¥æ•´æ ‘diffæ‰¾å‡ºå·®å¼‚è¿›è¡Œå¯¹åº”æ›´æ–°ã€‚
- Vueå¯¹æ•°æ®çš„å¤„ç†æ˜¯å“åº”å¼ã€å¯å˜çš„ï¼ˆ`mutable`ï¼‰ï¼šæ›´æ–°æ—¶ï¼Œèƒ½å¤Ÿç²¾ç¡®çŸ¥é“æ˜¯å“ªäº›çŠ¶æ€å‘ç”Ÿäº†æ”¹å˜ï¼Œèƒ½å¤Ÿå®ç°ç²¾ç¡®åˆ°èŠ‚ç‚¹çº§åˆ«çš„æ›´æ–°ï¼ˆç±»ä¼¼çš„æ¡†æ¶è¿˜æœ‰Svelteã€SolidJSï¼‰ã€‚

### æ›´æ–°ç²’åº¦çš„é€‰æ‹©

- **åº”ç”¨çº§**ï¼šæœ‰çŠ¶æ€æ”¹å˜ï¼Œå°±æ›´æ–°æ•´ä¸ªåº”ç”¨ï¼Œç”Ÿæˆæ–°çš„è™šæ‹ŸDomæ ‘ï¼Œä¸æ—§æ ‘è¿›è¡Œ`Diff`ï¼ˆä»£è¡¨ä½œï¼šReactï¼Œå½“ç„¶äº†ï¼Œç°åœ¨å®ƒçš„è™šæ‹ŸDomå·²å‡çº§ä¸ºäº†`Fiber`ï¼‰ã€‚
- **ç»„ä»¶çº§**ï¼šä¸ä¸Šæ–¹ç±»ä¼¼ï¼Œåªä¸è¿‡ç²’åº¦å°äº†ä¸€ä¸ªç­‰çº§ï¼ˆä»£è¡¨ä½œï¼š`vuev2`åŠä¹‹åçš„ç‰ˆæœ¬ï¼‰ã€‚
- **èŠ‚ç‚¹çº§**ï¼šçŠ¶æ€æ›´æ–°ç›´æ¥ä¸å…·ä½“çš„æ›´æ–°èŠ‚ç‚¹çš„æ“ä½œç»‘å®šï¼ˆä»£è¡¨ä½œ`vue1.x`ã€`Svelte`ã€`SolidJS`ï¼‰ã€‚

> `vue1.x`æ—¶ä»£ï¼Œå¯¹äºæ•°æ®æ˜¯æ¯ä¸ªç”Ÿæˆä¸€ä¸ªå¯¹åº”çš„`Wather`ï¼Œæ›´æ–°é¢—ç²’åº¦ä¸ºèŠ‚ç‚¹çº§åˆ«ï¼Œä½†è¿™æ ·åˆ›å»ºå¤§é‡çš„`Wather`ä¼šé€ æˆæå¤§çš„æ€§èƒ½å¼€é”€ï¼Œå› æ­¤åœ¨`vue2.x`æ—¶ä»£ï¼Œé€šè¿‡å¼•å…¥è™šæ‹ŸDOMä¼˜åŒ–å“åº”ï¼Œåšåˆ°äº†ç»„ä»¶çº§é¢—ç²’åº¦çš„æ›´æ–°ã€‚
>
> è€Œå¯¹äº`react`æ¥è¯´ï¼Œè™šæ‹ŸDOMå°±æ˜¯è‡³å…³é‡è¦çš„éƒ¨åˆ†ï¼Œç”šè‡³æ˜¯æ ¸å¿ƒï¼Œæˆ‘ä»¬å·²ç»äº†è§£`react`æ˜¯å±äºåº”ç”¨çº§åˆ«çš„æ›´æ–°ï¼Œå› æ­¤æ•´ä¸ªDOMæ ‘çš„æ›´æ–°å¼€é”€æ˜¯æå¤§çš„ï¼Œæ‰€ä»¥è¿™é‡Œå¯¹äº`è™šæ‹ŸDOM+diffç®—æ³•`çš„ä½¿ç”¨å°±æ˜¯æå…¶å¿…è¦çš„ã€‚åŒ…æ‹¬ç°åœ¨çš„`fiber`æ¶æ„ä¸å¯ä¸­æ–­æ›´æ–°ï¼Œä¹Ÿç®—æ˜¯å¯¹è™šæ‹ŸDOMçš„æè‡´å‹æ¦¨ã€‚

### æ˜¯å¦é‡‡ç”¨è™šæ‹ŸDOM

è¿™ä¸ªé€‰æ‹©æ˜¯ä¸ä¸Šè¾¹é‡‡ç”¨ä½•ç§ç²’åº¦çš„æ›´æ–°è®¾è®¡ç´§å¯†ç›¸å…³çš„ï¼š

- **æ˜¯**ï¼šå¯¹åº”ç”¨çº§çš„è¿™ç§æ›´æ–°ç²’åº¦ï¼Œè™šæ‹ŸDomç®€ç›´æ˜¯å¿…éœ€å“ï¼Œå› ä¸ºåœ¨`diff`å‰å®ƒå¹¶ä¸èƒ½å¾—åˆ°æ­¤æ¬¡æ›´æ–°çš„å…·ä½“èŠ‚ç‚¹ä¿¡æ¯ï¼Œå¿…é¡»è¦é€šè¿‡éšåçš„`è™šæ‹ŸDom+Diffç®—æ³•`ç­›é€‰å‡ºæœ€å°å·®å¼‚ï¼Œä¸ç„¶æ•´æ ‘`append`å¯¹æ€§èƒ½æ˜¯ç¾éš¾ï¼ˆä»£è¡¨æ¡†æ¶ï¼š`React`ã€`vue`ï¼‰ã€‚
  - ä½†è¿™é‡Œå€¼å¾—æ³¨æ„çš„äº‹æ˜¯ï¼šæœ¬è´¨ä¸Š`vue`å¹¶ä¸éœ€è¦`è™šæ‹ŸDOM`ï¼Œå› ä¸ºå®ƒè¿™ç§åŸºäºä¾èµ–æ”¶é›†çš„å“åº”å¼æœºåˆ¶å¯ä»¥ç›´æ¥è¿›è¡ŒèŠ‚ç‚¹çº§æ›´æ–°ï¼Œä½†`vue`å€ŸåŠ©`è™šæ‹ŸDOM`çš„æŠ½è±¡èƒ½åŠ›ï¼Œå¯ä»¥åšåˆ°æ›´æ–°ç²’åº¦çš„éšæ„è°ƒæ•´ï¼ˆç›®å‰æ˜¯ç»„ä»¶çº§ï¼‰ï¼Œç»™vueçš„å‘å±•æä¾›æ›´å¤šå¯èƒ½æ€§, å°¤å…¶åœ¨è·¨å¹³å°æ¸²æŸ“æ–¹é¢ï¼Œè¿™ç‚¹ååˆ†å…³é”®ã€‚
- **å¦**ï¼šå¯¹èŠ‚ç‚¹çº§æ›´æ–°ç²’åº¦çš„æ¡†æ¶æ¥è¯´ï¼Œä¸€èˆ¬æ²¡æœ‰å¿…è¦é‡‡ç”¨è™šæ‹Ÿdomï¼ˆä»£è¡¨ä½œï¼š`vue1.x`ã€`Svelte`ã€`SolidJS`ï¼‰ã€‚

### å¼€å‘è¯­æ³•DSLé€‰æ‹©

- **JSX**ï¼šReactã€SolidJS
- **æ¨¡ç‰ˆ+ç¼–è¯‘æŒ‡ä»¤**ï¼švueï¼ˆJSXå¯é€‰ï¼‰ã€Svelte

## æ­£æ–‡

### åŸºæœ¬ä½¿ç”¨

```ts
import { render } from 'solid-js/web';
import { createSignal, createEffect } from 'solid-js';

const CountingComponent = () => {
  const [count, setCount] = createSignal(0);

  createEffect(() => console.log('count', count()));

  const handleAdd = () => {
    setCount((prev) => prev + 1);
  };

  return <div onClick={handleAdd}>Count value is {count()}</div>;
};

render(() => <CountingComponent />, document.getElementById('app'));
```

è¿™ç®€ç›´æ˜¯`React hooks`çš„åŒèƒèƒå…„å¼Ÿ...

è€Œä¸”å› ä¸ºSolidJSè¿™ç§åå‘ä¼˜åŠ¿ï¼Œæ²¡æœ‰Reactæ²‰é‡çš„å†å²åŒ…è¢±ï¼Œæ¯”å¦‚ä¸éœ€è¦å¤„ç†ç±»ç»„ä»¶çš„å…¼å®¹ï¼ˆSolidJSåªæ”¯æŒå‡½æ•°å¼ï¼‰è¿™è®©å®ƒåœ¨å®ç°äº†å¤§éƒ¨åˆ†ReactåŠŸèƒ½ç‰¹æ€§çš„å‰æä¸‹ï¼Œæºç ä½“ç§¯è¦æ¯”Reactå°å¾ˆå¤šï¼Œè¿™è®©å®ƒåœ¨é¦–å±åŠ è½½æ–¹é¢å°±é¦–å…ˆå æ®ä¸Šé£ã€‚ç›´æ¥è°ƒç”¨ç¼–è¯‘å¥½çš„DOMæ“ä½œæ–¹æ³•ï¼Œçœå»äº†è™šæ‹Ÿ`DOM`æ¯”è¾ƒè¿™ä¸€æ­¥æ‰€æ¶ˆè€—çš„æ—¶é—´ï¼Œæ•´ä¸ªæ›´æ–°é“¾è·¯ç›¸æ¯”Reactå˜å¾—ç®€æ´è®¸å¤šã€‚

è°ƒç”¨æ ˆåˆ†æï¼š

![solidjs-1](https://cdn.jsdelivr.net/gh/JS-banana/images/vuepress/solidjs-1.webp)

![solidjs-2](https://cdn.jsdelivr.net/gh/JS-banana/images/vuepress/solidjs-2.webp)

ç®€å•åˆ†æï¼š

1. ç»„ä»¶å‡½æ•°åªä¼šåœ¨æ•´ä¸ªåº”ç”¨ç”Ÿå‘½å‘¨æœŸé‡Œè°ƒç”¨ä¸€æ¬¡ã€‚
2. å¿ƒæ™ºæ¨¡å‹ä¸Reactå®Œå…¨ä¸ä¸€æ ·ï¼Œåè€Œä¸vue3ä¿æŒäº†ä¸€è‡´ï¼Œå¯ä»¥è¯´å…¼å…·äº†`React hooks` + `vue3`çš„ä¼˜ç‚¹
3. `createEffect`è‡ªåŠ¨è¿½è¸ªä¾èµ–ï¼Œä¸éœ€è¦åƒreacté‚£æ ·ç»´æŠ¤ä¸€ä¸ª`dep`æ•°ç»„
4. `hook`è°ƒç”¨é¡ºåºæ²¡è¦æ±‚ï¼Œä»¥å‡½æ•°è°ƒç”¨çš„æ–¹å¼è§£å†³`Proxy`ç›®æ ‡å¿…é¡»æ˜¯å¯¹è±¡çš„é—®é¢˜

å®ƒçš„å“åº”å¼å®ç°ç¡®å®æ˜¯ä¸vueä¸€æ ·ï¼Œéƒ½æ˜¯åŸºäºå‘å¸ƒè®¢é˜…çš„ä¾èµ–æ”¶é›†å»åšçš„ï¼Œä½†å®ƒæ²¡æœ‰é‡‡ç”¨vueè™šæ‹ŸDomçš„è¿è¡Œæ—¶`diff`ï¼Œè€Œæ˜¯å……åˆ†åœ¨ç¼–è¯‘é˜¶æ®µåšæ–‡ç« ï¼Œå°†çŠ¶æ€æ›´æ–°ç¼–è¯‘ä¸ºç‹¬ç«‹çš„DOMæ“ä½œæ–¹æ³•ã€‚

### ç¼–è¯‘å†…å®¹åˆ†æ

```js
import { render, createComponent, delegateEvents, insert, template } from 'solid-js/web';
import { createSignal, createEffect } from 'solid-js';

const _tmpl$ = /*#__PURE__*/template(`<div>Count value is </div>`, 2);

const CountingComponent = () => {
  const [count, setCount] = createSignal(0);
  createEffect(() => console.log('count', count()));

  const handleAdd = () => {
    setCount(prev => prev + 1);
  };

  return (() => {
    const _el$ = _tmpl$.cloneNode(true);
          _el$.firstChild;

    _el$.$$click = handleAdd;

    insert(_el$, count, null);

    return _el$;
  })();
};

render(() => createComponent(CountingComponent, {}), document.getElementById('app'));

delegateEvents(["click"]);
```

å¯ä»¥çœ‹åˆ°ï¼Œè·ŸåŸºäº Virtual DOM çš„æ¡†æ¶ç›¸æ¯”ï¼Œè¿™æ ·çš„è¾“å‡ºä¸éœ€è¦ `Virtual DOM` çš„ `diff/patch` æ“ä½œï¼Œè‡ªç„¶å¯ä»¥çœå»å¤§é‡çš„è¿è¡Œæ—¶ä»£ç ã€‚è€Œæ˜¯ä½¿ç”¨äº†`solid-js/web`åº“æä¾›çš„`insert`ç­‰DOMå‡½æ•°æ“ä½œã€‚

å†ç»“åˆä»¥åçš„`webcomponent`è€ƒè™‘ä¸‹ï¼ŒçœŸæ˜¯å¤§æœ‰å¯ä¸ºï¼Œå‘å±•ç©ºé—´å¾ˆå¤§ï¼Œæœªæ¥å¯æœŸ~

### é¡¹ç›®å®æˆ˜

ç›´æ¥æŒ‰ç…§å®˜æ–¹æ–‡æ¡£ç¤ºä¾‹ï¼Œåˆ›å»ºä¸€ä¸ªæ”¯æŒTypeScriptçš„åŸºç¡€é¡¹ç›®ï¼Œæ¨¡æ¿é»˜è®¤ä½¿ç”¨`vite`æ„å»ºï¼ˆ[solidjs-templates](https://github.com/solidjs/templates)ï¼‰

```sh
# Typescript template
$ npx degit solidjs/templates/ts my-solid-project
$ cd my-solid-project
$ npm install # or pnpm install or yarn install
```

åœ¨viteä¸­å¼•å…¥æ’ä»¶

```ts
import solidPlugin from "vite-plugin-solid"

export default defineConfig({
  plugins: [solidPlugin()],
})
```

å…¥å£æ–‡ä»¶é…ç½®å¦‚ä¸‹ï¼š

```ts
import { render } from "solid-js/web"
import App from "./App"

render(() => <App />, document.getElementById("root"))
```

æ¥ä¸‹æ¥å°±å¯ä»¥å¼€å§‹å†™ä¸šåŠ¡ä»£ç äº†ï¼Œå°±æ˜¯è¿™ä¹ˆç®€å•~

```tsx
import { Title, List, Chart } from "./components"
import { onMount, onCleanup, createSignal } from "solid-js"
import request from "./utils/request"
import type { Component } from "solid-js"
import type { DataProps, ValueType } from "./typings"
import cls from "./index.module.less"

const URL = "/statistic/hrm"

const App: Component = () => {
  const [getValue, setValue] = createSignal<ValueType>(null)

  // mount
  onMount(() => {
    request<DataProps>({ method: "GET", url: URL }).then((res) => {
      if (res) {
        console.log("res", res)
        setValue(res)
      }
    })
  })

  // unmount
  onCleanup(() => {
    // ...
  })

  return (
    <div class={cls.App}>
      <Title />
      <List list={getValue()?.list} />
      {getValue()?.pieData && <Chart data={getValue()?.pieData} />}
    </div>
  )
}

export default App
```

Listç»„ä»¶

```tsx
import type { Component } from "solid-js"
import { ListProps } from "../typings"

import cls from "../index.module.less"

// List
const List: Component<{ list: ListProps[] }> = (props) => {
  return (
    <ul class={cls.list}>
      {props.list?.map(({ label, value }) => (
        <li>
          <div class={cls.label}>{label}</div>
          <div class={cls.value}>{value}</div>
        </li>
      ))}
    </ul>
  )
}

export default List
```

Echartå¯è§†åŒ–ç»„ä»¶

```tsx
import { onMount, onCleanup } from "solid-js"
import type { Component } from "solid-js"
import echarts, { ECOptionPie } from "../../utils/echart"
import { OptionProps } from "../../typings"

// Chart
const Chart: Component<{ data: OptionProps[] }> = (props) => {
  let container: null | HTMLDivElement = null
  let instance

  // æ€§åˆ«åˆ†å¸ƒ
  const Option: ECOptionPie = {
    // data: props.data || [],
    // ...
  }

  onMount(() => {
    instance = echarts.init(container)
    instance.setOption(Option)
    window.addEventListener("resize", () => instance?.resize())
  })

  onCleanup(() => {
    window.removeEventListener("resize", () => instance?.resize())
  })

  return <div ref={container}></div>
}

export default Chart
```

æ€ä¹ˆæ ·ï¼Œçœ‹èµ·æ¥æ˜¯ä¸æ˜¯å’Œreactç‰¹åˆ«åƒğŸ¤“ï¼Œä½¿ç”¨èµ·æ¥ä¹Ÿæ˜¯ç›¸å½“ç®€å•äº†~

## æ€»ç»“

è‡ªreactå’Œè™šæ‹ŸDOMè¯ç”Ÿä»¥æ¥ï¼Œæ•´ä¸ªå‰ç«¯çš„å¼€å‘èŒƒå¼éƒ½å‘ç”Ÿäº†ç¿»å¤©è¦†åœ°çš„å˜åŒ–ï¼Œå„ç§ç±»ä¼¼æ¡†æ¶ä¹Ÿæ˜¯å±‚å‡ºä¸ç©·ï¼Œä»–ä»¬å„æœ‰å„çš„ä¼˜åŠ¿ã€‚

å¯¹æˆ‘ä»¬å¼€å‘è€…æ¥è¯´ï¼Œå¯¹äºåŒä¸€ç±»å‹æ¡†æ¶ç†Ÿç»ƒæŒæ¡ä¸€ç§è¶³çŸ£ï¼Œå¤§å¯ä¸å¿…æ¯ç§æ¡†æ¶éƒ½å­¦ä¹ ä¸€éï¼Œæˆ‘ä»¬éœ€è¦åšåˆ°å¯¹å…¶å†…éƒ¨å®ç°åŸç†çš„çŸ¥æ‚‰ï¼Œåšåˆ°çŸ¥å…¶ç„¶ä¹ŸçŸ¥å…¶æ‰€ä»¥ç„¶ï¼Œæ­£æ‰€è°“ä¸€æ³•é€šä¸‡æ³•çš†é€šï¼Œå½“æˆ‘ä»¬æ‰“ç‰¢åŸºç¡€ä¹‹åå†å»ä½¿ç”¨å’Œå­¦ä¹ å…¶ä»–æ¡†æ¶ä¾¿è½»è€Œæ˜“ä¸¾äº†ï¼Œå¹¶åœ¨å®è·µä¸­æ‹“å±•çŸ¥è¯†å¹¿åº¦å’Œæ·±åº¦ã€‚

å¯¹äºä¸åŒç±»å‹æ¡†æ¶ï¼Œäº†è§£å…¶ä¼˜åŠ¿ä»¥åŠä¸€äº›ç‹¬æœ‰çš„ç‰¹æ®Šæ€è·¯å’Œå®ç°ï¼Œåšåˆ°å¿ƒä¸­æœ‰æ•°ï¼Œä¹Ÿæœ‰ç›Šäºæˆ‘ä»¬çš„æŠ€æœ¯æˆé•¿ã€‚

è¿™æ ·æˆ‘ä»¬åœ¨ä¹‹åçš„å®é™…å¼€å‘è¿‡ç¨‹ä¸­ä¾¿å¯ç»“åˆå…·ä½“åœºæ™¯åšåˆ°æ›´åˆé€‚çš„æŠ€æœ¯é€‰å‹~

<!-- è€Œåœ¨å®é™…å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä¹Ÿä¼šé‡åˆ°å¾ˆå¤šä¸åŒçš„åœºæ™¯ï¼Œæˆ‘ä»¬ä¹Ÿå¤§å¯ä¸æ‹˜æ³¥ä¸æŸä¸€ç§æ¡†æ¶ï¼Œè€Œæ˜¯æ ¹æ®è‡ªèº«éœ€æ±‚ï¼Œé€‰æ‹©åˆé€‚çš„æ¡†æ¶ã€‚ -->

## å‚è€ƒ

- [solid](https://www.solidjs.com/)
- [SolidJSç¡¬æ°”çš„è¯´ï¼šæˆ‘æ¯”Reactè¿˜react](https://zhuanlan.zhihu.com/p/385841019)
- [Solid-js åŸºç¡€æ•™ç¨‹](https://segmentfault.com/a/1190000040449758)
- [ä½ å¬è¯´è¿‡ No DomDiff å—ï¼Ÿ](https://jishuin.proginn.com/p/763bfbd672c0)
