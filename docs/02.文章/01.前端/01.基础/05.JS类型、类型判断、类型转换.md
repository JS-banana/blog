---
title: JSç±»å‹ã€ç±»å‹åˆ¤æ–­ã€ç±»å‹è½¬æ¢
date: 2022-04-26 15:33:02
permalink: /pages/b92fbe/
categories:
  - æ–‡ç« 
  - é¢è¯•
tags:
  - JavaScript
---

## JSç±»å‹

æœ€æ–°çš„ ECMAScript æ ‡å‡†å®šä¹‰äº† 8 ç§æ•°æ®ç±»å‹:

- 7ç§åŸå§‹ç±»å‹ï¼š`Number`ã€`String`ã€`Boolean`ã€`Null`ã€`Undefined`ã€`Symbol`ã€`BigInt`
- Objectå¼•ç”¨ç±»å‹ï¼š`Array`ã€`Object`ã€`Date`ã€`RegExp`ã€`Error`ã€`Map`ã€`Set`ã€`WeakMap`ã€`WeakSet`ï¼Œå‡ ä¹æ‰€æœ‰é€šè¿‡ `new` åˆ›å»ºçš„ï¼Œå³æ„é€ å‡½æ•°ç±»å‹

<!-- > æ³¨æ„ï¼šfunctionæ¯”è¾ƒç‰¹æ®Šï¼Œä½¿ç”¨typeofåˆ¤æ–­çš„æ—¶å€™å€¼æ˜¯"function"ï¼Œå…·ä½“å¯ä»¥çœ‹ä¸‹é¢çš„ä¾‹å­ã€‚ -->

<!-- more -->

- **Symbolç±»å‹**ï¼š`Symbol`
  - ECMAScript 2015 æ–°å¢
  - ç¬¦å·ï¼ˆ`Symbols`ï¼‰ç±»å‹æ˜¯**å”¯ä¸€**ä¸”**ä¸å¯ä¿®æ”¹**çš„åŸå§‹å€¼
  - å¯ä»¥ç”¨æ¥ä½œä¸ºå¯¹è±¡çš„é”®(key)
- **BigIntç±»å‹**ï¼š`BigInt`
  - ECMAScript 2020 æ–°å¢
  - `BigInt` å¯ä»¥è¡¨ç¤ºä»»æ„å¤§çš„æ•´æ•°ã€‚
  - å¯ä»¥ç”¨åœ¨ä¸€ä¸ªæ•´æ•°å­—é¢é‡åé¢åŠ  `n` çš„æ–¹å¼å®šä¹‰ä¸€ä¸ª `BigInt` ï¼Œå¦‚ï¼š`10n`ï¼Œæˆ–è€…è°ƒç”¨å‡½æ•° `BigInt()`ï¼ˆä½†ä¸åŒ…å« `new` è¿ç®—ç¬¦ï¼‰å¹¶ä¼ é€’ä¸€ä¸ªæ•´æ•°å€¼æˆ–å­—ç¬¦ä¸²å€¼ã€‚

```js
typeof 1n === 'bigint'; // true
typeof BigInt('1') === 'bigint'; // true
```

![emoji](https://cdn.jsdelivr.net/gh/JS-banana/images/emoji/3.jpg)

### å †å’Œæ ˆ

ä¸ºäº†æ›´æ¸…æ™°çš„æ˜ç™½æ•°æ®åœ¨å†…å­˜ä¸­çš„å­˜å‚¨ç»“æ„ï¼Œåœ¨ä»‹ç»æ•°æ®ç±»å‹ä¹‹å‰æˆ‘ä»¬å…ˆäº†è§£ä¸‹å †å’Œæ ˆçš„æ¦‚å¿µã€‚

- **æ ˆ(stack)**ï¼šæ˜¯æ ˆå†…å­˜çš„ç®€ç§°ï¼Œæ ˆæ˜¯è‡ªåŠ¨åˆ†é…ç›¸å¯¹å›ºå®šå¤§å°çš„å†…å­˜ç©ºé—´ï¼Œå¹¶ç”±ç³»ç»Ÿè‡ªåŠ¨é‡Šæ”¾ï¼Œæ ˆæ•°æ®ç»“æ„éµå¾ª`FILO`ï¼ˆfirst in last outï¼‰å…ˆè¿›åå‡ºçš„åŸåˆ™
- **å †(heap)**ï¼šæ˜¯å †å†…å­˜çš„ç®€ç§°ï¼Œå †æ˜¯åŠ¨æ€åˆ†é…å†…å­˜ï¼Œå†…å­˜å¤§å°ä¸å›ºå®šï¼Œä¹Ÿä¸ä¼šè‡ªåŠ¨é‡Šæ”¾ï¼Œå †æ•°æ®ç»“æ„æ˜¯ä¸€ç§æ— åºçš„æ ‘çŠ¶ç»“æ„

åœ¨JSä¸­çš„å­˜åœ¨å½¢å¼ä»¥åŠæˆ‘ä»¬åº”è¯¥å¦‚ä½•ç†è§£ï¼š

- **åŸºæœ¬æ•°æ®ç±»å‹**ï¼šéƒ½æ˜¯ç›´æ¥æŒ‰å€¼å­˜æ”¾åœ¨æ ˆå†…å­˜ä¸­ï¼Œå ç”¨çš„å†…å­˜ç©ºé—´çš„å¤§å°æ˜¯ç¡®å®šçš„ï¼Œå¹¶ç”±ç³»ç»Ÿè‡ªåŠ¨åˆ†é…å’Œè‡ªåŠ¨é‡Šæ”¾ã€‚
  - åŒ…æ‹¬ï¼š`Number`ã€`String`ã€`Boolean`ã€`Null`ã€`Undefined`ã€`Symbol`ã€`BigInt`
  - è¿™æ ·å¸¦æ¥çš„å¥½å¤„å°±æ˜¯ï¼Œå†…å­˜å¯ä»¥åŠæ—¶å¾—åˆ°å›æ”¶ï¼Œç›¸å¯¹äºå †æ¥è¯´ï¼Œæ›´åŠ å®¹æ˜“ç®¡ç†å†…å­˜ç©ºé—´
- **å¼•ç”¨æ•°æ®ç±»å‹**ï¼šæŒ‡é‚£äº›å¯èƒ½ç”±å¤šä¸ªå€¼æ„æˆçš„å¯¹è±¡
  - å¦‚å¯¹è±¡(`Object`)ã€æ•°ç»„(`Array`)ã€å‡½æ•°(`Function`) ï¼Œå®ƒä»¬æ˜¯é€šè¿‡æ‹·è´å’Œ`new`å‡ºæ¥çš„ï¼Œè¿™æ ·çš„æ•°æ®å­˜å‚¨äºå †ä¸­

ä¼ å€¼å’Œä¼ å€çš„åŒºåˆ«ï¼š

- **åŸºæœ¬ç±»å‹**ï¼šé‡‡ç”¨çš„æ˜¯å€¼ä¼ é€’ã€‚
  - åŸºæœ¬ç±»å‹æ˜¯æŠŠæ•°æ®çš„å€¼å­˜å‚¨äºæ ˆä¸­
  - åœ¨èµ‹å€¼çš„æ—¶å€™ï¼Œä¼šæŠŠå€¼å¤åˆ¶ä¸€ä»½åˆ°æ ˆä¸­ï¼Œç„¶åæŠŠæ ˆé¡¶çš„*å€¼èµ‹ç»™å˜é‡*
- **å¼•ç”¨ç±»å‹**ï¼šåˆ™æ˜¯åœ°å€ä¼ é€’
  - å¼•ç”¨ç±»å‹çš„æ˜¯æŠŠæ•°æ®çš„åœ°å€æŒ‡é’ˆå­˜å‚¨äºæ ˆä¸­
  - åœ¨èµ‹å€¼çš„æ—¶å€™æ˜¯å°†å­˜æ”¾åœ¨æ ˆå†…å­˜ä¸­çš„*åœ°å€æŒ‡é’ˆèµ‹å€¼ç»™æ¥æ”¶çš„å˜é‡*

```js
// 1. åŸºæœ¬ç±»å‹
// bè¢«èµ‹å€¼ä¸ºaï¼Œä¼ é€’çš„æ˜¯å€¼1
let a = 1;
let b = a;
b = 2
// a 1
// b 2

// 2. å¼•ç”¨ç±»å‹
// obj2è¢«èµ‹å€¼ä¸ºobj1ï¼Œä¼ é€’çš„æ˜¯åœ°å€
let obj1 = { name: 'zhangsan', age: 18 };
let obj2 = obj1;
obj2.age = 20;
// obj1ã€obj2éƒ½ä¼šå˜åŒ–ï¼Œå› ä¸ºåœ°å€æŒ‡å‘çš„æ˜¯åŒä¸€ä¸ª
// obj1 {name: 'zhangsan', age: 20}
// obj2 {name: 'zhangsan', age: 20}
```

> å»¶ä¼¸ï¼šæµ…æ‹·è´ã€æ·±æ‹·è´çš„ä½œç”¨

### nullå’ŒundefinedåŒºåˆ«

- éƒ½æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œè¿™ä¸¤ä¸ªåŸºæœ¬æ•°æ®ç±»å‹åˆ†åˆ«éƒ½åªæœ‰ä¸€ä¸ªå€¼ï¼Œå°±æ˜¯ `undefined` å’Œ `null`
- `undefined` ä»£è¡¨çš„å«ä¹‰æ˜¯æœªå®šä¹‰ï¼Œ`null` ä»£è¡¨çš„å«ä¹‰æ˜¯ç©ºå¯¹è±¡ã€‚
  - ä¸€èˆ¬å˜é‡å£°æ˜äº†ä½†è¿˜æ²¡æœ‰å®šä¹‰çš„æ—¶å€™ä¼šè¿”å› `undefined`ï¼Œ`null`ä¸»è¦ç”¨äºèµ‹å€¼ç»™ä¸€äº›å¯èƒ½ä¼šè¿”å›å¯¹è±¡çš„å˜é‡ï¼Œä½œä¸ºåˆå§‹åŒ–ã€‚
- `undefined` åœ¨ JavaScript ä¸­ä¸æ˜¯ä¸€ä¸ªä¿ç•™å­—
  - è¿™æ„å‘³ç€å¯ä»¥ä½¿ç”¨ `undefined` æ¥ä½œä¸ºä¸€ä¸ªå˜é‡åï¼Œä½†æ˜¯è¿™æ ·çš„åšæ³•æ˜¯éå¸¸å±é™©çš„ï¼Œå®ƒä¼šå½±å“å¯¹ `undefined` å€¼çš„åˆ¤æ–­ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€äº›æ–¹æ³•è·å¾—å®‰å…¨çš„ `undefined` å€¼ï¼Œæ¯”å¦‚è¯´ `void 0`ã€‚
- å½“å¯¹è¿™ä¸¤ç§ç±»å‹ä½¿ç”¨ `typeof` è¿›è¡Œåˆ¤æ–­æ—¶ï¼Œ`Null` ç±»å‹ä¼šè¿”å› `â€œobjectâ€`ï¼Œè¿™æ˜¯ä¸€ä¸ªå†å²é—ç•™çš„é—®é¢˜ï¼ˆè§ä¸‹é¢ç±»å‹åˆ¤æ–­éƒ¨åˆ†ï¼‰ã€‚
- å½“ä½¿ç”¨åŒç­‰å·å¯¹ä¸¤ç§ç±»å‹çš„å€¼è¿›è¡Œæ¯”è¾ƒæ—¶ä¼šè¿”å› `true`ï¼Œä½¿ç”¨ä¸‰ä¸ªç­‰å·æ—¶ä¼šè¿”å› `false`ã€‚

æ‹“å±•ï¼š

- åœ¨å®é™…å¼€å‘è¿‡ç¨‹ä¸­ä¼šä½¿ç”¨ `if(xx == null)` æ¥åˆ¤æ–­å˜é‡ `xx`æ˜¯å¦ä¸º`undefined`å’Œ`null`ï¼Œè¿™æ ·å¯ä»¥æ›´åŠ ç®€æ´ã€‚ï¼ˆåœ¨ç›®å‰æœ€æ–°çš„è¯­æ³•ä¸­`??`å°±æ˜¯åªé’ˆå¯¹`undefined`å’Œ`null`åšåˆ¤æ–­å¤„ç†çš„ï¼Œå¦‚ `let a = xx ?? 123`ï¼‰
- ä½¿ç”¨å¼•ç”¨ç±»å‹æ—¶åœ¨æ•°æ®ä¸ä½¿ç”¨çš„æ—¶å€™èµ‹å€¼ä¸º`null`ï¼Œè¿™æ ·å¯ä»¥é¿å…å†…å­˜æ³„æ¼ã€‚

### 0.1+0.2 ! == 0.3

è®¡ç®—æœºæ˜¯é€šè¿‡äºŒè¿›åˆ¶çš„æ–¹å¼å­˜å‚¨æ•°æ®çš„ï¼Œæ‰€ä»¥è®¡ç®—æœºè®¡ç®—`0.1+0.2`çš„æ—¶å€™ï¼Œå®é™…ä¸Šæ˜¯è®¡ç®—ä¸¤ä¸ªæ•°çš„äºŒè¿›åˆ¶çš„å’Œï¼Œä½†æ˜¯è¿™ä¸¤ä¸ªæ•°çš„äºŒè¿›åˆ¶éƒ½æ˜¯æ— é™å¾ªç¯çš„æ•°ã€‚

ä¸€èˆ¬æˆ‘ä»¬è®¤ä¸ºæ•°å­—åŒ…æ‹¬æ•´æ•°å’Œå°æ•°ï¼Œä½†æ˜¯åœ¨ JavaScript ä¸­åªæœ‰ä¸€ç§æ•°å­—ç±»å‹ï¼š`Number`ï¼Œå®ƒçš„å®ç°éµå¾ª**IEEE 754æ ‡å‡†**ï¼Œä½¿ç”¨64ä½å›ºå®šé•¿åº¦æ¥è¡¨ç¤ºï¼Œä¹Ÿå°±æ˜¯æ ‡å‡†çš„`double`**åŒç²¾åº¦æµ®ç‚¹æ•°**ã€‚

åœ¨äºŒè¿›åˆ¶ç§‘å­¦è¡¨ç¤ºæ³•ä¸­ï¼ŒåŒç²¾åº¦æµ®ç‚¹æ•°çš„å°æ•°éƒ¨åˆ†æœ€å¤š**åªèƒ½ä¿ç•™52ä½**ï¼Œå†åŠ ä¸Šå‰é¢çš„1ï¼Œå…¶å®å°±æ˜¯ä¿ç•™53ä½æœ‰æ•ˆæ•°å­—ï¼Œå‰©ä½™çš„éœ€è¦èˆå»ï¼Œéµä»**0èˆ1å…¥**çš„åŸåˆ™ã€‚

æ ¹æ®è¿™ä¸ªåŸåˆ™ï¼Œ0.1å’Œ0.2çš„äºŒè¿›åˆ¶æ•°ç›¸åŠ ï¼Œå†è½¬åŒ–ä¸ºåè¿›åˆ¶æ•°å°±æ˜¯ï¼š`0.30000000000000004`ã€‚

å¦‚ä½•å®ç° `0.1+0.2=0.3`:

å¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œä¸€ä¸ªç›´æ¥çš„è§£å†³æ–¹æ³•å°±æ˜¯è®¾ç½®ä¸€ä¸ªè¯¯å·®èŒƒå›´ï¼Œé€šå¸¸ç§°ä¸ºâ€œæœºå™¨ç²¾åº¦â€ã€‚å¯¹JavaScriptæ¥è¯´ï¼Œè¿™ä¸ªå€¼é€šå¸¸ä¸º`2^-52`ï¼Œåœ¨ES6ä¸­ï¼Œæä¾›äº†`Number.EPSILON`å±æ€§ï¼Œè€Œå®ƒçš„å€¼å°±æ˜¯`2^-52`ï¼Œåªè¦åˆ¤æ–­`0.1+0.2-0.3`æ˜¯å¦å°äº`Number.EPSILON`ï¼Œå¦‚æœå°äºï¼Œå°±å¯ä»¥åˆ¤æ–­ä¸º `0.1+0.2 ===0.3`

> Number.EPSILON å±æ€§è¡¨ç¤º 1 ä¸Numberå¯è¡¨ç¤ºçš„å¤§äº 1 çš„æœ€å°çš„æµ®ç‚¹æ•°ä¹‹é—´çš„å·®å€¼ã€‚
>
> EPSILON å±æ€§çš„å€¼æ¥è¿‘äº 2.2204460492503130808472633361816E-16ï¼Œæˆ–è€… 2^-52ã€‚

```js
function numberepsilon(arg1,arg2){                   
  return Math.abs(arg1 - arg2) < Number.EPSILON;        
}        

console.log(numberepsilon(0.1 + 0.2, 0.3)); // true
```

### isNaN å’Œ Number.isNaN å‡½æ•°çš„åŒºåˆ«

- å‡½æ•° `isNaN` æ¥æ”¶å‚æ•°åï¼Œä¼šå°è¯•å°†è¿™ä¸ªå‚æ•°è½¬æ¢ä¸ºæ•°å€¼ï¼Œä»»ä½•ä¸èƒ½è¢«è½¬æ¢ä¸ºæ•°å€¼çš„çš„å€¼éƒ½ä¼šè¿”å› `true`ï¼Œå› æ­¤éæ•°å­—å€¼ä¼ å…¥ä¹Ÿä¼šè¿”å› `true` ï¼Œä¼šå½±å“ `NaN` çš„åˆ¤æ–­ã€‚
- å‡½æ•° `Number.isNaN` ä¼šé¦–å…ˆåˆ¤æ–­ä¼ å…¥å‚æ•°æ˜¯å¦ä¸ºæ•°å­—ï¼Œå¦‚æœæ˜¯æ•°å­—å†ç»§ç»­åˆ¤æ–­æ˜¯å¦ä¸º `NaN` ï¼Œä¸ä¼šè¿›è¡Œæ•°æ®ç±»å‹çš„è½¬æ¢ï¼Œè¿™ç§æ–¹æ³•å¯¹äº `NaN` çš„åˆ¤æ–­æ›´ä¸ºå‡†ç¡®ã€‚

## JSç±»å‹åˆ¤æ–­

### typeof

`typeof` æ˜¯ç”±JSæä¾›çš„ï¼Œä¸»è¦æ˜¯æ£€æŸ¥æ•°æ®ç±»å‹ï¼Œå³è¿™8ç§æ•°æ®ç±»å‹ï¼Œä¸è¿‡å¯¹äºå¼•ç”¨ç±»å‹è¿”å›å€¼éƒ½æ˜¯`Object`ï¼ˆfunctioné™¤å¤–ï¼‰ï¼Œæ— æ³•åšåˆ°æ­£ç¡®åŒºåˆ†æ˜¯å“ªç§å…·ä½“ç±»å‹ï¼Œæ¯”è¾ƒåˆé€‚çš„æ–¹å¼æ˜¯ä½¿ç”¨ `instanceof`å…³é”®å­—æ¥åˆ¤æ–­å¼•ç”¨ç±»å‹ã€‚

è¿”å›å€¼å‡ä¸º**å°å†™å­—ç¬¦ä¸²**ï¼šå¦‚ `typeof undefined === "undefined"`ã€`typeof {} === "object"`

#### ç‰¹åˆ«æ³¨æ„

- `typeof null === "object"`

> åœ¨ JavaScript æœ€åˆçš„å®ç°ä¸­ï¼ŒJavaScript ä¸­çš„å€¼æ˜¯ç”±ä¸€ä¸ªè¡¨ç¤ºç±»å‹çš„æ ‡ç­¾å’Œå®é™…æ•°æ®å€¼è¡¨ç¤ºçš„ã€‚å¯¹è±¡çš„ç±»å‹æ ‡ç­¾æ˜¯ 0ã€‚ç”±äº null ä»£è¡¨çš„æ˜¯ç©ºæŒ‡é’ˆï¼ˆå¤§å¤šæ•°å¹³å°ä¸‹å€¼ä¸º 0x00ï¼‰ï¼Œå› æ­¤ï¼Œnull çš„ç±»å‹æ ‡ç­¾æ˜¯ 0ï¼Œtypeof null ä¹Ÿå› æ­¤è¿”å› "object"ã€‚

- typeofå¯ä»¥æ£€æµ‹å‡ºå‡½æ•°ç±»å‹

> é™¤ Function å¤–çš„æ‰€æœ‰æ„é€ å‡½æ•°çš„ç±»å‹éƒ½æ˜¯ 'object'

ä¸¤ä¸ªç‰¹æ®Šï¼š

- `undefined`ï¼ˆJSVAL_VOIDï¼‰æ˜¯æ•´æ•°`âˆ’2^30`ï¼ˆæ•´æ•°èŒƒå›´ä¹‹å¤–çš„æ•°å­—ï¼‰
- `null`(JSVAL_NULL) ä¸ºæœºå™¨ç `NULL`çš„ç©ºæŒ‡é’ˆï¼Œæˆ–è€…è¯´ï¼šä¸º`0`çš„objectç±»å‹æ ‡ç­¾ã€‚

åœ¨åˆ¤æ–­æ•°æ®ç±»å‹æ—¶ï¼Œæ˜¯æ ¹æ®æœºå™¨ç ä½ä½æ ‡è¯†æ¥åˆ¤æ–­çš„ï¼Œè€Œ**nullçš„æœºå™¨ç æ ‡è¯†å…¨ä¸º0**ï¼Œè€Œå¯¹è±¡çš„æœºå™¨ç ä½ä½æ ‡è¯†ä¸º000ã€‚æ‰€ä»¥`typeof null`çš„ç»“æœè¢«è¯¯åˆ¤ä¸º`Object`ã€‚

```js
function a() {}
console.log(typeof a); // function

var func = new Function();
typeof func; // è¿”å› 'function'
```

### instanceof

`instanceof` è¿ç®—ç¬¦ç”¨äºæ£€æµ‹æ„é€ å‡½æ•°çš„ `prototype` å±æ€§æ˜¯å¦å‡ºç°åœ¨æŸä¸ªå®ä¾‹å¯¹è±¡çš„åŸå‹é“¾ä¸Šã€‚

```js
function Person() {}
var boy = new Person()
console.log(boy instanceof Person) // trueï¼Œå› ä¸º Object.getPrototypeOf(o) === C.prototype
console.log(boy instanceof Object) // trueï¼Œå› ä¸º Object.prototype.isPrototypeOf(o) è¿”å› true

D.prototype = new Person() // ç»§æ‰¿
var o3 = new D()
o3 instanceof Person // true å› ä¸º Person.prototype ç°åœ¨åœ¨ o3 çš„åŸå‹é“¾ä¸Š
```

Tipsï¼šæœ‰ä¸€ä¸ªé€çº§å‘ä¸ŠæŸ¥æ‰¾çš„è¿‡ç¨‹ï¼ˆåŸå‹çš„ç»ˆç‚¹æ˜¯`null`ï¼‰

`o => Person.prototype => Object.prototype => null`

å®ç°åŸç†ï¼š

```js
function myInstanceof(left, right) {
  // è·å–å¯¹è±¡çš„åŸå‹
  let proto = Object.getPrototypeOf(left)
  // è·å–æ„é€ å‡½æ•°çš„ prototype å¯¹è±¡
  let prototype = right.prototype; 
 
  // åˆ¤æ–­æ„é€ å‡½æ•°çš„ prototype å¯¹è±¡æ˜¯å¦åœ¨å¯¹è±¡çš„åŸå‹é“¾ä¸Š
  while (true) {
    if (!proto) return false;
    if (proto === prototype) return true;
    // å¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œå°±ç»§ç»­ä»å…¶åŸå‹ä¸Šæ‰¾ï¼ŒObject.getPrototypeOfæ–¹æ³•ç”¨æ¥è·å–æŒ‡å®šå¯¹è±¡çš„åŸå‹
    proto = Object.getPrototypeOf(proto);
  }
}

// console.log(myInstanceof(boy, Person)) // true
// console.log(myInstanceof(boy, Object)) // true
```

### Object.prototype.toString

`toString()` æ–¹æ³•è¿”å›ä¸€ä¸ªè¡¨ç¤ºè¯¥å¯¹è±¡çš„å­—ç¬¦ä¸²ã€‚

```js
Object.prototype.toString.call(new Date) // [object Date]
```

åŒæ ·æ˜¯æ£€æµ‹å¯¹è±¡`obj`è°ƒç”¨`toString`æ–¹æ³•ï¼Œ`obj.toString()`çš„ç»“æœå’Œ`Object.prototype.toString.call(obj)`çš„ç»“æœä¸ä¸€æ ·ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿ

è¿™æ˜¯å› ä¸º`toString`æ˜¯`Object`çš„åŸå‹æ–¹æ³•ï¼Œè€Œ`Array`ã€`function`ç­‰ç±»å‹ä½œä¸º`Object`çš„å®ä¾‹ï¼Œéƒ½**é‡å†™äº†toStringæ–¹æ³•**ã€‚

ç›®å‰è¯¥ç§æ£€æµ‹æ–¹æ³•ç®—æ˜¯æ¯”è¾ƒå…¨é¢å‡†ç¡®çš„ï¼Œä¸”ä½¿ç”¨è¾ƒä¸ºå¹¿æ³›çš„ä¸€ç§ã€‚

### isArray

```js
Array.isArray([]) // true
```

### ç±»å‹æ£€æŸ¥é€šç”¨æ–¹æ³•

- å®˜æ–¹ç‰ˆæœ¬

```js
function type(obj, fullClass) {
    // get toPrototypeString() of obj (handles all types)
    // Early JS environments return '[object Object]' for null, so it's best to directly check for it.
    if (fullClass) {
        return obj === null ? '[object Null]' : Object.prototype.toString.call(obj)
    }
    if (obj == null) {
        return (obj + '').toLowerCase()
    } // implicit toString() conversion

    var deepType = Object.prototype.toString.call(obj).slice(8, -1).toLowerCase()
    if (deepType === 'generatorfunction') {
        return 'function'
    }

    // Prevent overspecificity (for example, [object HTMLDivElement], etc).
    // Account for functionish Regexp (Android <=2.3), functionish <object> element (Chrome <=57, Firefox <=52), etc.
    // String.prototype.match is universally supported.

    return deepType.match(/^(array|bigint|date|error|function|generator|regexp|symbol)$/)
        ? deepType
        : typeof obj === 'object' || typeof obj === 'function'
        ? 'object'
        : typeof obj
}
```

- Jqueryç‰ˆæœ¬

```js
var class2type = {};

// ç”Ÿæˆclass2typeæ˜ å°„
"Boolean Number String Function Array Date RegExp Object Error".split(" ").map(function(item, index) {
    class2type["[object " + item + "]"] = item.toLowerCase();
})

function type(obj) {
    // ä¸€ç®­åŒé›•
    if (obj == null) {
        return obj + "";
    }
    return typeof obj === "object" || typeof obj === "function" ?
        class2type[Object.prototype.toString.call(obj)] || "object" :
        typeof obj;
}
```

## ç±»å‹è½¬æ¢ã€ç›¸ç­‰ï¼ˆ==ï¼‰åˆ¤æ–­

ç­‰äºè¿ç®—ç¬¦ï¼ˆ`==`ï¼‰æ£€æŸ¥å…¶ä¸¤ä¸ªæ“ä½œæ•°æ˜¯å¦ç›¸ç­‰ï¼Œå¹¶è¿”å›`Boolean`ç»“æœã€‚ä¸ä¸¥æ ¼ç›¸ç­‰è¿ç®—ç¬¦ï¼ˆ`===`ï¼‰ä¸åŒï¼Œå®ƒä¼šå°è¯•**å¼ºåˆ¶ç±»å‹è½¬æ¢**å¹¶ä¸”**æ¯”è¾ƒä¸åŒç±»å‹**çš„æ“ä½œæ•°ã€‚

ç›¸ç­‰è¿ç®—ç¬¦ï¼ˆ`==`å’Œ`!=`ï¼‰ä½¿ç”¨æŠ½è±¡ç›¸ç­‰æ¯”è¾ƒç®—æ³•æ¯”è¾ƒä¸¤ä¸ªæ“ä½œæ•°ã€‚å¯ä»¥å¤§è‡´æ¦‚æ‹¬å¦‚ä¸‹ï¼š

- å¦‚æœä¸¤ä¸ªæ“ä½œæ•°**éƒ½æ˜¯å¯¹è±¡**ï¼Œåˆ™ä»…å½“ä¸¤ä¸ªæ“ä½œæ•°éƒ½å¼•ç”¨åŒä¸€ä¸ªå¯¹è±¡æ—¶æ‰è¿”å›`true`ã€‚
- å¦‚æœä¸€ä¸ªæ“ä½œæ•°**æ˜¯null**ï¼Œå¦ä¸€ä¸ªæ“ä½œæ•°**æ˜¯undefined**ï¼Œåˆ™è¿”å›`true`ã€‚ï¼ˆ`undefined == null`ï¼‰
- å¦‚æœä¸¤ä¸ªæ“ä½œæ•°æ˜¯**ä¸åŒç±»å‹çš„**ï¼Œå°±ä¼šå°è¯•åœ¨æ¯”è¾ƒä¹‹å‰**å°†å®ƒä»¬è½¬æ¢ä¸ºç›¸åŒç±»å‹**ï¼š
  - å½“**æ•°å­—**ä¸**å­—ç¬¦ä¸²**è¿›è¡Œæ¯”è¾ƒæ—¶ï¼Œä¼šå°è¯•**å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—å€¼**ã€‚
  - å¦‚æœæ“ä½œæ•°**ä¹‹ä¸€æ˜¯Boolean**ï¼Œåˆ™å°†å¸ƒå°”æ“ä½œæ•°è½¬æ¢ä¸º**1æˆ–0**ã€‚
  - å¦‚æœæ“ä½œæ•°**ä¹‹ä¸€æ˜¯å¯¹è±¡**ï¼Œå¦ä¸€ä¸ªæ˜¯æ•°å­—æˆ–å­—ç¬¦ä¸²ï¼Œä¼šå°è¯•ä½¿ç”¨å¯¹è±¡çš„`valueOf()`å’Œ`toString()`æ–¹æ³•å°†å¯¹è±¡è½¬æ¢ä¸º**åŸå§‹å€¼**ã€‚
- å¦‚æœæ“ä½œæ•°å…·æœ‰ç›¸åŒçš„ç±»å‹ï¼Œåˆ™å¯¹å€¼è¿›è¡Œæ¯”è¾ƒ

### ä¸€äº›è¯´æ˜ï¼Œé’ˆå¯¹å¯¹è±¡è½¬æ¢çš„æƒ…å†µ

ç›®çš„å°±æ˜¯ä¸ºäº†è½¬æ¢ä¸ºåŸå§‹å€¼

ä¸ºäº†è¿›è¡Œè½¬æ¢ï¼ŒJavaScript å°è¯•æŸ¥æ‰¾å¹¶è°ƒç”¨ä¸‰ä¸ªå¯¹è±¡æ–¹æ³•ï¼š`Symbol.toPrimitive`ã€`toString`ã€`valueOf`

- `Symbol.toPrimitive`ä¼˜å…ˆçº§æœ€é«˜ï¼Œä¸è¿‡è¿™åªé™äºå­˜åœ¨`Symbol`ç±»å‹æ—¶
- å¯¹äºå­—ç¬¦ä¸²è½¬æ¢ï¼šä¼˜å…ˆçº§æ˜¯ `toString() > valueOf()`
- å¯¹äºæ•°å­¦è¿ç®—ï¼šä¼˜å…ˆçº§æ˜¯ `valueOf() > toString()`

çœ‹ä¸ªåˆ—å­ï¼š

```js
let user = {name: "John"};

user.toString() // [object Object]
user.valueOf() // user.valueOf() === user // true valueOfæ–¹æ³•è¿”å›å¯¹è±¡æœ¬èº« {name: 'John'}

user == '[object Object]' // true
```

é»˜è®¤æƒ…å†µä¸‹ï¼Œæ™®é€šå¯¹è±¡å…·æœ‰ `toString` å’Œ `valueOf` æ–¹æ³•ï¼š

- `toString` æ–¹æ³•è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸² `"[object Object]"`
- `valueOf` æ–¹æ³•è¿”å›**å¯¹è±¡è‡ªèº«**

å†å²åŸå› ï¼š

ç”±äºå†å²åŸå› ï¼Œå¦‚æœ `toString` æˆ– `valueOf` è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™ä¸ä¼šå‡ºç° errorï¼Œä½†æ˜¯è¿™ç§å€¼ä¼šè¢«å¿½ç•¥ï¼ˆå°±åƒè¿™ç§æ–¹æ³•æ ¹æœ¬ä¸å­˜åœ¨ï¼‰ã€‚è¿™æ˜¯å› ä¸ºåœ¨ JavaScript è¯­è¨€å‘å±•åˆæœŸï¼Œæ²¡æœ‰å¾ˆå¥½çš„ â€œerrorâ€ çš„æ¦‚å¿µã€‚

ç›¸åï¼Œ`Symbol.toPrimitive` **å¿…é¡»è¿”å›ä¸€ä¸ªåŸå§‹å€¼**ï¼Œå¦åˆ™å°±ä¼šå‡ºç° errorã€‚

éªŒè¯æ•°å­¦è¿ç®—ï¼š

ä»ä¸Šé¢çš„è§„åˆ™æˆ‘ä»¬çŸ¥é“æ•°å­¦è¿ç®—è½¬æ¢è§„åˆ™çš„ä¼˜å…ˆçº§æ˜¯ï¼š`valueOf() > toString()`

```js
let obj = {
  // toString åœ¨æ²¡æœ‰å…¶ä»–æ–¹æ³•çš„æƒ…å†µä¸‹å¤„ç†æ‰€æœ‰è½¬æ¢
  toString() {
    return "2";
  }
};
console.log(obj * 2) // 4ï¼Œå¯¹è±¡è¢«è½¬æ¢ä¸ºåŸå§‹å€¼å­—ç¬¦ä¸² "2"ï¼Œä¹‹åå®ƒè¢«ä¹˜æ³•è½¬æ¢ä¸ºæ•°å­— 2
```

è½¬æ¢è¿‡ç¨‹ï¼š

1. å¯¹è±¡è¢«è½¬æ¢ä¸ºåŸå§‹å€¼ï¼ˆ`valueOf`ï¼‰

   ```js
    obj.valueOf() // {toString: Æ’} å¯¹è±¡æœ¬èº«
   ```

2. å¦‚æœç”Ÿæˆçš„åŸå§‹å€¼çš„ç±»å‹ä¸æ­£ç¡®ï¼Œåˆ™ç»§ç»­è¿›è¡Œè½¬æ¢ï¼ˆ`toString`ï¼‰

   ```js
    obj.toString() // '2' å­—ç¬¦ä¸²
   ```

#### å¯¹è±¡ â€” åŸå§‹å€¼è½¬æ¢çš„é˜¶æ®µæ€§æ€»ç»“

å¯¹è±¡åˆ°åŸå§‹å€¼çš„è½¬æ¢ï¼Œæ˜¯ç”±è®¸å¤šæœŸæœ›ä»¥åŸå§‹å€¼ä½œä¸ºå€¼çš„å†…å»ºå‡½æ•°å’Œè¿ç®—ç¬¦è‡ªåŠ¨è°ƒç”¨çš„ã€‚

è¿™é‡Œæœ‰ä¸‰ç§ç±»å‹ï¼ˆ**hint**ï¼‰ï¼š

- "string"ï¼ˆå¯¹äº alert å’Œå…¶ä»–éœ€è¦å­—ç¬¦ä¸²çš„æ“ä½œï¼‰
- "number"ï¼ˆå¯¹äºæ•°å­¦è¿ç®—ï¼‰
- "default"ï¼ˆå°‘æ•°è¿ç®—ç¬¦ï¼‰

> è§„èŒƒæ˜ç¡®æè¿°äº†å“ªä¸ªè¿ç®—ç¬¦ä½¿ç”¨å“ªä¸ª hintã€‚å¾ˆå°‘æœ‰è¿ç®—ç¬¦â€œä¸çŸ¥é“æœŸæœ›ä»€ä¹ˆâ€å¹¶ä½¿ç”¨ "default" hintã€‚é€šå¸¸å¯¹äºå†…å»ºå¯¹è±¡ï¼Œ"default" hint çš„å¤„ç†æ–¹å¼ä¸ "number" ç›¸åŒï¼Œå› æ­¤åœ¨å®è·µä¸­ï¼Œæœ€åä¸¤ä¸ª hint å¸¸å¸¸åˆå¹¶åœ¨ä¸€èµ·ã€‚

è½¬æ¢ç®—æ³•æ˜¯ï¼š

1. è°ƒç”¨ `obj[Symbol.toPrimitive](hint)` å¦‚æœè¿™ä¸ªæ–¹æ³•å­˜åœ¨
2. å¦åˆ™ï¼Œå¦‚æœ hint æ˜¯ "string"
   - å°è¯• `obj.toString()` å’Œ `obj.valueOf()`ï¼Œæ— è®ºå“ªä¸ªå­˜åœ¨ã€‚
3. å¦åˆ™ï¼Œå¦‚æœ hint æ˜¯ "number" æˆ–è€… "default"
   - å°è¯• `obj.valueOf()` å’Œ `obj.toString()`ï¼Œæ— è®ºå“ªä¸ªå­˜åœ¨ã€‚

### ä¸€ä¸ªç®€å•æµ‹è¯•

```js
const string3 = new String("hello");
const string4 = new String("hello");

console.log(string3 == string4); // false
```

ä»¥ä¸Šé¢˜ç›®åº”è¯¥ç±»æ¯”äºä¸‹é¢çš„å†™æ³•ï¼Œå³é€šè¿‡ `new` æ„é€ çš„ä¸ºå¯¹è±¡ç±»å‹ï¼Œéœ€è¦æ ¹æ®å¯¹è±¡å’Œå¯¹è±¡çš„æ¯”è¾ƒè§„åˆ™åˆ¤æ–­ï¼ˆå› ä¸ºæ˜¯ä¸¤ä¸ªä¸åŒçš„å¼•ç”¨åœ°å€ï¼Œæ‰€ä»¥è¿”å›`false`ï¼‰

```js
const object1 = {"key": "value"}
const object2 = {"key": "value"};

object1 == object2 // false
```

## æ€»ç»“

æ•°æ®ç±»å‹åšä¸ºä¸€é—¨è¯­è¨€çš„åŸºç¡€ï¼Œæ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µã€‚å¯¹äºè¿™æ–¹é¢çš„çŸ¥è¯†ç‚¹ä¸€å®šè¦å¼„æ¸…æ¥šï¼Œå¹¶æ·±å…¥ç†è§£ï¼Œè¿™æ ·æ‰èƒ½æ›´å¥½åœ°åº”ç”¨åœ¨ JavaScript ä¸­ã€‚

å„ç§é¢è¯•é¢˜çš„å˜ç§å’Œéªšæ“ä½œï¼Œéƒ½æ˜¯æ¥è‡ªå¯¹è¯­è¨€çš„æ·±å…¥ç†è§£ï¼Œå¯¹äºä¸€ä¸ª `toString`çš„ä½¿ç”¨ï¼Œå°±å¯ä»¥ç©å‡ºå¾ˆå¤šèŠ±æ ·æ¥ã€‚

ä¸è¿‡ï¼Œç”±äºJSçš„è¯ç”ŸèƒŒæ™¯æ¯”è¾ƒç‰¹æ®Šï¼Œæˆ‘ä»¬ç°åœ¨å†å›å¤´æ·±å…¥å­¦ä¹ JSçš„æ—¶å€™ï¼Œç»å¸¸ä¼šå‘ç°ä¸€äº›æœ‰å‘çš„åœ°æ–¹ï¼Œå„ç§å†å²é—ç•™å’Œè®¾è®¡ä¹‹ç±»çš„é—®é¢˜ç­‰ã€‚å¯¹äºè¿™äº›â€œç‰¹æ€§â€æˆ‘ä»¬ä¹Ÿåº”è¯¥æœ‰æ‰€äº†è§£ï¼Œåšåˆ°çŸ¥å…¶ç„¶ã€çŸ¥å…¶æ‰€ä»¥ç„¶ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬ä¹Ÿä¸èƒ½ä»¥åæ¦‚å…¨ï¼Œä¸å¾—ä¸è¯´JSç¡®å®æ˜¯ä¸€é—¨éå¸¸å¼ºå¤§çš„è¯­è¨€ï¼ˆæ¯•ç«Ÿèƒ½ç”¨JSå®ç°çš„æœ€ç»ˆéƒ½ä¼šç”¨JSå®ç°ğŸ¤ªï¼‰

æ–°çš„ECMAScriptè§„èŒƒå’Œæ ‡å‡†ä¹Ÿåœ¨ä¸æ–­åœ°å®Œå–„JSè¯­è¨€ï¼Œå„ç§æ–°ç‰¹æ€§ï¼Œå¦‚ES6ã€ES7ç­‰ç­‰ï¼Œä»¥åŠTypeScriptçš„å‡ºç°ï¼Œä¹Ÿä½¿å¾—JSè¿™é—¨è¯­è¨€æ›´åŠ ä¸°å¯Œè§„èŒƒï¼ˆæ‰¶æˆ‘èµ·æ¥ï¼Œæˆ‘è¿˜èƒ½å­¦ğŸ¤“ï¼‰

## èµ„æ–™

- [JavaScript æ•°æ®ç±»å‹å’Œæ•°æ®ç»“æ„](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Data_structures)
- [JavaScriptä¸“é¢˜ä¹‹ç±»å‹åˆ¤æ–­](https://github.com/mqyqingfeng/Blog/issues/28)
- [ä¸ºä»€ä¹ˆJavaScripté‡Œé¢typeof(null)çš„å€¼æ˜¯"object"ï¼Ÿ](https://www.zhihu.com/question/21691758)
- [ã€è¯‘ã€‘è°ˆè°ˆâ€œtypeof nullä¸ºobjectâ€è¿™ä¸€bugçš„ç”±æ¥](https://juejin.cn/post/6844903841952071693)
- [typeof](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/typeof)
- [Equality (==)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Equality)
- [å¯¹è±¡ â€” åŸå§‹å€¼è½¬æ¢](https://zh.javascript.info/object-toprimitive)
