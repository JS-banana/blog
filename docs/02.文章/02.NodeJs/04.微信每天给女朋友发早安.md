---
title: 微信每天自动给女朋友发早安和情话
date: 2021-12-21 17:26:51
permalink: /pages/5fe09e/
categories:
  - 文章
  - NodeJs
tags:
  - 
---

微信通知，每天给女朋友发早安、情话、诗句、天气信息等~

<!-- more -->

## 技术方案分析

### wechaty

文档：[wechaty](https://wechaty.gitbook.io/wechaty/v/zh/)

能做到微信几乎所有的功能和能力，当你有个小号微信时，你完全可以把它交由 wechaty控制，再通过代码设计各种能力，可玩性完全由你的想法决定

自动回复、加群、定时推送、回复、AI接口能力结合等等很多。。。

硬性条件是需要 wechaty官方提供的 token来获取权限，目前方式有两种

- 方式一：联系相关人员购买
- 方式二：参与开发者计划，贡献项目并被采纳，免费提供

相关文档：<https://github.com/juzibot/Welcome/wiki/Everything-about-Wechaty>

### 钉钉、飞书、企业微信

企业级应用的好处就是可玩性、可定制很高，官方有开放和提供很多API接口和权限，机器人、自定义应用、小程序等，潜力还是蛮大的。

存在问题：

中国社交APP真实情况，排除企业组织使用，个人而言微信第一优先，不管是消息通知还是其他能力，但矛盾的地方是，个人微信限制很多，几乎不提供这种开发API的能力。如果可以接受第二个应用钉钉或飞书，可自行考虑。

新的思路：

企业微信作为微信自己产品的一些天然优势，我们可以通过微信提供的在微信内关注后，可以在微信内接受企业微信内的消息，能力由企业微信实现，通知到微信由这种方式实现。

### 总结

有条件优先使用 wechaty实现，没条件可以退而求其次采取方案二 企业微信 + 微信 的方式。

## 准备

### 1.注册企业

用电脑打开[企业微信官网](https://work.weixin.qq.com/)，注册一个企业。有手机号就可以注册，不用营业执照！不用营业执照！不用营业执照！

### 2.创建应用

注册成功后，点「管理企业」进入管理界面，选择「应用管理」 → 「自建」 → 「创建应用」

应用名称随意填，可见范围可以选择公司名。

创建完成后进入应用详情页，可以得到应用ID( agentid )，应用Secret( secret )。

### 3.获取企业ID

进入「我的企业」页面，拉到最下边，可以得到企业ID。

### 4.推送消息到微信

进入「我的企业」 → 「微信插件」，拉到下边扫描二维码，关注以后即可收到推送的消息。

> 注：如果出现接口请求正常，企业微信接受消息正常，个人微信无法收到消息的情况：
>
> 1.进入「我的企业」 → 「微信插件」，拉到最下方，勾选 “允许成员在微信插件中接收和回复聊天消息”
>
> 2.在企业微信客户端 「我」 → 「设置」 → 「新消息通知」中关闭 “仅在企业微信中接受消息” 限制条件

### 5.添加环境变量

在 Github 的 Secrets 中在添加三个变量：

1. Name 是WX_APP_ID，Value 是第二步的 AgentId。
2. Name 是WX_APP_SECRET，Value 是第二步 Secret。
3. Name 是WX_COMPANY_ID，Value 是第三步的 企业ID。

```txt
WX_COMPANY_ID= 企业ID
WX_APP_ID= 应用ID
WX_APP_SECRET= 应用 Secret
TIAN_API_KEY= 天行数据 key
```

### 6.GitHub Action每天自动执行

核心代码如下

```yml
schedule:
  # `分 时 天 月 周` 时按照标准时间 北京时间=标准时间+8 18表示北京时间早上2点
  # 早上 7:30
  - cron: '30 23 * * *'
```

## 数据赋能API

这里我们可以自己选择第三方开放API进行定制，或者自己定制

> 注：免费开源接口需要考虑服务稳定性！

我测试了几个免费的接口API：

- 土味情话：<https://lovelive.tools/>
- 多种接口：<https://api.vvhan.com/> （稳定性待确定）
- 天行数据：<https://www.tianapi.com/>
  - 免费接口数量：15个
  - 每日赠送次数：100次

最后我选择了天行数据，先去[官网](https://www.tianapi.com/)注册一个账号，拿到私钥Key，接口请求时需要，结合我们的场景，针对非会员用户，官方免费提供15个接口，单个接口每天100次的调用，足够了，其他接口需求自费也不贵，可以自行考虑~

注：如果采取该接口，需要在 **5.添加环境变量**这一步中，再添加Key的变量

## 看效果

天气信息及早安情话

```txt
致宝贝的今日内容
2021年12月18日

这是我们相识的第267天

今日天气状况：
天气：晴
西南风：3-4级
温度：-1℃-8℃
湿度：56%
空气：良|69

今日诗句：
张先|浣溪沙·楼倚春江百尺高
花片片飞风弄蝶，柳阴阴下水平桥。

今日情话：
如果你是五彩的糖，那我就当保护你小小的糖纸
```

笑话等其他信息

```txt
今日笑话：
偶睡觉的时候喜欢平躺着把腿弯向两侧，往往会占很大的床铺面积，于是
老婆很不满，问：你为什么睡觉像只蛤蟆？我答：养蝌蚪啊。

一句一言：
龙儿是我的，谁都不准碰！

今日英语（Dec 18 2021）：
While there is life, there is hope.
生命不息，希望不止。
```

内容完全由你发挥，可玩性很高~
