---
title: 配置文件分析之json、yaml、toml
date: 2022-09-06 18:53:10
permalink: /pages/131a7a/
categories:
  - 文章
tags:
  - 
---

## 前言

配置文件，不言而喻，主要用来我们进行项目和工程配置的关键文件。

如果是站在前端角度说的话，我们最常接触的就是 `json`以及 `js`类型的文件，这些配置对前端非常友好，因为都是我们熟悉的 JS 对象结构，如：

- `package.json`
- `webpack.config.js`
- `babel.config.js`
- `vue.config.js`

<!-- more -->

不过，随着技术的更新迭代，也涌现出一些新的配置文件，相比较而言，原有的文件结构好像也变得不是那么好用了。毕竟在此之前，`json`+`js`用着也不错，不过，当新的工具出现后，在使用之后发现很好用，也便开始嫌弃之前的家伙了~

毕竟站在新工具诞生的角度看，其必然有着一定的历史原因，如：旧工具在某些场景表现吃力，需要更优的替代方案。

## 背景

最近在做开源项目的时候，在开发许多功能时，考虑到不同场景、不同用户的不同需求，在开始设计功能时就考虑到预留一定的可定制窗口用于用户进行定制化配置，包括在功能不断开发进行时，以及后期的迭代拓展时，都会源源不断的诞生出各种小功能和定制需求，因此对于一个足够简单易用的配置文件选择也是相当有必要的。

在此之前的版本，我已经针对该想法做了初步的实施落地，从个人经验来说，我之前在搞 CI/CD 自动化部署相关的东西时，写过一些**github action**（配置文件为`yaml`格式），因此，对于`yaml`语法算是有些了解。

从使用感受上来说，它语法**更简洁**、**支持注释**，所以，我果断选择了`yaml`作为我对于项目的配置文件格式。

不过，在最近这段时间的使用过程中，我也发现了`yaml`存在的一些问题，因此，最近我又重新思考了下这个事情：

1. 还是按照传统的`js`文件的对象写法呢？
2. 还是继续使用`yaml`作为配置文件使用呢？
3. 还是进一步研究一些其他类型的配置文件呢？

秉持学习的心理，也不能在遇到问题的时候就选择逃避，本篇文章也算是对其他类型的配置文件的一种研究和学习了。

## 简单介绍

### JSON

JSON的定义一般是作为数据格式，不过也有很多工具将其作为配置文件使用。

其实使用JSON作为配置文件也有其一定的优势：

1. 语法非常简单
2. 很多编程语言的标准库都支持 JSON，比如：在JS当中你可以直接引入读取
3. 现在几乎所有的工具都提供 JSON 支持，包括语法突出显示、自动格式化、验证工具等。

但是，它天生就注定了并不适合作为配置文件使用，原因也很明显：

1. 不支持注释：对于配置文件来说，注释的重要性不言而喻（JSON 是一种数据交换格式😅）
2. 语法非常严格：每个属性和值必须使用""引号

### YAML

空格、缩进

## 用法对比

1. 对象

    ```json
    {
      "name": "cat",
    }
    ```

    ```yaml
    name: cat
    ```

    ```toml
    name = "cat"
    ```

    嵌套写法

    ```json
    {
      "name": "cat",
      "physical": {
        "color": "orange",
        "age": 1
      }
    }
    ```

    ```yaml
    name: cat
    physical:
      color: orange
      age: 1
    ```

    ```toml
    name = "cat"
    physical.color = "orange"
    physical.age = 1
    ```

2. 数组

    ```json
    {
      "names": ["dog", "cat"]
    }
    ```

    ```yaml
    names:
      - dog
      - cat 
    ```

    ```toml
    names = ["dog", "cat"]
    ```

3. 数组对象

    ```json
    {
      "names": [{"name": "dog", "age": 1},{"name": "cat", "age": 2}]
    }
    ```

    ```yaml
    names:
      - name: dog
        age: 1
      - name: cat 
        age: 2 
    ```

    ```toml
    # 方式一 数组
    names = [{name = "dog", age = 1}, {name = "cat", age = 2}]

    # 方式二 表数组
    [[names]]
    name = "dog"
    age = 1

    [[names]]
    name = "cat"
    age = 2
    ```

## 资料

- [toml](https://toml.io/cn/v1.0.0)
- [TOML 教程 - 可能是目前最好的配置文件格式](https://zhuanlan.zhihu.com/p/50412485)
- [现代配置指南——YAML 比 JSON 高级在哪？](https://segmentfault.com/a/1190000041108051)
