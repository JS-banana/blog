(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{534:function(s,t,a){"use strict";a.r(t);var n=a(43),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("blockquote",[a("p",[s._v("前端组件化系列文章第二篇")]),s._v(" "),a("p",[s._v("一个使用 pnpm + workspace + changeset 的 monorepo 多包管理组件化项目")]),s._v(" "),a("p",[s._v("第一篇看这里："),a("a",{attrs:{href:"https://juejin.cn/post/7139513166613970958",target:"_blank",rel:"noopener noreferrer"}},[s._v("【前端组件化】系列文章第一篇——方案探究"),a("OutboundLink")],1)])]),s._v(" "),a("h2",{attrs:{id:"前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[s._v("#")]),s._v(" 前言")]),s._v(" "),a("p",[s._v("在上一篇的"),a("a",{attrs:{href:"https://juejin.cn/post/7139513166613970958",target:"_blank",rel:"noopener noreferrer"}},[s._v("前端组件化方案探究"),a("OutboundLink")],1),s._v("中，我们研究了什么是组件化以及我们为什么需要组件化。也调研和测试了一些开源项目，并且在使用、学习、研究、对比之后最终确定了以 "),a("code",[s._v("pnpm")]),s._v(" + "),a("code",[s._v("workspace")]),s._v(" + "),a("code",[s._v("changeset")]),s._v(" 为技术方向的 "),a("strong",[s._v("monorepo 多包管理方案")]),s._v("。")]),s._v(" "),a("ul",[a("li",[s._v("本文主要是沿着该路线进行项目落地，是一篇聚焦于实战的文章。")]),s._v(" "),a("li",[s._v("文章的目标是能够让未接触过"),a("code",[s._v("monorepo")]),s._v("架构的新手也能从0到1的完成一个多包管理的前端组件化项目")])]),s._v(" "),a("p",[s._v("细致一点的说，我们主要从这几个方面入手：")]),s._v(" "),a("ol",[a("li",[a("code",[s._v("monorepo")]),s._v("项目架构的搭建")]),s._v(" "),a("li",[s._v("整个项目的工程化规范搭建")]),s._v(" "),a("li",[s._v("子项目的配置和构建配置，包括出入口管理、"),a("code",[s._v("webpack")]),s._v("打包")]),s._v(" "),a("li",[s._v("文档站点的搭建")]),s._v(" "),a("li",[s._v("版本管理和发布")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/JS-banana/images/emoji/3.jpg",alt:"emoji"}})]),s._v(" "),a("h2",{attrs:{id:"使用-pnpm-快速搭建一个-monorepo-项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-pnpm-快速搭建一个-monorepo-项目"}},[s._v("#")]),s._v(" 使用 pnpm 快速搭建一个 monorepo 项目")]),s._v(" "),a("p",[s._v("在上一篇文章中我们描述了什么是"),a("code",[s._v("monorepo")]),s._v("，以及"),a("code",[s._v("pnpm")]),s._v("的"),a("code",[s._v("workspace")]),s._v("工作空间概念，简单理解的话就是两个方面：")]),s._v(" "),a("ul",[a("li",[s._v("如何通过一个工程管理多个项目的依赖")]),s._v(" "),a("li",[s._v("如何通过一个工程管理多个项目间的相互依赖")]),s._v(" "),a("li",[s._v("如何通过一个工程管理多个项目的版本")])]),s._v(" "),a("p",[s._v("这里，我们主要围绕这几个核心思想展开工作。")]),s._v(" "),a("h3",{attrs:{id:"创建主项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建主项目"}},[s._v("#")]),s._v(" 创建主项目")]),s._v(" "),a("p",[s._v("首先，我们先创建一个主项目，在命令行中执行：")]),s._v(" "),a("ol",[a("li",[a("code",[s._v("mkdir my-monorepo-app && cd my-monorepo-app")])]),s._v(" "),a("li",[a("code",[s._v("pnpm init")])])]),s._v(" "),a("p",[s._v("接下来我们创建一个"),a("strong",[s._v("packages")]),s._v("目录作为我们的子项目目录使用，然后再创建几个子项目，如下：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("├── "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("json       \n├── packages           "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 子项目目录")]),s._v("\n  ├── components       "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// UI基础组件")]),s._v("\n  ├── pro"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("sqltiptree   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 高级业务组件")]),s._v("\n  ├── utils            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 工具类")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("在主目录下简单配置下"),a("code",[s._v(".gitignore")]),s._v("：")]),s._v(" "),a("div",{staticClass:"language-.gitignore line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("/**/node_modules/\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("因为是多包项目，存在主和子关系的嵌套结构，过滤规则需要考虑子目录下的情况（"),a("code",[s._v("**/node_modules")]),s._v("）")]),s._v(" "),a("p",[s._v("准备工作差不多了，接下来我们配置下工作空间（"),a("code",[s._v("workspace")]),s._v("），为安装"),a("code",[s._v("npm")]),s._v("包和依赖管理做准备。")]),s._v(" "),a("p",[s._v("其实对于使用"),a("code",[s._v("pnpm")]),s._v("的项目来说，还是比较简单的，我们只需要在主目录下创建一个"),a("code",[s._v("pnpm-workspace.yaml")]),s._v(" 文件即可开启"),a("code",[s._v("pnpm")]),s._v("的工作空间功能。")]),s._v(" "),a("blockquote",[a("p",[s._v("pnpm 内置了对单一存储库（也称为多包存储库、多项目存储库或单体存储库）的支持， 你可以创建一个 workspace 以将多个项目合并到一个仓库中。")])]),s._v(" "),a("p",[a("code",[s._v("Workspace")]),s._v(" 协议更多的是对一个项目下多子项目的管理以及依赖管理。")]),s._v(" "),a("p",[s._v("我们先把"),a("code",[s._v("packages")]),s._v("目录添加到工作空间中，"),a("code",[s._v("pnpm-workspace.yaml")]),s._v("配置如下：")]),s._v(" "),a("div",{staticClass:"language-yml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("packages")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" packages/*\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("这样的话，所有在 "),a("code",[s._v("packages")]),s._v(" 目录下的项目都会被工作空间统一接管，该目录下的子项目可以相互引用依赖，而不必重复安装，尤其是针对本地开发包的管理使用，提供了极大的方便，具体细节我们继续往下看~")]),s._v(" "),a("h3",{attrs:{id:"安装依赖"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装依赖"}},[s._v("#")]),s._v(" 安装依赖")]),s._v(" "),a("p",[a("strong",[s._v("monorepo")]),s._v("最主要的功能就是对于依赖的管理👀")]),s._v(" "),a("h4",{attrs:{id:"_1-全局共用的依赖"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-全局共用的依赖"}},[s._v("#")]),s._v(" 1. 全局共用的依赖")]),s._v(" "),a("p",[s._v("对于使用比较频繁的依赖，在多个子项目中都有用到的情况，比如我们当前技术栈为"),a("code",[s._v("vue2")]),s._v("，那么核心库 "),a("code",[s._v("vue")]),s._v("、"),a("code",[s._v("vue-router")]),s._v("基本都会用到，以及一些通用工具，如 "),a("code",[s._v("lodash")]),s._v("、"),a("code",[s._v("dayjs")]),s._v("等，此时，就可以采用全局安装的方式，这样做的好处是所有的子项目都可以直接引入使用（此时的依赖是安装在主目录下的 "),a("code",[s._v("node_modules")]),s._v(" 中的）。")]),s._v(" "),a("blockquote",[a("p",[s._v("如果全局中没有依赖，而子项目中有相同的依赖，你也不用担心，pnpm也会自动优化处理，通过软连接的方式安装一次就可以，可以实现最小化安装产物，非常的好用😎~")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pnpm")]),s._v(" i vue@^2.6.11 dayjs -Dw\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[a("code",[s._v("pnpm i")]),s._v(" 与 "),a("code",[s._v("pnpm add")]),s._v(" 功能是一样的")]),s._v(" "),a("li",[a("code",[s._v("-D")]),s._v("：作为开发依赖使用")]),s._v(" "),a("li",[a("code",[s._v("-w")]),s._v("：表示把包安装在 "),a("strong",[s._v("root")]),s._v(" 下，该包会放置在 "),a("code",[s._v("<root>/node_modules")]),s._v(" 下")])]),s._v(" "),a("h4",{attrs:{id:"_2-单一子项目的依赖"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-单一子项目的依赖"}},[s._v("#")]),s._v(" 2. 单一子项目的依赖")]),s._v(" "),a("p",[s._v("作为一个多包项目，肯定会存在某个项目独有的一些依赖，这个时候我们就可以针对性的安装到指定子目录。")]),s._v(" "),a("blockquote",[a("ul",[a("li",[a("p",[s._v("这里我们只需要关注使用层面即可，对于多个子项目是否存在相同的依赖，是否会重复安装，你完全不用担心，pnpm会优雅的帮你处理好。")])]),s._v(" "),a("li",[a("p",[s._v("你可以这样理解——pnpm会优先保证只下载一个依赖，当你在另一个子项目中也安装了同样的依赖时，pnpm不会再傻傻的去服务器重新下载一份。")])]),s._v(" "),a("li",[a("p",[s._v("对pnpm的设计实现原理感兴趣的可以参考这篇文章"),a("a",{attrs:{href:"https://juejin.cn/post/7127295203177676837",target:"_blank",rel:"noopener noreferrer"}},[s._v("pnpm 是凭什么对 npm 和 yarn 降维打击的"),a("OutboundLink")],1),s._v("，这里不再赘述~")])])])]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 语法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pnpm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("package-name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" --filter "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("target-package-name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 比如要将lodash装到components下")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --filter 后面可以为目录名称也可以为 package.josn 的 name 名称")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 比较推荐的做法是根据 package.josn 的 name 名称进行区别")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pnpm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" lodash --filter @ah-ailpha/components\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("ul",[a("li",[a("code",[s._v("--filter")]),s._v("：过滤，过滤允许您将命令限制于包的特定子集，一般用于 "),a("code",[s._v("packages/*")]),s._v(" 下面的子项目。")])]),s._v(" "),a("p",[s._v("如下，我们需要安装 "),a("code",[s._v("iview")]),s._v(" 到 "),a("code",[s._v("components")]),s._v(" 子项目中，那么，标准的做法是:")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("先查看 "),a("code",[s._v("packages/components/package.json")]),s._v(" 中的 "),a("code",[s._v("name")]),s._v(" 字段，把它作为 "),a("code",[s._v("filter")]),s._v(" 的作用域条件")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// components 子项目的目录结构")]),s._v("\n├── packages           "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 子项目目录")]),s._v("\n  ├── components       "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// UI基础组件")]),s._v("\n    ├── "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("json   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// name: @ah-ailpha/components")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("然后，"),a("strong",[s._v("在根目录下")]),s._v("执行安装命令，并指定 "),a("code",[s._v("filter")])]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装 iview 到 components子项目中")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pnpm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" iview --filter @ah-ailpha/components\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("查看项目依赖变化")]),s._v(" "),a("p",[s._v("这个时候你应该可以发现 "),a("code",[s._v("components")]),s._v(" 子项目的 "),a("code",[s._v("package.json")]),s._v(" 文件的 "),a("code",[s._v("dependencies")]),s._v(" 属性是变化了的，而且应当只有这个子项目是受影响的。")]),s._v(" "),a("blockquote",[a("p",[s._v("删除等操作命令保持一致，限定作用域即可，如：pnpm rm iview --filter @ah-ailpha/components")])]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"dependencies"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"iview"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^3.5.4"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])])])]),s._v(" "),a("h4",{attrs:{id:"_3-子项目互相作为依赖"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-子项目互相作为依赖"}},[s._v("#")]),s._v(" 3. 子项目互相作为依赖")]),s._v(" "),a("p",[s._v("作为 "),a("strong",[s._v("monorepo")]),s._v(" 管理的项目，这一步的功能才是最为核心的（🙋‍♂️敲黑板啦！！！）。")]),s._v(" "),a("p",[s._v("以标准的组件库项目为例：")]),s._v(" "),a("ol",[a("li",[s._v("我们一般会把"),a("strong",[s._v("组件类")]),s._v("代码单独做为一个子项目进行管理")]),s._v(" "),a("li",[a("strong",[s._v("文档网站")]),s._v("也会作为一个子项目单独管理")]),s._v(" "),a("li",[a("strong",[s._v("工具类")]),s._v("也会作为一个子项目单独管理")]),s._v(" "),a("li",[s._v("以及可能根据个人业务需求还有"),a("strong",[s._v("其他功能包")]),s._v("（cli等等）")])]),s._v(" "),a("p",[s._v("但是这些子项目又不是完全独立的，他们之间存在着一些相互依赖关系，如：")]),s._v(" "),a("ul",[a("li",[s._v("组件代码会依赖于工具类的一些方法")]),s._v(" "),a("li",[s._v("文档网站会依赖于组件和工具类（我的UI文档网站肯定用的是我自己的UI组件😄）")])]),s._v(" "),a("p",[s._v("最终他们都会作为一个独立的模块提供给用户，因此，从使用者的角度考虑，我们最好也保持这种使用方式——"),a("strong",[s._v("npm安装包的形式")]),s._v("（"),a("code",[s._v("import utils from '@an-ailpha/utils'")]),s._v("）。")]),s._v(" "),a("p",[s._v("那么，当我把其中一个子项目作为另一个项目的依赖时，如何实现我在本地调试开发的时候，能够做到类似安装"),a("code",[s._v("npm远程包")]),s._v("一样使用呢（而不是通过路径引用去使用，这样做既不优雅也不方便，当我们发布之后，路径引用就会失效）？以及如何保证我所引用的依赖都是最新的、实时的呢？因为我不可能没调整一点代码就重新发个"),a("code",[s._v("npm")]),s._v("包，然后子项目再重新下载一遍，以这种方式验证吧。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/JS-banana/images/emoji/2.jpg",alt:"emoji"}})]),s._v(" "),a("p",[s._v("令人高兴的是，"),a("code",[s._v("pnpm")]),s._v(" 的 "),a("strong",[s._v("workspace")]),s._v(" 工作空间的功能可以完全满足我们的需求，它可以实现这种效果。")]),s._v(" "),a("p",[s._v("如：子项目"),a("code",[s._v("packages/components")]),s._v("需要使用"),a("code",[s._v("packages/utils")]),s._v("子项目作为项目依赖时，我们直接按照 "),a("code",[s._v("npm")]),s._v(" 安装依赖的逻辑使用即可✅")]),s._v(" "),a("p",[s._v("目录结构：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("├── packages           "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 子项目目录")]),s._v("\n  ├── components       "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// UI基础组件")]),s._v("\n    ├── "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("json   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// name: @ah-ailpha/components")]),s._v("\n  ├── utils            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 工具类")]),s._v("\n    ├── "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("json   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// name: @ah-ailpha/utils")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("ol",[a("li",[a("p",[s._v("查看 "),a("code",[s._v("packages/utils/package.json")]),s._v("、"),a("code",[s._v("packages/components/package.json")]),s._v(" 中的 "),a("code",[s._v("name")]),s._v(" 字段")])]),s._v(" "),a("li",[a("p",[s._v("然后，"),a("strong",[s._v("在根目录下")]),s._v("执行安装命令，并指定 "),a("code",[s._v("filter")])]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 把子模块 packages/utils 当成依赖安装到 packages/components")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pnpm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" @ah-ailpha/utils --filter @ah-ailpha/components\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("查看依赖变化")]),s._v(" "),a("p",[s._v("这个时候你应该可以发现 "),a("code",[s._v("components")]),s._v(" 子项目的 "),a("code",[s._v("package.json")]),s._v(" 文件的 "),a("code",[s._v("dependencies")]),s._v(" 属性是变化了的:")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"dependencies"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"@ah-ailpha/utils"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"workspace:^1.0.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"iview"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^3.5.4"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("ul",[a("li",[a("code",[s._v('"@ah-ailpha/utils": "workspace:^1.0.0"')]),s._v("，这是"),a("code",[s._v("pnpm")]),s._v("的"),a("code",[s._v("workspace")]),s._v("工作空间协议写法")])]),s._v(" "),a("blockquote",[a("p",[s._v("它实现的效果是：当utils子项目中的代码更新后，你在 components 中引用的代码也一定是最新的，你可以理解为他俩已经形成了绑定关系，你变我就变~（版本更新时也不用担心，具体可以看下面的版本管理部分的详细说明）")])]),s._v(" "),a("ul",[a("li",[s._v("需要指出的是，当你在执行发布操作之后，"),a("code",[s._v("npm")]),s._v("包中的版本会被自动更新为指定目录下"),a("code",[s._v("package.json")]),s._v(" 的 "),a("code",[s._v("version")]),s._v("值")])]),s._v(" "),a("blockquote",[a("p",[s._v("如果，此时"),a("code",[s._v("utils/package.json")]),s._v("中的"),a("code",[s._v("version")]),s._v("值为"),a("code",[s._v("1.1.0")]),s._v("，那么上面的"),a("code",[s._v('"@ah-ailpha/utils": "workspace:^1.0.0"')]),s._v("会自动更新为"),a("code",[s._v('"@ah-ailpha/utils": "^1.1.0"')])]),s._v(" "),a("p",[s._v("不过，在实际开发中，我们一般会使用另一种写法，请继续往下看~🧐")])])])]),s._v(" "),a("h3",{attrs:{id:"简单说说npm版本规范"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#简单说说npm版本规范"}},[s._v("#")]),s._v(" 简单说说npm版本规范")]),s._v(" "),a("p",[s._v("从上面的安装依赖中，我们可以发现"),a("code",[s._v("npm")]),s._v("中的一些版本规则："),a("code",[s._v("^")]),s._v("，这也是我们比较常见的，"),a("code",[s._v("npm")]),s._v("的默认按照逻辑是按照这个规则执行的，其他前缀还有："),a("code",[s._v("~")]),s._v("、"),a("code",[s._v("*")]),s._v("，那么它们是什么意思呢？作用又是什么呢？")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("我们先了解下版本格式：")]),s._v(" "),a("p",[a("strong",[s._v("主版本号.次版本号.修订号")])])]),s._v(" "),a("li",[a("p",[s._v("版本号递增规则如下：")]),s._v(" "),a("ol",[a("li",[s._v("主版本号：当你做了不兼容的 API 修改，")]),s._v(" "),a("li",[s._v("次版本号：当你做了向下兼容的功能性新增，")]),s._v(" "),a("li",[s._v("修订号：当你做了向下兼容的问题修正。")])]),s._v(" "),a("blockquote",[a("p",[s._v("先行版本号及版本编译信息可以加到“主版本号.次版本号.修订号”的后面，作为延伸。")]),s._v(" "),a("p",[s._v("比如，我们经常在开源项目中见到的：alpha、beta 、rc")])])])]),s._v(" "),a("p",[s._v("这里不再做过多赘述，感兴趣的可以看这里 "),a("a",{attrs:{href:"https://semver.org/lang/zh-CN/",target:"_blank",rel:"noopener noreferrer"}},[s._v("语义化版本号标准"),a("OutboundLink")],1)]),s._v(" "),a("ul",[a("li",[a("p",[s._v("npm 的版本匹配策略")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("^1.0.1")]),s._v("：只要主版本一致都匹配（1.x），如："),a("code",[s._v("1")]),s._v("、"),a("code",[s._v("1.x")])]),s._v(" "),a("li",[a("code",[s._v("~1.0.1")]),s._v("：只要主版本和次版本一致都匹配（1.1.x），如："),a("code",[s._v("1.1")]),s._v("、"),a("code",[s._v("1.1.x")])]),s._v(" "),a("li",[a("code",[s._v("*")]),s._v(" ：全匹配，不受版本号影响，可以命中一切新发布的版本号")])])])]),s._v(" "),a("p",[s._v("不过，就针对我们这个项目来说，它的"),a("code",[s._v("workspace")]),s._v("协议也是符合"),a("code",[s._v("npm")]),s._v("版本规范的，我们子项目内的引用也可以采用对应的匹配策略。")]),s._v(" "),a("p",[s._v("但是，不同于用户使用，我们各子项目为了方便不受版本影响，从而做到匹配一致，一般采用"),a("code",[s._v("*")]),s._v("全匹配策略，从开发调试的角度考虑，各子项目间的依赖引用应该都是最新的代码，这一点是需要清楚的。")]),s._v(" "),a("p",[s._v("你可以这样安装使用：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pnpm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" @ah-ailpha/utils@* --filter @ah-ailpha/components\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("然后，依赖会变成这样：")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"dependencies"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"@ah-ailpha/utils"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"workspace:*"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("目前，这种写法也是子项目间依赖引用比较推荐的，依赖关系不受版本影响，可以做到相对统一。")]),s._v(" "),a("h3",{attrs:{id:"小结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#小结"}},[s._v("#")]),s._v(" 小结")]),s._v(" "),a("ol",[a("li",[s._v("所有的命令操作都是在主目录下进行的，用户视角应始终在主目录下才对")]),s._v(" "),a("li",[s._v("各子项目的"),a("code",[s._v("package.json")]),s._v("的"),a("code",[s._v("name")]),s._v("应该符合该规范——"),a("code",[s._v("@ah-ailpha/components")]),s._v(" "),a("ul",[a("li",[s._v("这样做的好处之一是可以帮我们统一作用域前缀")]),s._v(" "),a("li",[s._v("其次，当我们发布npm包时，"),a("code",[s._v("@ah-ailpha")]),s._v("会作为npm的一个组织域使用")])])]),s._v(" "),a("li",[s._v("子项目内部引用使用npm "),a("code",[s._v("*")]),s._v("全匹配策略")])]),s._v(" "),a("h2",{attrs:{id:"monorepo项目的工程化搭建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#monorepo项目的工程化搭建"}},[s._v("#")]),s._v(" monorepo项目的工程化搭建")]),s._v(" "),a("p",[s._v("一个基本标准就是：所有的规范配置都应以主目录为起点开始。")]),s._v(" "),a("p",[s._v("目前工程规范有："),a("code",[s._v("eslint")]),s._v("、"),a("code",[s._v("prettier")]),s._v("、"),a("code",[s._v("markdownlint")]),s._v("、"),a("code",[s._v("commitlint")]),s._v("、"),a("code",[s._v("typescript")])]),s._v(" "),a("h3",{attrs:{id:"为什么在vue2的项目中引入了typescript"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#为什么在vue2的项目中引入了typescript"}},[s._v("#")]),s._v(" 为什么在vue2的项目中引入了typescript")]),s._v(" "),a("p",[s._v("我们都知道"),a("code",[s._v("vue2")]),s._v("版本对"),a("code",[s._v("ts")]),s._v("的支持很一般，相关生态库大多也都是"),a("code",[s._v("js")]),s._v("开发的，包括"),a("code",[s._v("iview")]),s._v("也是使用"),a("code",[s._v("js")]),s._v("开发的；那么，我这里为什么依旧采用了对"),a("code",[s._v("ts")]),s._v("的支持呢？")]),s._v(" "),a("ol",[a("li",[s._v("最核心的一点，当下前端生态"),a("code",[s._v("TS")]),s._v("正大步向前，我之前也一直在使用"),a("code",[s._v("TS")]),s._v("开发，现在不能因为"),a("code",[s._v("vue2")]),s._v("而就放弃了，还是应该以积极拥抱的心态")]),s._v(" "),a("li",[s._v("本项目架构支持子项目采用不同的规范策略，以"),a("code",[s._v("vue2")]),s._v("为主的"),a("code",[s._v("components")]),s._v("子项目完全可以在本目录下配置一套自己的项目规则，进而覆盖主项目配置，那么，现在可以做到的是，")]),s._v(" "),a("li",[s._v("本项目不是单一的"),a("code",[s._v("vue2")]),s._v("组件项目，他还包括 "),a("code",[s._v("utils")]),s._v("等其他子项目，是一个完善的前端组件化项目，这些都需要考虑在内")])]),s._v(" "),a("p",[s._v("我在开发"),a("code",[s._v("utils")]),s._v("子项目时采用了"),a("code",[s._v("typescript")]),s._v(" + "),a("code",[s._v("rollup")]),s._v("的开发和构建模式，TS完善的类型支持系统对开发这一类工具函数库，提供了极大的方便。目前这个库也完全不受技术栈影响，你可以在任何需要的地方使用，就类似"),a("code",[s._v("lodash")]),s._v("那样，而且当你在"),a("code",[s._v("TS")]),s._v("项目使用时又能获得完善的类型提示，岂不美哉~")]),s._v(" "),a("p",[s._v("对于"),a("code",[s._v("vue2")]),s._v(" + "),a("code",[s._v("iview")]),s._v("我就采用官方的"),a("code",[s._v("js")]),s._v("生态即可，直接复用现成的项目配置，在这里你也可以把它当成一个独立的项目去开发，也是完全OK的。")]),s._v(" "),a("p",[s._v("更进一步的说，以后都是使用vue3生态了，全面拥抱TS不可避免，学起来~")]),s._v(" "),a("h3",{attrs:{id:"工程化规范配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#工程化规范配置"}},[s._v("#")]),s._v(" 工程化规范配置")]),s._v(" "),a("p",[s._v("须要指出的是"),a("strong",[s._v("一定要注意版本一定要注意版本一定要注意版本")]),s._v("。")]),s._v(" "),a("p",[s._v("前端的工程化配置我在另一篇vue3的相关文章中也介绍过，都是大同小异，感兴趣的可以看这篇文章——"),a("a",{attrs:{href:"https://juejin.cn/post/7041188884864040991",target:"_blank",rel:"noopener noreferrer"}},[s._v("vite + vue3 + setup + pinia + ts 项目实战"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("唯一不同的是，本项目增加了对"),a("code",[s._v("Markdown")]),s._v("类型文件的格式化处理（"),a("code",[s._v(".md")]),s._v("），这里主要使用的是 "),a("a",{attrs:{href:"https://www.npmjs.com/package/markdownlint-cli",target:"_blank",rel:"noopener noreferrer"}},[s._v("markdownlint-cli"),a("OutboundLink")],1),s._v("。")]),s._v(" "),a("p",[s._v("为什么增加了这一项规则，这和我们的项目需求有很大的关联，前面我们说过我们会搭建一个完善的文档网站系统，组件库离不开详细的文档说明，"),a("code",[s._v("Markdown")]),s._v("是我们的不二之选，之后项目中会存在大量的"),a("code",[s._v(".md")]),s._v("文件，此时，保持一个统一规范的格式化规则是十分必要的。")]),s._v(" "),a("blockquote",[a("p",[s._v("这方面的配置我推荐参考下"),a("a",{attrs:{href:"https://github.com/element-plus/element-plus",target:"_blank",rel:"noopener noreferrer"}},[s._v("element-plus"),a("OutboundLink")],1),s._v("的相关实现，值得学习。")])]),s._v(" "),a("h4",{attrs:{id:"前人栽树我乘凉😬"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前人栽树我乘凉😬"}},[s._v("#")]),s._v(" 前人栽树我乘凉😬")]),s._v(" "),a("p",[s._v("在配置 "),a("code",[s._v("eslint")]),s._v("、"),a("code",[s._v("prettier")]),s._v("经常踩的坑就是因为版本问题，这里并不推荐从零开始，我们完全可以找一些和自己风格倾向比较一致的开源项目，借鉴别人项目中配置好的依赖，使用到我们自己的项目中😏。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/JS-banana/images/emoji/4.jpg",alt:"emoji"}})]),s._v(" "),a("p",[s._v("只有在我们想定义自己的特殊规范时，这时才需要结合官方文档了解规则配置的各种参数，以及相关规则包的一些插件库，按需安装配置即可，这样可以节省大量时间成本，毕竟很多开源项目都是极其成熟的了（这里也需要测试版本，默认安装一般都是基于vue3环境的最新的，vue2相关的可以参考一些vue2的老项目）。")]),s._v(" "),a("p",[s._v("在引入TypeScript支持时，需要安装"),a("code",[s._v("@typescript-eslint/parser")]),s._v("依赖，这时"),a("code",[s._v("eslint")]),s._v("的配置是有所调整的：")]),s._v(" "),a("div",{staticClass:"language-diff line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-diff"}},[a("code",[a("span",{pre:!0,attrs:{class:"token deleted-sign deleted"}},[a("span",{pre:!0,attrs:{class:"token prefix deleted"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token line"}},[s._v(' "parser": "@typescript-eslint/parser",\n')])]),a("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[a("span",{pre:!0,attrs:{class:"token prefix inserted"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token line"}},[s._v(' "parser": "vue-eslint-parser",\n')])]),a("span",{pre:!0,attrs:{class:"token unchanged"}},[a("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),a("span",{pre:!0,attrs:{class:"token line"}},[s._v(' "parserOptions": {\n')])]),a("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[a("span",{pre:!0,attrs:{class:"token prefix inserted"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token line"}},[s._v('     "parser": "@typescript-eslint/parser",\n')])]),a("span",{pre:!0,attrs:{class:"token unchanged"}},[a("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),a("span",{pre:!0,attrs:{class:"token line"}},[s._v('     "sourceType": "module"\n')]),a("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),a("span",{pre:!0,attrs:{class:"token line"}},[s._v(" }\n")])])])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("自定义解析器 "),a("code",[s._v("@typescript-eslint/parser")]),s._v(" 需要 "),a("code",[s._v("vue-eslint-parser")]),s._v("插件先解析 "),a("code",[s._v(".vue")]),s._v(" 文件，这是需要注意的一点。")]),s._v(" "),a("h4",{attrs:{id:"项目规范的命令配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#项目规范的命令配置"}},[s._v("#")]),s._v(" 项目规范的命令配置")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 约束包管理工具为 pnpm")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"preinstall"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"npx only-allow pnpm"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 配合git commit的提交规范 commitlint")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"prepare"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"husky install"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// eslint lint告警信息查看不合规范的错误")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"lint"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"eslint . --ext .vue,.js,.ts,.jsx,.tsx,.json --max-warnings 0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// eslint fix 直接修复不合规范的代码")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"lint:fix"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"eslint --fix . --ext .vue,.js,.ts,.jsx,.tsx,.json"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 工具类的单独lint")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"lint:utils"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"eslint --fix \\"./packages/utils/**\\" --ext .js,.ts,.json"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Markdown 文件 lint（packages目录下）")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"markdownlint"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"markdownlint \\"./packages/**/*.md\\""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Markdown 文件 lint fix（整个项目）")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"markdownlint:fix"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"markdownlint --fix \\"**/*.md\\""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("p",[s._v("配合"),a("strong",[s._v("vscode")]),s._v("保存时自动检查fix")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"editor.formatOnSave"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//每次保存的时候自动格式化")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"editor.codeActionsOnSave"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 保存时使用 ESLint 修复可修复错误")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"source.fixAll.eslint"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ESLint要验证的语言")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"eslint.validate"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"javascript"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"javascriptreact"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"vue"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"typescript"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"typescriptreact"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"html"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"css"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"scss"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"less"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mpx"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"json"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"markdown"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// eslint保存时只修复有问题的代码")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"eslint.codeActionsOnSave.mode"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"problems"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"eslint.format.enable"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"eslint.quiet"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 忽略 warning 的错误")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br")])]),a("p",[s._v("为了不使 "),a("code",[s._v("eslint")]),s._v("和"),a("code",[s._v("prettier")]),s._v("的规则发生冲突，你应该在"),a("code",[s._v("eslint")]),s._v("中这样配置，以保证可以合并配置，并使用 "),a("code",[s._v("prettier")]),s._v("格式化")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("extends")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 'plugin:vue/recommended',")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'plugin:prettier/recommended'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'prettier'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 'plugin:@typescript-eslint/recommended',")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("rules")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v("'prettier/prettier'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'error'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("配合git（参见 "),a("code",[s._v(".husky")]),s._v("目录）")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("commit-msg")]),s._v("：提交信息规范验证")]),s._v(" "),a("li",[a("strong",[s._v("pre-commit")]),s._v("：提交前执行代码格式化验证等其他工作")])]),s._v(" "),a("p",[s._v("配合"),a("code",[s._v("pre-commit")]),s._v("工作的"),a("code",[s._v("lint-staged")]),s._v("相关配置：")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"*.{vue,js,ts,jsx,tsx,json}"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"eslint --fix"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prettier --write"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"*.md"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"markdownlint --fix"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"prettier --write"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[a("code",[s._v("eslint")]),s._v("、"),a("code",[s._v("prettier")]),s._v("、"),a("code",[s._v("commitlint")]),s._v("这些都是很常规的配置，这里就不在过多叙述了，仓库地址放在下面了~")]),s._v(" "),a("h2",{attrs:{id:"包构建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#包构建"}},[s._v("#")]),s._v(" 包构建")]),s._v(" "),a("p",[s._v("包构建的基本思路依然是按照当前成熟方案进行选择，"),a("code",[s._v("vue2")]),s._v("生态的"),a("strong",[s._v("组件类代码")]),s._v("优先使用 "),a("code",[s._v("Webpack")]),s._v("进行构建打包，并且要支持"),a("code",[s._v("ES Module")]),s._v("这种引入方式，方便为之后的按需引入做铺垫，当然，为了兜底的兼容，也要支持 "),a("code",[s._v("umd")]),s._v(" 这种方式（同时以 "),a("code",[s._v("AMD")]),s._v("、"),a("code",[s._v("CommonJS2")]),s._v(" 和"),a("code",[s._v("全局属性")]),s._v("形式输出，支持直接使用 "),a("code",[s._v("<script>")]),s._v(" 在 "),a("code",[s._v("HTML")]),s._v(" 中引入）。")]),s._v(" "),a("p",[s._v("我在搭建本项目的"),a("code",[s._v("vue2")]),s._v(" + "),a("code",[s._v("iview")]),s._v("的组件库时，碍于版本的影响，子项目相关全部采用 "),a("code",[s._v("iview")]),s._v("项目中的构建配置进行打包，这样可以避免大量"),a("code",[s._v("Webpack")]),s._v("配置时的版本问题。")]),s._v(" "),a("p",[s._v("而对于 "),a("code",[s._v("utils")]),s._v("这种不受"),a("code",[s._v("vue2")]),s._v("影响的独立库，则优先采用"),a("code",[s._v("TypeScript")]),s._v(" + "),a("code",[s._v("Rollup")]),s._v("这种更方便"),a("strong",[s._v("库模式")]),s._v("的方式进行构建，使得其能够对上下做到很好的支持（"),a("code",[s._v("js")]),s._v("、"),a("code",[s._v("ts")]),s._v("）。")]),s._v(" "),a("h3",{attrs:{id:"统一出入口"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#统一出入口"}},[s._v("#")]),s._v(" 统一出入口")]),s._v(" "),a("p",[s._v("每个组件都应该以 "),a("code",[s._v("index.js")]),s._v(" 作为出入口，而整个组件库下的"),a("code",[s._v("index.js")]),s._v("应该是所有入口的集合。")]),s._v(" "),a("p",[s._v("这样做的好处，其一，目录结构清晰方便维护，其二方便引用注册统一管理。")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("├── packages                        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// packages工作目录")]),s._v("\n      ├── components                "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// components组件目录")]),s._v("\n        ├── index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("js                "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// components组件统一出入口")]),s._v("\n        ├── src                     "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// components组件源码目录")]),s._v("\n          ├── select                "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// select组件的开发目录")]),s._v("\n              ├── src               "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 组件源码")]),s._v("\n                  ├── style         "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 样式相关")]),s._v("\n                  ├── index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("vue     "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 组件文件")]),s._v("\n                  ├── props"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("js      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// props相关定义的声明")]),s._v("\n                  ├── "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("js      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 常量")]),s._v("\n              ├── index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("js          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 组件唯一出入口")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[a("code",[s._v("select")]),s._v("组件的"),a("code",[s._v("index.vue")]),s._v("如下：")]),s._v(" "),a("div",{staticClass:"language-vue line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-vue"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token script"}},[a("span",{pre:!0,attrs:{class:"token language-javascript"}},[s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'AhSelect'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[a("code",[s._v("select")]),s._v("组件的"),a("code",[s._v("index.js")]),s._v("（作为"),a("strong",[s._v("组件Select")]),s._v("的出入口）如下：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" Select "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./src/index.vue'")]),s._v("\n\nSelect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("install")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("Vue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  Vue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("component")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Select"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Select"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" Select\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[a("code",[s._v("components/index.js")]),s._v("（作为"),a("strong",[s._v("组件库components")]),s._v("的出入口）如下：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" AhButton "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./src/button/index'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" AhSelect "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./src/select/index'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" components "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  AhButton"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  AhSelect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("install")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("Vue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("install"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("installed"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v("\n\n  Object"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("keys")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("components"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("forEach")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("key")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    Vue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("component")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" components"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// auto install")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("typeof")]),s._v(" window "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!==")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'undefined'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Vue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Vue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("API")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("components"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  install"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("API")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br")])]),a("p",[s._v("utils的目录结构：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("├── packages              "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// packages工作目录")]),s._v("\n  ├── utils               "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// utils的开发目录")]),s._v("\n      ├── src             "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// utils源码目录")]),s._v("\n          ├── dom         "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// dom相关工具目录")]),s._v("\n          ├── object      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// object相关工具目录")]),s._v("\n          ├── index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ts    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 统一出入口")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[a("code",[s._v("src/dom/getScrollTop.ts")]),s._v("代码如下：")]),s._v(" "),a("div",{staticClass:"language-ts line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ts"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * @desc 设置滚动条距顶部的距离\n * @param {Number} value\n */")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("setScrollTop")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("value"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("number")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("number")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("scrollTo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" value\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[a("code",[s._v("src/index.ts")]),s._v("（作为"),a("strong",[s._v("工具类库utils")]),s._v("的出入口）代码如下：")]),s._v(" "),a("div",{staticClass:"language-ts line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ts"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// dom")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./dom/setScrollTop'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./dom/getOffset'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// object")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./object/deepClone'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./object/isEmptyObject'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h3",{attrs:{id:"构建配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#构建配置"}},[s._v("#")]),s._v(" 构建配置")]),s._v(" "),a("p",[s._v("应该遵循相对的统一，即，我们应该在主项目下维护一份统一的基础配置文件，每个子项目再根据其"),a("code",[s._v("package.json")]),s._v("做部分参数的细微调整，如："),a("code",[s._v("包名称name")]),s._v("、"),a("code",[s._v("版本version")]),s._v("等。")]),s._v(" "),a("p",[s._v("在根目录下创建 "),a("code",[s._v("build")]),s._v("目录，用于放置一些工程配置相关的文件,，如："),a("code",[s._v("webpack.base.config.js")]),s._v("。")]),s._v(" "),a("p",[s._v("子项目"),a("code",[s._v("packages/components/webpack.config.js")]),s._v("中通过引入该配置，再结合 "),a("code",[s._v("webpack-merge")]),s._v("完成对配置的合并：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// webpack.config.js")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" merge "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'webpack-merge'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" webpackBaseConfig "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'../../build/webpack.base.config'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" pkg "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./package.json'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("merge")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("webpackBaseConfig"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("mode")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'production'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("output")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("library")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" pkg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("slice")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// @ah-ailpha/pro-sqltiptree")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("plugins")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("webpack"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("BannerPlugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("banner")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" \n      "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("/*!\n        * ")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),s._v("pkg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v(" v")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),s._v("pkg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("version"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v(" 🖖\n        */")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("raw")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("entryOnly")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br")])]),a("p",[s._v("在"),a("code",[s._v("package.json")]),s._v("中配置如下脚本：")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"clean"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rimraf dist"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"build"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pnpm run clean && webpack --config webpack.config.js"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("需要指出的是上面的脚本一般会在主目录下，由版本控制工具统一执行（当然你也可以单独执行）")]),s._v(" "),a("p",[s._v("在主目录下你可以这样执行以上的命令：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用 --filter")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pnpm")]),s._v(" run --filter ./packages/components build "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 路径")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pnpm")]),s._v(" run --filter @ah-ailpha/components build "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 包名称")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用 -C 指定路径")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pnpm")]),s._v(" run -C ./packages/components build\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("在测试时你可以选择这样使用，但在实际开发当中我们都是通过脚本一键打包、发包，统一处理的，完整的写法如下：")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"clean"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pnpm run --filter \\"./packages/**\\" -r --parallel clean"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"build:packages"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pnpm run --filter \\"./packages/**\\" -r --parallel build"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("这里新增了两个命令行参数，简单介绍下：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("-r")]),s._v("：对所有子项目执行命令（如执行每个子项目的 clean 命令 "),a("code",[s._v("pnpm run -r clean")]),s._v("）")]),s._v(" "),a("li",[a("code",[s._v("--parallel")]),s._v("：忽略并发，立即在所有匹配的软件包中运行一个给定的脚本，用于在许多 "),a("strong",[s._v("packages")]),s._v(" 上长时间运行的进程，例如冗长的构建进程。")])]),s._v(" "),a("p",[s._v("utils工具类的配置也比较简单，不过多描述了，可以直接看仓库代码~")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"build"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pnpm run clean && rollup -c"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"clean"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rimraf lib dist es"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("构建的相关步骤结束，在之后的版本控制中，配合 "),a("code",[s._v("changeset")]),s._v("可以做到更全面的自动化操作😋")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/JS-banana/images/emoji/5.jpg",alt:"emoji"}})]),s._v(" "),a("h2",{attrs:{id:"版本管理和包发布"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#版本管理和包发布"}},[s._v("#")]),s._v(" 版本管理和包发布")]),s._v(" "),a("p",[a("strong",[s._v("Changesets")]),s._v(" 是一个用于 "),a("strong",[s._v("Monorepo")]),s._v(" 项目下版本以及 "),a("strong",[s._v("Changelog")]),s._v(" 文件管理的工具。")]),s._v(" "),a("p",[s._v("本项目目前使用的是 "),a("strong",[s._v("changeset")]),s._v("进行多包版本管理，它拥有交互式 CLI，可以非常友好的帮我们确定包版本 => 生成相应 "),a("code",[s._v("CHANGELOG.md")]),s._v("日志，并更新 "),a("code",[s._v("package.json")]),s._v(" 的 "),a("code",[s._v("version")]),s._v("信息，然后一键发布包至 npm")]),s._v(" "),a("blockquote",[a("p",[s._v("Changesets的实战使用细节可以参考这篇文章："),a("a",{attrs:{href:"https://juejin.cn/post/7024827345059971080",target:"_blank",rel:"noopener noreferrer"}},[s._v("Changesets: 流行的 monorepo 场景发包工具"),a("OutboundLink")],1)])]),s._v(" "),a("ol",[a("li",[a("p",[a("code",[s._v("changeset init")])]),s._v(" "),a("ul",[a("li",[s._v("新项目执行该命令，完成对项目的初始化")]),s._v(" "),a("li",[s._v("会在根目录下生成 "),a("code",[s._v(".changeset")]),s._v(" 目录，"),a("code",[s._v("config.json")]),s._v("配置文件（注意分支 "),a("code",[s._v('"baseBranch": "master"')]),s._v("）")])])]),s._v(" "),a("li",[a("p",[a("code",[s._v("changeset")])]),s._v(" "),a("ul",[a("li",[s._v("执行该命令，进行版本管理，会交互式选择不同项目，以及确定发布的版本")]),s._v(" "),a("li",[s._v("会生成一些 "),a("code",[s._v(".md")]),s._v(" 文件在目录下，会在 "),a("code",[s._v("version")]),s._v(" 的时候消耗")])])]),s._v(" "),a("li",[a("p",[a("code",[s._v("changeset version")])]),s._v(" "),a("ul",[a("li",[s._v("消耗上一步生成的相关的一些版本信息及记录内容的 "),a("code",[s._v(".md")]),s._v(" 文件，并生成或更新 "),a("code",[s._v("CHANGELOG.md")]),s._v(" 文件，之后 "),a("code",[s._v(".md")]),s._v(" 文件会被自动删除")]),s._v(" "),a("li",[s._v("相应的 "),a("code",[s._v("package.json")]),s._v(" 中的 "),a("code",[s._v("version")]),s._v(" 信息也会同步更新")])])]),s._v(" "),a("li",[a("p",[a("code",[s._v("changeset publish")])]),s._v(" "),a("ul",[a("li",[s._v("发布包到远程 "),a("code",[s._v("npm")]),s._v(" 源")]),s._v(" "),a("li",[s._v("前置条件是你已经进行了 "),a("code",[s._v("npm")]),s._v(" 账户登录，如果包名称为 "),a("code",[s._v("@ah-ailpha/components")]),s._v("该类型，还需要在 "),a("code",[s._v("npm")]),s._v(" 账户中设置组织")])])])]),s._v(" "),a("h3",{attrs:{id:"npm-发包注意事项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#npm-发包注意事项"}},[s._v("#")]),s._v(" npm 发包注意事项")]),s._v(" "),a("p",[s._v("为了发布使用，我们还需要在npm创建一个"),a("code",[s._v("@ah-ailpha")]),s._v("组织，私有的需要收费，选择免费~")]),s._v(" "),a("blockquote",[a("p",[s._v("在执行 npm publish 发布命令之前，你应该已经进行了 npm login 登录操作~")])]),s._v(" "),a("p",[s._v("在开始使用"),a("code",[s._v("changeset publish")]),s._v("时，可能会报"),a("code",[s._v("npm ERR! 402 Payment Required")]),s._v("错误")]),s._v(" "),a("p",[s._v("原因：无法发布到私有包，当包名以"),a("code",[s._v("@your-name")]),s._v("开头时，"),a("code",[s._v("npm publish")]),s._v("会默认发布为私有包，但是 npm 的私有包需要付费的~")]),s._v(" "),a("p",[s._v("402 错误")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("npm "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ERR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" code "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("E402")]),s._v("\nnpm "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ERR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("402")]),s._v(" Payment Required "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("PUT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("https")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[s._v("registry.npmjs.org")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" You must sign up "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" packages\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("解决办法：在项目的"),a("code",[s._v("package.json")]),s._v(" 中添加如下配置：")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"publishConfig"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"access"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"public"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"registry"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://registry.npmjs.org/"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h3",{attrs:{id:"发包到npm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#发包到npm"}},[s._v("#")]),s._v(" 发包到npm")]),s._v(" "),a("p",[s._v("为了方便使用，我们在脚本中添加如下命令：")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"preversion"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"changeset"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"version"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"changeset version && pnpm install --no-frozen-lockfile && pnpm run format:code"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"release"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pnpm run clean && pnpm run build:packages && changeset publish"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"release:nobuild"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"changeset publish"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[a("strong",[s._v("第一步")]),s._v("：")]),s._v(" "),a("p",[s._v("执行 "),a("code",[s._v("pnpm run preversion")]),s._v(" 命令，通过交互式命令确定版本（空格——选择，回车——确定）")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/JS-banana/images/vuepress/monorepo-1.gif",alt:"monorepo-2"}})]),s._v(" "),a("p",[s._v("此时，我们选择为 1.5.0版本，执行结束，"),a("code",[s._v(".changeset")]),s._v("目录下回生成一个临时文件，这是给第二步命令使用的，我们不用管它~")]),s._v(" "),a("p",[a("strong",[s._v("第二步")]),s._v("：")]),s._v(" "),a("p",[s._v("执行 "),a("code",[s._v("pnpm run version")]),s._v("命令后，临时文件会被消耗掉，并且会更新 "),a("code",[s._v("pro-sqltiptree")]),s._v(" 目录下的"),a("code",[s._v("CHANGELOG.md")]),s._v("文件、"),a("code",[s._v("package.json")]),s._v("文件，以及"),a("strong",[s._v("相关项目间的依赖引用也会更新")]),s._v("（pnpm会针对变化执行一次install操作，更新引用，使各项目中的版本保持一致），就很酷😎~")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/JS-banana/images/vuepress/monorepo-2.png",alt:"monorepo-2"}})]),s._v(" "),a("p",[a("strong",[s._v("第三步")]),s._v("：")]),s._v(" "),a("p",[s._v("执行 "),a("code",[s._v("changeset publish")]),s._v("命令，发布npm包，这里我为了测试，直接使用 "),a("code",[s._v("pnpm run release:nobuild")]),s._v("（跳过构建打包步骤）")]),s._v(" "),a("blockquote",[a("p",[s._v("在执行发布命令之前，你应该已经通过 "),a("code",[s._v("npm login")]),s._v(" 进行了登录操作")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/JS-banana/images/vuepress/monorepo-3.gif",alt:"monorepo-3"}})]),s._v(" "),a("p",[a("strong",[s._v("第四步")]),s._v("：")]),s._v(" "),a("p",[s._v("在npm查看更新")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/JS-banana/images/vuepress/monorepo-4.png",alt:"monorepo-4"}})]),s._v(" "),a("h2",{attrs:{id:"文档站点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#文档站点"}},[s._v("#")]),s._v(" 文档站点")]),s._v(" "),a("p",[s._v("说了那么多，很多都是代码层面的东西。那么对于用户来说，如何能够快速的了解本项目呢？以及如何快速上手和使用相关组件和工具呢？")]),s._v(" "),a("p",[s._v("那么，一个成熟的开发文档就显得相当重要了，他不仅要起到介绍、引导入门的作用，还应该有其作为一个技术文档网站的核心功能——详细的API介绍和使用说明、真实使用场景下的渲染demo等。")]),s._v(" "),a("p",[s._v("文档网站——其功能性和重要性不言而喻，主要作为第一入口提供给用户，作为了解本项目的第一途径。")]),s._v(" "),a("ol",[a("li",[s._v("第一要素：基本内容应包含，使用指南，组件 API、属性、方法等相关介绍说明等。")]),s._v(" "),a("li",[s._v("第二点：使用方式和用法展示。真实渲染环境展示效果，相关代码使用展示（demo / code）。")]),s._v(" "),a("li",[s._v("在项目代码层面可能会涉及到与约定目录的自动化脚本生成相关，进而快速自动实现如：路由、API 等相关功能。")])]),s._v(" "),a("p",[s._v("在最开始搭建文档网站时，参考了"),a("code",[s._v("element ui")]),s._v("的官网设计，觉得很不错，不过，在看了源码后发现其网站是是有自己的"),a("code",[s._v("element组件")]),s._v("从零开始搭建的，而且，针对Markdown文件的渲染也定制开发了一些特殊逻辑，整体思考下来觉得上手成本有点高，我这一时半会也没那么多时间搞。")]),s._v(" "),a("p",[s._v("想了想既然以文档为主，还是选择一个文档类框架进行搭建吧。为了追求快速方便，首先，想到的就是vue2版本的"),a("code",[s._v("vuepress")]),s._v("（vue2相关生态的许多网站都是使用的这个框架），Markdown类型文件可以直接进行渲染，框架的约定式路由等都使得上手极其方便，也有比较成熟的插件社区，因此，我也是最终选择了这个框架。")]),s._v(" "),a("blockquote",[a("p",[s._v("多说两句，期间我也对比研究过 "),a("strong",[s._v("vitepress")]),s._v("，顾名思义，该框架是以 vite为核心，且内部集成基于 vue3，可定制化极强，性能表现非常优异，现在很多开源项目都采用了这个框架进行文档网站的搭建，"),a("code",[s._v("element-plus")]),s._v("就是很好的例子。")]),s._v(" "),a("p",[a("strong",[s._v("vuepress2")]),s._v("我也研究了一下，它主要是基于vue3的，对vue2支持并不友好，因此，非vue3的项目可能要退而求其次使用"),a("strong",[s._v("vuepress")]),s._v("了~\n")])]),s._v(" "),a("p",[s._v("vuepress文档站点的搭建直接按照"),a("a",{attrs:{href:"https://vuepress.vuejs.org/zh/guide/getting-started.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方文档"),a("OutboundLink")],1),s._v("来即可，非常简单，这里不再啰嗦了。")]),s._v(" "),a("p",[s._v("完事之后，脚本应该是这样的：")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"dev"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"vuepress dev"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"build"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"vuepress build"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("结合项目，指出一些需要注意的点")]),s._v(" "),a("ul",[a("li",[s._v("文档目录不作为项目包模块管理，因此不放在"),a("code",[s._v("packages")]),s._v("目录下，而是同级创建一个单独的目录 "),a("code",[s._v("docs")]),s._v("进行管理\n"),a("ul",[a("li",[s._v("Markdown文件的渲染，最好能够支持API的自动填写")]),s._v(" "),a("li",[s._v("组件能够在文档网站中正常渲染（可以结合官方提供的这个功能"),a("a",{attrs:{href:"https://vuepress.vuejs.org/zh/guide/using-vue.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("在 Markdown 中使用 Vue"),a("OutboundLink")],1),s._v("）")])])]),s._v(" "),a("li",[s._v("同样提供一个 "),a("code",[s._v("examples")]),s._v("目录用于模拟调试真实使用场景下的组件功能，也作为一个同级目录创建")])]),s._v(" "),a("blockquote",[a("p",[s._v("examples在这里的作用，主要作为实际vue项目的使用场景，从而用于调试代码")])]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("├── examples                        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 演示目录，用于调试代码")]),s._v("\n├── docs                            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 文档目录，用于编写对应组件的相关文档，以及文档网站的建设配置")]),s._v("\n├── packages                        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// packages工作目录")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h3",{attrs:{id:"vuepress文档站点的配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vuepress文档站点的配置"}},[s._v("#")]),s._v(" vuepress文档站点的配置")]),s._v(" "),a("p",[s._v("在初始化完文档站点之后，我们根据需要把子项目作为依赖安装到项目中：")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"dependencies"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"@ah-ailpha/components"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"workspace:*"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"@ah-ailpha/pro-sqltiptree"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"workspace:*"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("因为版本较低，如果出现"),a("code",[s._v("Webpack")]),s._v("的版本报错，请在 "),a("code",[s._v("package.json")]),s._v(" 中添加如下配置：")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"resolutions"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"webpack-hot-middleware"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2.25.0"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("在"),a("code",[s._v("docs/.vuepress/enhanceApp.js")]),s._v("中导入我们的组件：")]),s._v(" "),a("blockquote",[a("p",[s._v("由于 "),a("strong",[s._v("VuePress")]),s._v(" 是一个标准的 Vue 应用，你可以通过创建一个 "),a("code",[s._v(".vuepress/enhanceApp.js")]),s._v(" 文件来做一些应用级别的配置，当该文件存在的时候，会被导入到应用内部。"),a("code",[s._v("enhanceApp.js")]),s._v(" 应该 "),a("code",[s._v("export default")]),s._v(" 一个钩子函数，并接受一个包含了一些应用级别属性的对象作为参数。你可以使用这个钩子来安装一些附加的 Vue 插件、注册全局组件，或者增加额外的路由钩子等：")])]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" vue "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'vue'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" components "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@ah-ailpha/components'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" ProSqlTipTree "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@ah-ailpha/pro-sqltiptree'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  Vue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// options,")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// router,")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// siteData,")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  Vue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("use")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("components"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  Vue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("use")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ProSqlTipTree"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[s._v("为了能够在Markdown中以真实效果渲染组件，我选择使用一个开源的插件来实现这个能力：")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("先安装插件")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pnpm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" vuepress-plugin-demo-container --filter docs -D\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("在"),a("code",[s._v("docs/.vuepress/config.js")]),s._v("中注册插件")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("plugins")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'demo-container'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("在Markdown文件中使用")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/JS-banana/images/vuepress/monorepo-5.png",alt:"monorepo-5"}})]),s._v(" "),a("div",{staticClass:"language-md line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-md"}},[a("code",[s._v("::: demo\n\n这里的代码会被渲染\n\n:::\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])])])]),s._v(" "),a("h3",{attrs:{id:"配置文件与脚本调整"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置文件与脚本调整"}},[s._v("#")]),s._v(" 配置文件与脚本调整")]),s._v(" "),a("p",[s._v("工作空间 "),a("code",[s._v("pnpm-workspace.yaml")]),s._v(" 做出如下调整：")]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("packages")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" packages/*\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" docs\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" examples\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("主目录 "),a("code",[s._v("package.json")]),s._v(" 文件增加以下脚本：")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"dev"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pnpm run -C examples serve"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"docs:dev"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pnpm run -C docs dev"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"docs:build"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pnpm run -C docs build"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h3",{attrs:{id:"文档站点基本效果"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#文档站点基本效果"}},[s._v("#")]),s._v(" 文档站点基本效果")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/JS-banana/images/vuepress/monorepo-6.png",alt:"monorepo-6"}})]),s._v(" "),a("hr"),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/JS-banana/images/vuepress/monorepo-7.png",alt:"monorepo-7"}})]),s._v(" "),a("h3",{attrs:{id:"文档站点搭建小结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#文档站点搭建小结"}},[s._v("#")]),s._v(" 文档站点搭建小结")]),s._v(" "),a("p",[s._v("如果想要快速、简单的搭建一个文档站点，其实还是相当简单的，市面上有很多针对不同技术方案的框架。但是，在使用的过程中，也发现了不少问题")]),s._v(" "),a("ul",[a("li",[s._v("技术框架的选择和核心库的版本关系很大，需要考虑版本区别")]),s._v(" "),a("li",[s._v("一键快速搭建的文档站点很难满足我们的复杂需求，需要自己提供插件")]),s._v(" "),a("li",[a("code",[s._v("vuepress")]),s._v("不如"),a("code",[s._v("vitepress")]),s._v("那样提供有很多钩子方便拓展能力边界")]),s._v(" "),a("li",[s._v("如果完全以自身开发的组件搭建一个文档网站需要一定的时间成本")])]),s._v(" "),a("p",[s._v("总的来说，目前的文档站点还是属于一种快速完工的初级阶段水平，对于后面的自动化文档生成还有一定的路要走。按照设想，只要约定好规范，所有的组件文档接口及使用说明，也同步维护在源码目录下的 "),a("code",[s._v("demo")]),s._v(" 目录中，再结合一些自定义插件，比如配合"),a("code",[s._v("Webpack")]),s._v("可以通过编写"),a("code",[s._v("loader")]),s._v("在编译的时候做一些处理，"),a("code",[s._v("vitepress")]),s._v("的话可以使用钩子函数做一些处理，目前市面上也有不少成熟方案都值得学习，期待在接下来的开发过程中进一步完善。")]),s._v(" "),a("h2",{attrs:{id:"总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[s._v("#")]),s._v(" 总结")]),s._v(" "),a("p",[s._v("其实，对于本篇文章来说，算是鸽了挺长一段时间的了，惭愧😅~")]),s._v(" "),a("p",[s._v("在第一篇文章中我主要介绍了项目的一些前期设计和技术预研，以及如何进行最终技术方案确定的，属于是一种由浅入深的心路历程了，对于新人了解整个项目的脉络还是十分有益的。同样是站在项目任务目标的角度看，为了新人能够快速上手，这里选择了从0到1对整个项目生命周期进行说明，并通过这两篇文章进行阐述，也是尽力通过结合自身的实际经历做到全面而细致的描述，以达到一个内期待心的理想状态~")]),s._v(" "),a("p",[s._v("在整个开发过程中，就相当于一个学习的过程，期间遇到不少问题，但这也是提升自己的好时机，解决问题、记录下来、再接再厉，保持这样一个曲线应当是挺不错的。")]),s._v(" "),a("p",[s._v("通过这两篇文章，你应该能够掌握以下能力：")]),s._v(" "),a("ol",[a("li",[s._v("了解和知晓组件化，并能够明白其作用")]),s._v(" "),a("li",[s._v("了解工程化规范、组件化规范，并能够把标准实际落地")]),s._v(" "),a("li",[s._v("了解工作空间（"),a("code",[s._v("workspace")]),s._v("）概念、了解什么是"),a("strong",[s._v("monorepo")]),s._v("，并能够使用"),a("code",[s._v("pnpm")]),s._v("管理多包项目")]),s._v(" "),a("li",[s._v("能够从0到1搭建一个属于自己的"),a("strong",[s._v("monorepo")]),s._v("多包项目")]),s._v(" "),a("li",[s._v("会使用 "),a("strong",[s._v("vuepress")]),s._v(" 搭建博客文档站点（你甚至可以用它搭建自己的博客，比如我的"),a("a",{attrs:{href:"https://ssscode.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("个人博客"),a("OutboundLink")],1),s._v("）")]),s._v(" "),a("li",[s._v("会使用 "),a("strong",[s._v("changesets")]),s._v(" 管理 "),a("strong",[s._v("monorepo")]),s._v(" 多包项目")]),s._v(" "),a("li",[s._v("了解"),a("code",[s._v("npm")]),s._v("的发包流程，并会使用"),a("code",[s._v("npm")]),s._v("发布自己的包")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/JS-banana/images/emoji/6.jpg",alt:"emoji"}})]),s._v(" "),a("h2",{attrs:{id:"仓库地址"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#仓库地址"}},[s._v("#")]),s._v(" 仓库地址")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/JS-banana/jack",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/JS-banana/jack"),a("OutboundLink")],1)]),s._v(" "),a("h2",{attrs:{id:"资料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#资料"}},[s._v("#")]),s._v(" 资料")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://pnpm.io/zh",target:"_blank",rel:"noopener noreferrer"}},[s._v("pnpm"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://pnpm.io/zh/workspaces",target:"_blank",rel:"noopener noreferrer"}},[s._v("pnpm-workspaces"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/ElemeFE/element",target:"_blank",rel:"noopener noreferrer"}},[s._v("element"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/vuetifyjs/vuetify",target:"_blank",rel:"noopener noreferrer"}},[s._v("vuetify"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/element-plus/element-plus",target:"_blank",rel:"noopener noreferrer"}},[s._v("element-plus"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/IDuxFE/idux",target:"_blank",rel:"noopener noreferrer"}},[s._v("idux"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://www.lernajs.cn/",target:"_blank",rel:"noopener noreferrer"}},[s._v("lernajs"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://www.zoo.team/article/lerna-js",target:"_blank",rel:"noopener noreferrer"}},[s._v("Lerna 运行流程剖析"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://icode.best/i/54395246194902",target:"_blank",rel:"noopener noreferrer"}},[s._v("pnpm 多包管理项目-爱代码爱编程"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://juejin.cn/post/7024827345059971080",target:"_blank",rel:"noopener noreferrer"}},[s._v("Changesets: 流行的 monorepo 场景发包工具"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://juejin.cn/post/7122240572491825160",target:"_blank",rel:"noopener noreferrer"}},[s._v("【一库】semver：语义版本号标准 + npm的版本控制器🧲"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://vuepress.vuejs.org/zh/",target:"_blank",rel:"noopener noreferrer"}},[s._v("vuepress"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=e.exports}}]);