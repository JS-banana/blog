<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>【前端组件化】系列第一篇——方案探究 | 小帅の技术博客</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/img/favicon.ico">
    <script async="async" crossorigin="anonymous" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2069361349446100"></script>
    <script async="async" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <meta name="description" content="web前端技术博客,简洁至上,专注web前端学习与总结。JavaScript,js,ES6,TypeScript,vue,css3,html5,Node,git,github等技术文章。">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="cewstn11l3">
    <meta name="theme-color" content="#11a8cd">
    <link rel="preload" href="/assets/css/0.styles.6d8e1423.css" as="style"><link rel="preload" href="/assets/js/app.659b4e88.js" as="script"><link rel="preload" href="/assets/js/2.6ed24f91.js" as="script"><link rel="preload" href="/assets/js/3.c0dae15f.js" as="script"><link rel="preload" href="/assets/js/27.5a7f606c.js" as="script"><link rel="prefetch" href="/assets/js/10.a9d15544.js"><link rel="prefetch" href="/assets/js/100.52ed5582.js"><link rel="prefetch" href="/assets/js/11.65816c40.js"><link rel="prefetch" href="/assets/js/12.bdb1e59e.js"><link rel="prefetch" href="/assets/js/13.d8da2420.js"><link rel="prefetch" href="/assets/js/14.8f3c6739.js"><link rel="prefetch" href="/assets/js/15.d0dcb8b1.js"><link rel="prefetch" href="/assets/js/16.5df734af.js"><link rel="prefetch" href="/assets/js/17.3eb60e6b.js"><link rel="prefetch" href="/assets/js/18.540bae17.js"><link rel="prefetch" href="/assets/js/19.ddd44bc8.js"><link rel="prefetch" href="/assets/js/20.e8ae9a39.js"><link rel="prefetch" href="/assets/js/21.76f1d488.js"><link rel="prefetch" href="/assets/js/22.616dd932.js"><link rel="prefetch" href="/assets/js/23.6a2f453d.js"><link rel="prefetch" href="/assets/js/24.7f5a4bd2.js"><link rel="prefetch" href="/assets/js/25.20987f52.js"><link rel="prefetch" href="/assets/js/26.69beca42.js"><link rel="prefetch" href="/assets/js/28.855191fa.js"><link rel="prefetch" href="/assets/js/29.a9624808.js"><link rel="prefetch" href="/assets/js/30.90f8bc11.js"><link rel="prefetch" href="/assets/js/31.a2a4b158.js"><link rel="prefetch" href="/assets/js/32.3c318f67.js"><link rel="prefetch" href="/assets/js/33.141da355.js"><link rel="prefetch" href="/assets/js/34.8efa99cc.js"><link rel="prefetch" href="/assets/js/35.0ae822d0.js"><link rel="prefetch" href="/assets/js/36.44527e88.js"><link rel="prefetch" href="/assets/js/37.f1559978.js"><link rel="prefetch" href="/assets/js/38.804971b5.js"><link rel="prefetch" href="/assets/js/39.dc377d76.js"><link rel="prefetch" href="/assets/js/4.e3247416.js"><link rel="prefetch" href="/assets/js/40.21274c5a.js"><link rel="prefetch" href="/assets/js/41.bf4cdd88.js"><link rel="prefetch" href="/assets/js/42.f3396526.js"><link rel="prefetch" href="/assets/js/43.b7ef5577.js"><link rel="prefetch" href="/assets/js/44.069116c6.js"><link rel="prefetch" href="/assets/js/45.341273a8.js"><link rel="prefetch" href="/assets/js/46.a989d10f.js"><link rel="prefetch" href="/assets/js/47.7dd90499.js"><link rel="prefetch" href="/assets/js/48.dedf3df6.js"><link rel="prefetch" href="/assets/js/49.e93c56a0.js"><link rel="prefetch" href="/assets/js/5.6d2ab4af.js"><link rel="prefetch" href="/assets/js/50.33ee610e.js"><link rel="prefetch" href="/assets/js/51.4337e1b5.js"><link rel="prefetch" href="/assets/js/52.699b97e8.js"><link rel="prefetch" href="/assets/js/53.3319e132.js"><link rel="prefetch" href="/assets/js/54.068dbbe0.js"><link rel="prefetch" href="/assets/js/55.6b6249d0.js"><link rel="prefetch" href="/assets/js/56.9ebd78de.js"><link rel="prefetch" href="/assets/js/57.f0ac33b8.js"><link rel="prefetch" href="/assets/js/58.dcb2ac12.js"><link rel="prefetch" href="/assets/js/59.478b4656.js"><link rel="prefetch" href="/assets/js/6.1b7553b0.js"><link rel="prefetch" href="/assets/js/60.3fa195a2.js"><link rel="prefetch" href="/assets/js/61.e47c18f8.js"><link rel="prefetch" href="/assets/js/62.8074480a.js"><link rel="prefetch" href="/assets/js/63.0b126dc0.js"><link rel="prefetch" href="/assets/js/64.3c9de122.js"><link rel="prefetch" href="/assets/js/65.418b040c.js"><link rel="prefetch" href="/assets/js/66.e1eeffd6.js"><link rel="prefetch" href="/assets/js/67.3b0654cd.js"><link rel="prefetch" href="/assets/js/68.eba26eb5.js"><link rel="prefetch" href="/assets/js/69.da9ee3cf.js"><link rel="prefetch" href="/assets/js/7.128743e0.js"><link rel="prefetch" href="/assets/js/70.b682c7b3.js"><link rel="prefetch" href="/assets/js/71.fe46317d.js"><link rel="prefetch" href="/assets/js/72.f75b8b7c.js"><link rel="prefetch" href="/assets/js/73.5c7d7416.js"><link rel="prefetch" href="/assets/js/74.529861b2.js"><link rel="prefetch" href="/assets/js/75.80600886.js"><link rel="prefetch" href="/assets/js/76.e2b5ef64.js"><link rel="prefetch" href="/assets/js/77.354a2342.js"><link rel="prefetch" href="/assets/js/78.0677f326.js"><link rel="prefetch" href="/assets/js/79.a654dff8.js"><link rel="prefetch" href="/assets/js/8.dd0b9103.js"><link rel="prefetch" href="/assets/js/80.1935fc35.js"><link rel="prefetch" href="/assets/js/81.cdef8790.js"><link rel="prefetch" href="/assets/js/82.2e74bd96.js"><link rel="prefetch" href="/assets/js/83.e75268c7.js"><link rel="prefetch" href="/assets/js/84.2d7c282a.js"><link rel="prefetch" href="/assets/js/85.e7e63f94.js"><link rel="prefetch" href="/assets/js/86.2f9cfb34.js"><link rel="prefetch" href="/assets/js/87.7f2bde10.js"><link rel="prefetch" href="/assets/js/88.996aac7b.js"><link rel="prefetch" href="/assets/js/89.1d8af25a.js"><link rel="prefetch" href="/assets/js/9.98f70b32.js"><link rel="prefetch" href="/assets/js/90.73f4eead.js"><link rel="prefetch" href="/assets/js/91.45e6b28f.js"><link rel="prefetch" href="/assets/js/92.55b5b980.js"><link rel="prefetch" href="/assets/js/93.d94cc1ed.js"><link rel="prefetch" href="/assets/js/94.b398255a.js"><link rel="prefetch" href="/assets/js/95.35fd947d.js"><link rel="prefetch" href="/assets/js/96.b191ef54.js"><link rel="prefetch" href="/assets/js/97.2a68f903.js"><link rel="prefetch" href="/assets/js/98.1f73f0d3.js"><link rel="prefetch" href="/assets/js/99.f05bf137.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6d8e1423.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/photo_nobg.png" alt="小帅の技术博客" class="logo"> <span class="site-name can-hide">小帅の技术博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/frontend/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/be6faa/" class="nav-link">基础</a></li><li class="dropdown-item"><!----> <a href="/pages/33f292/" class="nav-link">框架</a></li><li class="dropdown-item"><!----> <a href="/pages/c8aad6/" class="nav-link">进阶</a></li><li class="dropdown-item"><!----> <a href="/pages/2833ad/" class="nav-link">工程化</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="全栈" class="dropdown-title"><a href="/fullstack/" class="link-title">全栈</a> <span class="title" style="display:none;">全栈</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/5fe09e/" class="nav-link">NodeJS</a></li><li class="dropdown-item"><!----> <a href="/pages/337720/" class="nav-link">脚本</a></li><li class="dropdown-item"><!----> <a href="/pages/131a7a/" class="nav-link">拓展</a></li><li class="dropdown-item"><!----> <a href="/pages/04df1e/" class="nav-link">技术</a></li><li class="dropdown-item"><!----> <a href="/pages/5cd35f/" class="nav-link">服务器</a></li></ul></div></div><div class="nav-item"><a href="/life/" class="nav-link">程序猿</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/friends/" class="nav-link">友链</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/JS-banana/vuepress" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://cdn.jsdelivr.net/gh/JS-banana/images/vuepress/photo.jpg"> <div class="blogger-info"><h3>前端小帅</h3> <span>学而不思则罔，思而不学则殆</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/frontend/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/be6faa/" class="nav-link">基础</a></li><li class="dropdown-item"><!----> <a href="/pages/33f292/" class="nav-link">框架</a></li><li class="dropdown-item"><!----> <a href="/pages/c8aad6/" class="nav-link">进阶</a></li><li class="dropdown-item"><!----> <a href="/pages/2833ad/" class="nav-link">工程化</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="全栈" class="dropdown-title"><a href="/fullstack/" class="link-title">全栈</a> <span class="title" style="display:none;">全栈</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/5fe09e/" class="nav-link">NodeJS</a></li><li class="dropdown-item"><!----> <a href="/pages/337720/" class="nav-link">脚本</a></li><li class="dropdown-item"><!----> <a href="/pages/131a7a/" class="nav-link">拓展</a></li><li class="dropdown-item"><!----> <a href="/pages/04df1e/" class="nav-link">技术</a></li><li class="dropdown-item"><!----> <a href="/pages/5cd35f/" class="nav-link">服务器</a></li></ul></div></div><div class="nav-item"><a href="/life/" class="nav-link">程序猿</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/friends/" class="nav-link">友链</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/JS-banana/vuepress" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>工程化</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/c3ea73/" class="sidebar-link">搭建一个标准化react+ts项目</a></li><li><a href="/pages/e6f55f/" class="sidebar-link">Webpack项目优化系列一</a></li><li><a href="/pages/282d35/" class="sidebar-link">【rollup】Svelte框架初尝试</a></li><li><a href="/pages/b849f8/" class="sidebar-link">【rollup】构建发布一个npm包</a></li><li><a href="/pages/428be4/" class="sidebar-link">【vite】构建标准化react应用</a></li><li><a href="/pages/2833ad/" class="sidebar-link">【vite】构建vue3+ts应用</a></li><li><a href="/pages/f120e1/" aria-current="page" class="active sidebar-link">【前端组件化】系列第一篇</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/f120e1/#背景" class="sidebar-link">背景</a></li><li class="sidebar-sub-header"><a href="/pages/f120e1/#简要说明" class="sidebar-link">简要说明</a></li><li class="sidebar-sub-header"><a href="/pages/f120e1/#前端的发展路径" class="sidebar-link">前端的发展路径</a></li><li class="sidebar-sub-header"><a href="/pages/f120e1/#什么是组件化" class="sidebar-link">什么是组件化</a></li><li class="sidebar-sub-header"><a href="/pages/f120e1/#为什么需要组件化" class="sidebar-link">为什么需要组件化</a></li><li class="sidebar-sub-header"><a href="/pages/f120e1/#基本目标" class="sidebar-link">基本目标</a></li><li class="sidebar-sub-header"><a href="/pages/f120e1/#技术背景" class="sidebar-link">技术背景</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/f120e1/#包依赖" class="sidebar-link">包依赖</a></li><li class="sidebar-sub-header"><a href="/pages/f120e1/#功能-业务组件" class="sidebar-link">功能/业务组件</a></li><li class="sidebar-sub-header"><a href="/pages/f120e1/#组件管理思考" class="sidebar-link">组件管理思考</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/f120e1/#技术调研" class="sidebar-link">技术调研</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/f120e1/#相关开源项目分析" class="sidebar-link">相关开源项目分析</a></li><li class="sidebar-sub-header"><a href="/pages/f120e1/#monorepo-是什么" class="sidebar-link">monorepo 是什么</a></li><li class="sidebar-sub-header"><a href="/pages/f120e1/#monorepo-lernajs-yarn" class="sidebar-link">monorepo + lernajs + yarn</a></li><li class="sidebar-sub-header"><a href="/pages/f120e1/#monorepo-pnpm" class="sidebar-link">monorepo + pnpm</a></li><li class="sidebar-sub-header"><a href="/pages/f120e1/#lerna-changeset-版本管理分析" class="sidebar-link">lerna / changeset 版本管理分析</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/f120e1/#尾声" class="sidebar-link">尾声</a></li><li class="sidebar-sub-header"><a href="/pages/f120e1/#资料" class="sidebar-link">资料</a></li></ul></li><li><a href="/pages/eb2149/" class="sidebar-link">【前端组件化】系列第二篇</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>框架</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>精进</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>其他</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-583ea4e9><div class="articleInfo" data-v-583ea4e9><ul class="breadcrumbs" data-v-583ea4e9><li data-v-583ea4e9><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-583ea4e9></a></li> <li data-v-583ea4e9><a href="/frontend" title="前端-目录页" data-v-583ea4e9>前端</a></li> <li data-v-583ea4e9><a href="/frontend/#工程化" title="前端#工程化" data-v-583ea4e9>工程化</a></li> <!----></ul> <div class="info" data-v-583ea4e9><div title="作者" class="author iconfont icon-touxiang" data-v-583ea4e9><a href="https://github.com/JS-banana" target="_blank" title="作者" class="beLink" data-v-583ea4e9>sunss</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-583ea4e9><a href="javascript:;" data-v-583ea4e9>2022-08-18</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">
          【前端组件化】系列第一篇——方案探究
        </h1> <!----> <div class="theme-vdoing-content content__default"><blockquote><p>前端组件化系列文章第一篇：前端组件化方案探究</p></blockquote> <h2 id="背景"><a href="#背景" class="header-anchor">#</a> 背景</h2> <p>公司目前基于多业务部门，很多业务组件和功能逻辑都具有较高的普适性，但与此同时各业务部分和开发人员缺乏一定的交流平台，更多的是在遇到对应需求时会简单内部讨论一番，当了解到其他业务部门存在落地的方案时，再进一步进行沟通交流。</p> <p>这种方式，总体来说还是比较原始的，无论从沟通方式的效率来说，还是对于组件业务逻辑的深入理解都是非常低效的。因此，对于探索一种高效的、简单的、现代化方案是非常有必要的。</p> <p>我们想要的结果是（任务目标）：</p> <ol><li>不同的业务平台开发的组件能够最大程度复用；</li> <li>新人能够快速了解通用组件，提升开发效率</li></ol> <blockquote><p>这也就是本系列文章的真实背景，也是我着手负责的项目，相关文章会按照系列形式输出，并确保文章内容都是在真实业务中的实践总结。</p></blockquote> <h2 id="简要说明"><a href="#简要说明" class="header-anchor">#</a> 简要说明</h2> <p>作为本系列的第一篇文章，其定位和作用也是相当清晰的：</p> <ol><li>搞清楚前端组件化是什么？</li> <li>搞明白组件化要怎么做？</li> <li>思考如何把组件化做的更好？</li></ol> <p>前期主要以第1、2两点作为执行方向进行探索，在基本明白了什么是组件化以及如何实现自己的组件化之后，进一步探索、对比、研究、思考如何实现高效能的组件化方案。</p> <h2 id="前端的发展路径"><a href="#前端的发展路径" class="header-anchor">#</a> 前端的发展路径</h2> <p>在互联网早期阶段，传统的开发模式中，往往是把前端的网页代码和后端的程序代码混合在一起，借助某种模板技术（如 <code>JSP</code>、<code>ASP</code>、<code>PHP</code>）来在服务器端动态生成 <code>HTML</code> 页面。</p> <p>在这种开发模式下，网页的每次改动都需要前后端人员共同参与才能完成，网站前后端的开发人员需要很大的沟通成本、协调成本。企业招人的时候，也不得不招一些既懂前端又懂后端程序员，来减少前后端开发人员的冲突。</p> <p>可以发现这种模式是非常低效的。</p> <p>现在流行的前后端分离的开发模式，就是让后端只负责给前端提供数据，由前端负责整个页面的模板渲染、数据填充以及交互逻辑。</p> <p>前后端分离之后，人们发现前端已经不再是传统意义上的网页了，它甚至还可以做成一个手机应用，或者做成是微信小程序那样的小型应用，<strong>它更接近于传统的 B/S（客户端/服务器）架构，且仍然具备网页轻量级、无需下载和安装的优势</strong>。</p> <h2 id="什么是组件化"><a href="#什么是组件化" class="header-anchor">#</a> 什么是组件化</h2> <p>在前后端分离的现代开发模式下，以<code>React</code>、<code>Vue</code>为例，涌现了很多优秀的现代化的前端框架，得益于新技术的发展，<strong>SPA 应用</strong>已经相当成熟，该开发范式也是相当普遍。</p> <p>伴随着这种技术行为，组件化开发也是应运而生，作为一个非常常规的模式，围绕几点说明：</p> <ol><li><strong>方便复用</strong>（很多业务代码、功能代码都不可避免有所重复，对于组件的复用使用，可谓作用很大）</li> <li><strong>方便维护</strong>（如果大量的业务代码与功能代码耦合一起，对于代码的日后维护和功能拓展都有着很大的局限性和不足）</li> <li><strong>功能细分、专一、职责明确</strong>（组件的核心原则就是，一个组件只做一件事，而且其不应该是有上下强关联耦合性的，可以随用随取，做到职责单一，对于日后功能迭代和代码维护好处都是显而易见的）</li></ol> <p>就现代前端而言，我觉得组件化已不单单局限于 UI 组件层面，它涉及面更广、更全、也更系统化，类似 <code>hooks</code> 的功能和业务逻辑封装，工具类的使用封装，构建工具、脚本代码等，一切符合其独立思想的都可称为组件化。</p> <h2 id="为什么需要组件化"><a href="#为什么需要组件化" class="header-anchor">#</a> 为什么需要组件化</h2> <p>组件化的目的：</p> <ol><li>为了让各功能和业务逻辑可以被复用，以减少重复的代码。</li> <li>可以更好地使团队分工协作，不同的人负责编写不同的组件，提高开发效率。</li> <li>职责单一也更方便功能的迭代拓展与维护，对于接手的开发人员也能降低不少上手成本</li></ol> <p>对于需要开发复杂的大型应用的企业来说，组件化开发能极大地提高开发效率，它让前端开发团队能高效地完成工作，是一个非常有用的技术。</p> <p>简单来说就是两个关键词：“<strong>复用</strong>”、“<strong>易维护</strong>”</p> <p>代码拆分也好，职责单一也好，基本都离不开这两词，这也正式组件化的核心点。我们做这些事，就是为了之后遇到类似需求和功能的时候减少代码的开发，能够快速重复使用。而对于组件在日后随着功能和业务的发展、包括我们对于组件代码健壮性的提升，都会进行不断的迭代，维护性的重要性也是不言而喻的了。</p> <h2 id="基本目标"><a href="#基本目标" class="header-anchor">#</a> 基本目标</h2> <p>围绕核心述求可以进一步细化梳理，我们希望它能够这样：</p> <ol><li>可以围绕基础组件、业务组件，以及工具类的定位进行划分</li> <li>项目方案要足够简单清晰，确保新人上手成本足够低，可以快速投入开发使用</li> <li>组件的可维护性需要有保障</li> <li>严格的规范和工程化保障</li> <li>支持查看<code>API</code>、示例的文档网站</li> <li>真实开发环境的模拟调试和开发</li> <li>能够以<code>npm</code>包的形式进行引用使用</li> <li>可靠的多包项目管理、多包版本管理</li> <li>足够优秀的性能表现</li></ol> <h2 id="技术背景"><a href="#技术背景" class="header-anchor">#</a> 技术背景</h2> <p>首先，以公司实际项目为背景思考，我们的技术栈目前主要围绕 <code>vue2</code> 相关生态进行前端 web 后台类系统的开发。因此，主要方案设计也要以此为基础导向进行探索。</p> <p>就目前而言，我们的组件主要包括可复性较高的业务组件以及一些通用功能组件，也包括一些工具类。组件开发主要依赖于<code>iview</code>基础组件和<code>lodash</code>工具库，部分特殊业务有使用到<code>monaco-editor</code>、<code>codemirror</code>等。</p> <p>因此，现阶段我们公司的技术栈相关生态主要为 <code>vue2</code>，本系列也会以公司的<code>vue2</code>项目经历为依托进行记录。不过结合当下前端整体快速发展的现实情况下考虑，在项目实施落地之后，对相关生态具有足够清晰地掌握之后，以<code>vue3</code>和<code>react</code>为技术背景的探索也值得进一步探索研究。</p> <h3 id="包依赖"><a href="#包依赖" class="header-anchor">#</a> 包依赖</h3> <p>我们公司当前项目平台主要依赖分析，如下：</p> <ul><li>核心三大件：<code>vue</code>/<code>vue-router</code>/<code>vuex</code></li> <li>UI 类：<code>view-design</code>、<code>codemirror</code>、<code>monaco-editor</code>、<code>vue-echarts</code>、<code>vuedraggble</code></li> <li>工具类：<code>lodash</code>、<code>dayjs</code>、<code>uuid</code></li></ul> <p>围绕以上技术相关生态，做到对各部分及功能使用的二次封装管理</p> <p>主要 API 及实际项目代码分析：</p> <ul><li><strong>slot</strong>：组件拆分、UI 布局、自定义展示区域的好方法</li> <li><strong>props</strong>：父组件向子组件传递参数</li> <li><strong>ref</strong>：父组件获取子组件方法、属性</li> <li><strong>emit</strong>：子组件向父组件传递参数，触发父组件绑定事件方法</li> <li><strong>provide/inject</strong>：多级子父组件传值</li> <li><strong>vuex</strong>：第三方状态管理（需要考虑单一组件的可维护性）</li></ul> <p>总的来说组件封装较频繁使用的属性方法为<code>props</code>/<code>slot</code>/<code>emit</code>/<code>ref</code>，也是我们项目中大量采用的方式。</p> <p><code>vuex</code> 的使用需要谨慎考虑，具有一定的耦合性，需要进一步探索分析。</p> <p>对于更优的方式探索值得思考，核心点为职责单一独立、耦合性低，方便维护。</p> <h3 id="功能-业务组件"><a href="#功能-业务组件" class="header-anchor">#</a> 功能/业务组件</h3> <p>业务组件不同于功能组件，其具有一定的使用背景和条件限制。以我们使用的 <code>iview</code>、<code>antd</code>等UI组件为例，其提供了大量的功能组件，包括但不限于<code>表单功能组件</code>、<code>Table列表功能组件</code>、<code>多选/单选功能组件</code>、<code>日期功能组件</code>等等，它只提供某一类的通用功能，并抽象封装为一个具体的功能组件。</p> <p>而相对于业务组件来说就有些许不同了，业务组件首先必定聚焦于一个明确的业务场景，其最终实现可能是融合了多个功能组件的组合，也可能是结合一些插件独立实现的某一特殊功能。</p> <p>当前项目已存在的一些业务组件分析：</p> <ul><li><strong>ProTable</strong>功能组件：由单个<code>FilterBtn组件</code>、<code>Table组件</code>、<code>Pagination组件</code>，进而组合成整体的一个组件（包含列表、筛选、分页）</li> <li><strong>ComSqlTipTree</strong>业务组件：使用频率相当高的 <code>ComSqlTipTree组件</code>，也是集合了众多子组件的一个组合(涉及到对<code>Input</code>的高级封装、<code>Select</code>选择、拼音匹配、列表展示等，该组件专门用于公司核心功能筛选类查找时的使用)</li></ul> <h3 id="组件管理思考"><a href="#组件管理思考" class="header-anchor">#</a> 组件管理思考</h3> <ol><li>基础组件类：可以参照<code>iview</code>、<code>antd</code>等UI组件库的方式进行维护管理，聚焦于功能相关，属于较小型的组件，统一维护管理。</li> <li>业务组件类：可以参照<a href="https://procomponents.ant.design/" target="_blank" rel="noopener noreferrer"><code>pro-component</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>高级组件的管理模式进行处理。</li> <li>工具类：可以参照<code>lodash</code>的方式进行维护管理</li></ol> <p><code>pro-component</code>的管理模式为大量基于基础组件封装而成的高级组件，如：<code>pro-layout</code>、<code>pro-table</code>、<code>pro-form</code>等，每个组件可以作为独立的<code>npm</code>包作为依赖使用，相互独立、互不影响。</p> <p>再思考到对于工具类的管理维护，整体考虑下来，基本确定可以为多包管理的方向（<strong>Monorepo</strong>）</p> <h2 id="技术调研"><a href="#技术调研" class="header-anchor">#</a> 技术调研</h2> <p>围绕项目技术背景和目标规划，进行相关技术调研。</p> <h3 id="相关开源项目分析"><a href="#相关开源项目分析" class="header-anchor">#</a> 相关开源项目分析</h3> <ol><li>需要考虑的方向是：对于 <code>vue2.x</code> 版本的组件化方案，哪种更为合适（目前市面上有大量的<code>vue3</code>组件库）</li> <li><code>vue2</code> 对于 <code>TS</code> 的考虑 （vue2对ts的支持性一般，是否支持视情况而定）</li> <li>对<code>props</code> 参数 <code>API</code> 的文档、demo演示，文档网站建设的考虑</li> <li>目录设计、工程规范、构建发布流程</li></ol> <ul><li><a href="https://github.com/ElemeFE/element" target="_blank" rel="noopener noreferrer">element<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <ul><li>无 <code>monorepo</code>，属于比较传统的单一包管理项目</li> <li>比价经典的<code>vue2</code>组件库项目，文档网站风格很不错</li> <li>主要使用 <code>js + vue</code>开发，构建由<code>webpack</code>处理</li> <li>文档网站由自身组件开发搭建，结合<code>webpack loader</code>实现对<code>markdown</code>文件的编译及<code>demo</code>示例的渲染</li></ul></li> <li><a href="https://github.com/vuetifyjs/vuetify" target="_blank" rel="noopener noreferrer">vuetify<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <ul><li><code>lernajs + yarn + workspace</code> 的方案，标准的 <code>lernajs + yarn</code> 用法</li> <li><code>vue2.x + ts</code> 写法，组件大量以 <code>JSX</code> 实现，具有很好的参考学习价值（vue2 中对 TS 的使用）</li> <li>文档网站由自身组件自行开发搭建，项目代码较多，有一定的上手成本</li></ul></li> <li><a href="https://github.com/element-plus/element-plus" target="_blank" rel="noopener noreferrer">element-plus<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <ul><li><code>vue3</code> 的项目，<code>pnpm + workspace</code> 的方案，整体思路和设计非常现代化</li> <li>组件实现由 vue编写开发，相关脚本代码由 TS编写，整个项目为 TS项目</li> <li>多包目录设计、组件和文档目录设计合理</li> <li>相关构建工具包括 <code>rollup</code>、<code>esbuild</code>、<code>vite</code></li> <li>文档网站由<code>vitepress</code>构建，并自行编写了处理<code>markdown</code>和<code>vue demo</code>的插件进行处理（<code>vitepress</code>只支持<code>vue3</code>）</li></ul></li> <li><a href="https://github.com/IDuxFE/idux" target="_blank" rel="noopener noreferrer">idux<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <ul><li><code>vue3</code> 的项目，<code>pnpm + workspace</code> 的方案，技术都比较新</li> <li>版本控制由 <code>lerna</code>管理</li> <li><code>demo</code>与<code>docs</code>的目录管理很不错，需要配合脚本实现最终的网站路由和渲染</li> <li>文档网站由 <code>vitepress</code> + 自身组件构建，并配合各种脚本实现对应功能</li> <li>构建工具主要为 <code>gulp</code></li> <li>组件开发主要为 <code>tsx</code>形式</li></ul></li></ul> <h3 id="monorepo-是什么"><a href="#monorepo-是什么" class="header-anchor">#</a> monorepo 是什么</h3> <ul><li><strong>Monorepo</strong>：所有依赖库完全放入一个项目工程</li> <li><strong>Multirepo</strong>：多个依赖包独立进行 git 管理</li></ul> <p><code>monorepo</code> 是把多个项目的所有代码放到一个 <code>git</code> 仓库中进行管理，多个项目中会有共享的代码则可以分包引用。整个项目就是有 root 管理的 <code>dependencies</code> 加上多个 <code>packages</code>，每个 <code>package</code> 也可以在自己的作用域引入自己的 <code>dependencies</code>。</p> <p>该方案可以很好的帮助我们解决不同工作区对于相同依赖的管理，以及我们在开发时，包相互间依赖的管理。</p> <h3 id="monorepo-lernajs-yarn"><a href="#monorepo-lernajs-yarn" class="header-anchor">#</a> monorepo + lernajs + yarn</h3> <p><code>Lerna</code> 是一种工具，针对使用 <code>git</code> 和 <code>npm</code> 管理多软件包代码仓库的工作流程进行优化。</p> <p><code>Lerna</code> 有两种管理项目的模式：</p> <ul><li><code>Fixed/Locked</code> 模式 (默认)： 所有的包共用一个版本号。</li> <li><code>Independent mode</code>：不同包独立使用自己的版本，我们一般采用这种方式。在初始化的时候指定 <code>--independent</code> 参数</li></ul> <p>一般而言，在<code>pnpm</code>未出现前，相关<code>workspace</code>概念基本是配合 <code>yarn</code>一起使用（<code>yarn</code>有<code>workspace</code>功能），因为 <code>npm7.x</code>之前是没有 <code>workspace</code>概念的，所以在很长的一段时间里，多包管理方案 <code>monorepo</code>都是与 <code>yarn</code>一起配合使用。</p> <p>他解决了以下问题：</p> <ul><li>多业务组件、互相依赖、无法复用</li> <li>发包流程复杂、版本管理痛苦</li></ul> <h4 id="依赖管理"><a href="#依赖管理" class="header-anchor">#</a> 依赖管理</h4> <p>在工作区 <code>packages</code> 下面我们有这些包：<code>iview</code>、<code>pro-sqltiptree</code>、<code>components</code>，其 <code>package.json</code> 中的 <code>name</code> 定义分别为<code>@ah-ailpha/iview</code>、<code>@ah-ailpha/pro-sqltiptre</code>、<code>@ah-ailpha/components</code>，在我们相互安装包时，<strong>lerna</strong> 工具可以帮我们以用软链接的形式直接使用。（对于软链接的概念可以参考 <code>npm link</code>，以及<code>pnpm</code>的底层实现逻辑）</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># 向 module-2 中添加 module-1 作为依赖</span>
$ lerna <span class="token function">add</span> module-1 --scope<span class="token operator">=</span>module-2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="版本管理"><a href="#版本管理" class="header-anchor">#</a> 版本管理</h4> <p>对于<code>monorepo</code>的多包场景，<strong>lerna</strong>另一大核心功能就是可以很好的帮助我们管理每个包的版本，通过使用 <code>lerna version</code>命令即可（可结合命令式交互快速管理版本）</p> <p><code>lerna version</code> 在背后为我们做了这些事：</p> <ul><li>识别出自上次发布以后更新过的包；</li> <li>提示选择新版本；</li> <li>修改包的元数据来反映最新发版（修改包的版本号），在根目录和每个包里面运行生命周期脚本；</li> <li>对提交打 tag；</li> <li>推送到远程代码仓库。</li></ul> <h3 id="monorepo-pnpm"><a href="#monorepo-pnpm" class="header-anchor">#</a> monorepo + pnpm</h3> <p><code>pnpm</code>现在也支持<strong>workspace</strong>的概念了<a href="https://pnpm.io/zh/workspaces" target="_blank" rel="noopener noreferrer">工作空间（Workspace）<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，如果是经常关注技术社区论坛的，相信你对<code>pnpm</code>已经有过了解了，<code>pnpm</code>因为其优秀的性能表现，以及其对<code>monorepo</code>的支持也更简单方便，使得现在很多知名的开源项目都采用了该方案，如 <code>Vue3</code>/<code>Vite</code>/<code>VueUse</code>/<code>Element Plus</code>/<code>Next.js</code>/<code>Astro</code>等等。</p> <p><code>pnpm</code> 内置了对单一存储库（也称为多包存储库、多项目存储库或单体存储库）的支持， 你可以创建一个 <strong>workspace</strong> 以将多个项目合并到一个仓库中。</p> <p>一个 <strong>workspace</strong> 的根目录下必须有 <code>pnpm-workspace.yaml</code> 文件， 也可能会有 <code>.npmrc</code> 文件。</p> <p>如何高效的使用 <code>pnpm</code>，需要了解几个常用的基本命令：</p> <ul><li><code>--filter</code>：过滤，过滤允许您将命令限制于包的特定子集，一般用于 <code>packages/*</code> 下面的子项目。</li> <li><code>-C</code>：在 <code>&lt;path&gt;</code> 中启动 <code>pnpm</code> ，而不是当前的工作目录。</li> <li><code>-r</code>：安装在所有 <code>packages</code> 中（一般配合<code>--filter</code>指定项目目录）</li> <li><code>-w</code>：表示把包安装在 root 下，该包会放置在 <code>&lt;root&gt;/node_modules</code> 下</li></ul> <p><code>pnpm</code>同样可以实现对包依赖的管理，类似<strong>lerna</strong>一样，通过软连接的方式关联到子项目，可以极大的方便我们对于多项目依赖的管理。</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">pnpm</span> <span class="token function">add</span> <span class="token operator">&lt;</span>package-name<span class="token operator">&gt;</span> --filter <span class="token operator">&lt;</span>target-package-name<span class="token operator">&gt;</span>

<span class="token comment"># 比如要将lodash装到package-a下</span>
<span class="token comment"># --filter 后面可以为目录名称也可以为 package.josn 的 name 名称</span>
<span class="token function">pnpm</span> <span class="token function">add</span> dayjs --filter @ah-ailpha/package-a

<span class="token comment"># 向 module-2 中添加 module-1 作为依赖</span>
<span class="token function">pnpm</span> <span class="token function">add</span> module-1 --filter module-2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="lerna-changeset-版本管理分析"><a href="#lerna-changeset-版本管理分析" class="header-anchor">#</a> lerna / changeset 版本管理分析</h3> <p>不管对于 <code>yarn</code>还是 <code>pnpm</code>来说，都只是对于工作空间 <strong>woekspace</strong>的多包管理，对于多依赖管理，<code>pnpm</code>目前可以支持，而<code>yarn</code>是需要<strong>lerna</strong>进行协助的。</p> <p>但是对于各包的<code>version</code>版本控制，两者都不直接参与管理，只能使用第三方工具进行处理。</p> <h4 id="lerna"><a href="#lerna" class="header-anchor">#</a> lerna</h4> <p>目前已知的比较成熟的方案有<code>lerna</code>，也是使用比较频繁的，好处是其功能比较全面，但也存在一些明显的问题</p> <ol><li>不能和<code>pnpm</code>很好的适配，<code>lerna</code> 本身不支持 <code>workspace</code> 协议，导致基于 <code>pnpm</code> 开发的一些仓库无法使用</li> <li><code>lerna version</code> 根据 <code>commit</code> 以及 <code>tag</code> 更新出来的包版本不符合预期</li> <li>整个包的体积很大，依赖特别多（轻量版<a href="https://www.npmjs.com/package/@lerna-lite/cli" target="_blank" rel="noopener noreferrer">lerna-lite<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>）</li> <li>相比较<code>pnpm</code>而言，<code>lerna</code>使用起来还是比较的笨重、繁琐</li></ol> <h4 id="changeset"><a href="#changeset" class="header-anchor">#</a> changeset</h4> <p><code>Changesets</code> 是一个用于 <strong>Monorepo</strong> 项目下版本以及 <code>Changelog</code> 文件管理的工具（目前一些比较火的 <strong>Monorepo</strong> 仓库都在使用该工具进行项目的发包例如 <code>pnpm</code>、<code>mobx</code> 等）</p> <p><code>changesets</code> 主要关心 <code>monorepo</code> 项目下子项目<strong>版本的更新</strong>、<strong>changelog 文件生成</strong>、<strong>包的发布</strong>。</p> <p>一个 <code>changeset</code> 是个包含了在某个分支或者 <code>commit</code> 上改动信息的 <code>md</code> 文件，它会包含这样一些信息:</p> <ul><li>需要发布的包</li> <li>包版本的更新层级(遵循 <code>semver</code> 规范)</li> <li><code>CHANGELOG</code> 信息</li></ul> <p>总的来说，<code>changeset</code>的工作内容还是比较明确的，我们需要直接参与的就是包版本的管理与发布，对于<code>changelog</code>的文件生成会由脚本自动处理，我们无需关心（需要按照<code>commitlint</code>规范提交<code>message</code>，这里到时我们通过工程化的方式进行控制即可）</p> <h4 id="版本控制管理小结"><a href="#版本控制管理小结" class="header-anchor">#</a> 版本控制管理小结</h4> <ol><li>使用 <code>yarn + monorepo</code>的项目一般使用<strong>lerna</strong>配合进行依赖和版本管理</li> <li>采用 <code>pnpm + workspace</code>方案的 <strong>monorepo</strong>，可以选择使用 <strong>changeset</strong>进行版本管理控制，从而快速搭建一个完整的 <strong>monorepo</strong>项目。</li></ol> <h2 id="尾声"><a href="#尾声" class="header-anchor">#</a> 尾声</h2> <p>本篇文章算得上是搭建本项目的一些前期探究，在从0到1的过程还是比较迷茫的，使用什么方案，哪种方案适合我，在找到适合的方案时又发现并不是我喜欢的技术方向时，如何做出选择，以及如何选择最优解等等，这些都是在我在实践的过程中所经历的。</p> <p>总的来说，我比较关注技术社区和开源项目，一般出现了什么新的技术框架时，我也能及时的了解和尝试。在针对如何使用的这个问题上，通过结合官方文档和开源社区各种demo模板，也能略知一二，再简单上手使用对比下，大致能够有所了解，就我个人的项目而言我还是满喜欢尝鲜的，觉得好用、不错就会直接开整，遇到问题就尝试解决，也算是在这个过程中学习了。不过，对于公司的项目来说，总体偏稳定版、技术成熟度高、社区活跃的进行选择，在遇到问题时也能发现类似的解决方案。</p> <p><strong>monorepo</strong>算是我很早之前就打算研究和尝试的方向了，苦于一直没有合适的机会（😶懒~），在没有项目的推动下，自己也缺乏一定的动力，恰好现在公司在推进这个事情，而且还是由我进行负责，也算得上是个不错的机会了。</p> <p>在开始之前我自己之前对于<code>lerna</code>是有一点了解的，因此，最开始在进行技术调研的时候也是大致围绕这个方向进行的，期间也看了不少开源项目的设计和使用方式，基本上算是入门了，不过，在我自己进行demo测试以及简单使用后，发现<code>lerna</code>的确有很多不太方便、不易用的地方，尤其是对于多项目命令的支持，远不及<code>pnpm</code>来的方便。</p> <p><code>pnpm</code>对于我来说并不算陌生，我在去年就开始在用了，整体还是比较顺手的，也比较喜欢，只是对于<code>pnpm + workspace + monorepo</code>这种方式没有实践过，不过在此之前倒是了解过不少相关的文章，印象较深的是介绍 <code>vue</code>生态的多包管理过渡到<code>pnpm + workspace</code>的文章，自己正好也一直想找机会尝试来着。</p> <p>因此，在使用<code>lerna</code>发现一些较大的短板之后，我也是顺势过渡为<code>pnpm + workspace</code>的方案来了，以及在后期尝试了对于版本管理控制的<code>changeset</code>方案之后，最终确定的技术路线为<code>pnpm + workspace + changeset</code>的<strong>monorepo多包管理方案</strong>。</p> <p>实践篇相关文章见下一篇，欢迎关注（已经在写了😅~）。</p> <h2 id="资料"><a href="#资料" class="header-anchor">#</a> 资料</h2> <ul><li><a href="https://pnpm.io/zh" target="_blank" rel="noopener noreferrer">pnpm<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://pnpm.io/zh/workspaces" target="_blank" rel="noopener noreferrer">pnpm-workspaces<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/ElemeFE/element" target="_blank" rel="noopener noreferrer">element<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/vuetifyjs/vuetify" target="_blank" rel="noopener noreferrer">vuetify<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/element-plus/element-plus" target="_blank" rel="noopener noreferrer">element-plus<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/IDuxFE/idux" target="_blank" rel="noopener noreferrer">idux<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.lernajs.cn/" target="_blank" rel="noopener noreferrer">lernajs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.zoo.team/article/lerna-js" target="_blank" rel="noopener noreferrer">Lerna 运行流程剖析<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://icode.best/i/54395246194902" target="_blank" rel="noopener noreferrer">pnpm 多包管理项目-爱代码爱编程<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://juejin.cn/post/7024827345059971080" target="_blank" rel="noopener noreferrer">Changesets: 流行的 monorepo 场景发包工具<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com/JS-banana/vuepress/edit/master/docs/01.前端/02.工程化/150.【前端组件化】系列第一篇.md" target="_blank" rel="noopener noreferrer">编辑</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="tags"><a href="/tags/?tag=monorepo" title="标签">#monorepo</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2025/09/01, 09:19:57</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/2833ad/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">【vite】构建vue3+ts应用</div></a> <a href="/pages/eb2149/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">【前端组件化】系列第二篇</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/2833ad/" class="prev">【vite】构建vue3+ts应用</a></span> <span class="next"><a href="/pages/eb2149/">【前端组件化】系列第二篇</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/e4bf0d/"><div>说说call、apply、bind是如何改变this的</div></a> <span>03-29</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/d865ca/"><div>从输入 URL 到页面加载完成发生了什么？</div></a> <span>03-29</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/8d9372/"><div>JavaScript进阶—— new 的执行过程</div></a> <span>03-26</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:213018@163.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/JS-banana" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://juejin.cn/user/1204720476890477" title="掘金" target="_blank" class="iconfont icon-juejin"></a></div> <span>sunss</span> 
    | © 2020.08-2025.09
    <span><a href="https://beian.miit.gov.cn/" target="_blank">浙ICP备2022002957号-1</a></span> <div class="cloud"><span id="timeDate">载入天数...</span> <span id="times">载入时分秒...</span>
     | 
    <span id="busuanzi_container_site_pv">
      总访问量 <span id="busuanzi_value_site_pv"></span> 次
    </span></div> <div class="cloud"><a href="https://cloud.tencent.com/" target="_blank"><img src="https://cloudcache.tencent-cloud.com/qcloud/portal/kit/images/slice/logo.f0c9ade4.svg" alt></a>
    提供CDN加速/云存储服务
  </div></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">跟随系统</li><li class="iconfont icon-rijianmoshi">浅色模式</li><li class="iconfont icon-yejianmoshi">深色模式</li><li class="iconfont icon-yuedu">阅读模式</li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><canvas id="erraticSignals-canvas" data-v-71426c40></canvas><div></div></div></div>
    <script src="/assets/js/app.659b4e88.js" defer></script><script src="/assets/js/2.6ed24f91.js" defer></script><script src="/assets/js/3.c0dae15f.js" defer></script><script src="/assets/js/27.5a7f606c.js" defer></script>
  </body>
</html>