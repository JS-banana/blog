<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>vite + vue3 + ts 使用总结 | 小帅の技术博客</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/blog/img/favicon.ico">
    <script async="async" crossorigin="anonymous" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2069361349446100"></script>
    <script async="async" src="/blog//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <meta name="description" content="web前端技术博客,简洁至上,专注web前端学习与总结。JavaScript,js,ES6,TypeScript,vue,css3,html5,Node,git,github等技术文章。">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="cewstn11l3">
    <meta name="theme-color" content="#11a8cd">
    <link rel="preload" href="/blog/assets/css/0.styles.1722f3e3.css" as="style"><link rel="preload" href="/blog/assets/js/app.8943bfc3.js" as="script"><link rel="preload" href="/blog/assets/js/2.6ed24f91.js" as="script"><link rel="preload" href="/blog/assets/js/3.c0dae15f.js" as="script"><link rel="preload" href="/blog/assets/js/31.a2a4b158.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.a9d15544.js"><link rel="prefetch" href="/blog/assets/js/100.52ed5582.js"><link rel="prefetch" href="/blog/assets/js/11.2b1b3707.js"><link rel="prefetch" href="/blog/assets/js/12.bdb1e59e.js"><link rel="prefetch" href="/blog/assets/js/13.f22b5565.js"><link rel="prefetch" href="/blog/assets/js/14.9de8da8f.js"><link rel="prefetch" href="/blog/assets/js/15.d0dcb8b1.js"><link rel="prefetch" href="/blog/assets/js/16.2f7d7cc0.js"><link rel="prefetch" href="/blog/assets/js/17.3eb60e6b.js"><link rel="prefetch" href="/blog/assets/js/18.873f5fc1.js"><link rel="prefetch" href="/blog/assets/js/19.c5056488.js"><link rel="prefetch" href="/blog/assets/js/20.e8ae9a39.js"><link rel="prefetch" href="/blog/assets/js/21.58cc81e9.js"><link rel="prefetch" href="/blog/assets/js/22.616dd932.js"><link rel="prefetch" href="/blog/assets/js/23.3988c4a2.js"><link rel="prefetch" href="/blog/assets/js/24.30eae990.js"><link rel="prefetch" href="/blog/assets/js/25.054a22c3.js"><link rel="prefetch" href="/blog/assets/js/26.f62d77ff.js"><link rel="prefetch" href="/blog/assets/js/27.5a7f606c.js"><link rel="prefetch" href="/blog/assets/js/28.855191fa.js"><link rel="prefetch" href="/blog/assets/js/29.c10a5b9c.js"><link rel="prefetch" href="/blog/assets/js/30.90f8bc11.js"><link rel="prefetch" href="/blog/assets/js/32.94467faf.js"><link rel="prefetch" href="/blog/assets/js/33.46a7618c.js"><link rel="prefetch" href="/blog/assets/js/34.2f8e431f.js"><link rel="prefetch" href="/blog/assets/js/35.de92d414.js"><link rel="prefetch" href="/blog/assets/js/36.0f1e33f2.js"><link rel="prefetch" href="/blog/assets/js/37.704c88fd.js"><link rel="prefetch" href="/blog/assets/js/38.5fcce310.js"><link rel="prefetch" href="/blog/assets/js/39.eb5f78b7.js"><link rel="prefetch" href="/blog/assets/js/4.e3247416.js"><link rel="prefetch" href="/blog/assets/js/40.3776a822.js"><link rel="prefetch" href="/blog/assets/js/41.bf4cdd88.js"><link rel="prefetch" href="/blog/assets/js/42.4c085ac0.js"><link rel="prefetch" href="/blog/assets/js/43.b7ef5577.js"><link rel="prefetch" href="/blog/assets/js/44.754b1bc9.js"><link rel="prefetch" href="/blog/assets/js/45.341273a8.js"><link rel="prefetch" href="/blog/assets/js/46.37506398.js"><link rel="prefetch" href="/blog/assets/js/47.f777c0cf.js"><link rel="prefetch" href="/blog/assets/js/48.5a34ff4e.js"><link rel="prefetch" href="/blog/assets/js/49.7b1241e4.js"><link rel="prefetch" href="/blog/assets/js/5.6d2ab4af.js"><link rel="prefetch" href="/blog/assets/js/50.16693f32.js"><link rel="prefetch" href="/blog/assets/js/51.b6a3f265.js"><link rel="prefetch" href="/blog/assets/js/52.6591bc6c.js"><link rel="prefetch" href="/blog/assets/js/53.57270a88.js"><link rel="prefetch" href="/blog/assets/js/54.068dbbe0.js"><link rel="prefetch" href="/blog/assets/js/55.6219da16.js"><link rel="prefetch" href="/blog/assets/js/56.9ebd78de.js"><link rel="prefetch" href="/blog/assets/js/57.f0ac33b8.js"><link rel="prefetch" href="/blog/assets/js/58.4c840d5e.js"><link rel="prefetch" href="/blog/assets/js/59.1a39ef89.js"><link rel="prefetch" href="/blog/assets/js/6.b7fbc8ce.js"><link rel="prefetch" href="/blog/assets/js/60.702a379f.js"><link rel="prefetch" href="/blog/assets/js/61.e47c18f8.js"><link rel="prefetch" href="/blog/assets/js/62.a0559b0b.js"><link rel="prefetch" href="/blog/assets/js/63.0b126dc0.js"><link rel="prefetch" href="/blog/assets/js/64.31ae45ee.js"><link rel="prefetch" href="/blog/assets/js/65.c259a8fc.js"><link rel="prefetch" href="/blog/assets/js/66.4ed84f26.js"><link rel="prefetch" href="/blog/assets/js/67.e01763b8.js"><link rel="prefetch" href="/blog/assets/js/68.eba26eb5.js"><link rel="prefetch" href="/blog/assets/js/69.961f5b63.js"><link rel="prefetch" href="/blog/assets/js/7.3b6f6c74.js"><link rel="prefetch" href="/blog/assets/js/70.27568cc8.js"><link rel="prefetch" href="/blog/assets/js/71.ca88e180.js"><link rel="prefetch" href="/blog/assets/js/72.f75b8b7c.js"><link rel="prefetch" href="/blog/assets/js/73.8e1146b9.js"><link rel="prefetch" href="/blog/assets/js/74.45b83fe7.js"><link rel="prefetch" href="/blog/assets/js/75.ed8b78da.js"><link rel="prefetch" href="/blog/assets/js/76.8361196e.js"><link rel="prefetch" href="/blog/assets/js/77.c2d70e59.js"><link rel="prefetch" href="/blog/assets/js/78.57d8f9cb.js"><link rel="prefetch" href="/blog/assets/js/79.9381f656.js"><link rel="prefetch" href="/blog/assets/js/8.99008766.js"><link rel="prefetch" href="/blog/assets/js/80.1935fc35.js"><link rel="prefetch" href="/blog/assets/js/81.1b6cbbee.js"><link rel="prefetch" href="/blog/assets/js/82.f24a8ccd.js"><link rel="prefetch" href="/blog/assets/js/83.7a128231.js"><link rel="prefetch" href="/blog/assets/js/84.239c5b05.js"><link rel="prefetch" href="/blog/assets/js/85.c55b61c7.js"><link rel="prefetch" href="/blog/assets/js/86.8c26f224.js"><link rel="prefetch" href="/blog/assets/js/87.04950bab.js"><link rel="prefetch" href="/blog/assets/js/88.0c8f2904.js"><link rel="prefetch" href="/blog/assets/js/89.4a5d97f6.js"><link rel="prefetch" href="/blog/assets/js/9.1bec759d.js"><link rel="prefetch" href="/blog/assets/js/90.589c3a4d.js"><link rel="prefetch" href="/blog/assets/js/91.85211c62.js"><link rel="prefetch" href="/blog/assets/js/92.55b5b980.js"><link rel="prefetch" href="/blog/assets/js/93.d94cc1ed.js"><link rel="prefetch" href="/blog/assets/js/94.b398255a.js"><link rel="prefetch" href="/blog/assets/js/95.35fd947d.js"><link rel="prefetch" href="/blog/assets/js/96.43c38934.js"><link rel="prefetch" href="/blog/assets/js/97.9267ef1b.js"><link rel="prefetch" href="/blog/assets/js/98.1f73f0d3.js"><link rel="prefetch" href="/blog/assets/js/99.f05bf137.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.1722f3e3.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="/blog/img/photo_nobg.png" alt="小帅の技术博客" class="logo"> <span class="site-name can-hide">小帅の技术博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/blog/frontend/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/pages/be6faa/" class="nav-link">基础</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/33f292/" aria-current="page" class="nav-link router-link-exact-active router-link-active">框架</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/c8aad6/" class="nav-link">进阶</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/2833ad/" class="nav-link">工程化</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="全栈" class="dropdown-title"><a href="/blog/fullstack/" class="link-title">全栈</a> <span class="title" style="display:none;">全栈</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/pages/5fe09e/" class="nav-link">NodeJS</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/337720/" class="nav-link">脚本</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/131a7a/" class="nav-link">拓展</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/04df1e/" class="nav-link">技术</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/5cd35f/" class="nav-link">服务器</a></li></ul></div></div><div class="nav-item"><a href="/blog/life/" class="nav-link">程序猿</a></div><div class="nav-item"><a href="/blog/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/blog/friends/" class="nav-link">友链</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/blog/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/blog/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/blog/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/JS-banana/vuepress" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://cdn.jsdelivr.net/gh/JS-banana/images/vuepress/photo.jpg"> <div class="blogger-info"><h3>前端小帅</h3> <span>学而不思则罔，思而不学则殆</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/blog/frontend/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/pages/be6faa/" class="nav-link">基础</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/33f292/" aria-current="page" class="nav-link router-link-exact-active router-link-active">框架</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/c8aad6/" class="nav-link">进阶</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/2833ad/" class="nav-link">工程化</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="全栈" class="dropdown-title"><a href="/blog/fullstack/" class="link-title">全栈</a> <span class="title" style="display:none;">全栈</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/pages/5fe09e/" class="nav-link">NodeJS</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/337720/" class="nav-link">脚本</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/131a7a/" class="nav-link">拓展</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/04df1e/" class="nav-link">技术</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/5cd35f/" class="nav-link">服务器</a></li></ul></div></div><div class="nav-item"><a href="/blog/life/" class="nav-link">程序猿</a></div><div class="nav-item"><a href="/blog/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/blog/friends/" class="nav-link">友链</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/blog/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/blog/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/blog/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/JS-banana/vuepress" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>工程化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>框架</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/pages/33f292/" aria-current="page" class="active sidebar-link">vue3使用总结</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/pages/33f292/#前言" class="sidebar-link">前言</a></li><li class="sidebar-sub-header"><a href="/blog/pages/33f292/#import-meta" class="sidebar-link">import.meta</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/pages/33f292/#环境变量获取" class="sidebar-link">环境变量获取</a></li><li class="sidebar-sub-header"><a href="/blog/pages/33f292/#批量处理文件" class="sidebar-link">批量处理文件</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/pages/33f292/#ref和reactive" class="sidebar-link">ref和reactive</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/pages/33f292/#ref" class="sidebar-link">ref</a></li><li class="sidebar-sub-header"><a href="/blog/pages/33f292/#reactive" class="sidebar-link">reactive</a></li><li class="sidebar-sub-header"><a href="/blog/pages/33f292/#小结" class="sidebar-link">小结</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/pages/33f292/#watch、watcheffect" class="sidebar-link">watch、watchEffect</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/pages/33f292/#watch" class="sidebar-link">watch</a></li><li class="sidebar-sub-header"><a href="/blog/pages/33f292/#watcheffect" class="sidebar-link">watchEffect</a></li><li class="sidebar-sub-header"><a href="/blog/pages/33f292/#watch、watcheffect-小结" class="sidebar-link">watch、watchEffect 小结</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/pages/33f292/#shallowref和shallowreactive" class="sidebar-link">shallowRef和shallowReactive</a></li><li class="sidebar-sub-header"><a href="/blog/pages/33f292/#script-setup-写法的-props-、context处理方式" class="sidebar-link">script setup 写法的 props 、context处理方式</a></li><li class="sidebar-sub-header"><a href="/blog/pages/33f292/#props-type-类型定义问题" class="sidebar-link">props Type 类型定义问题</a></li><li class="sidebar-sub-header"><a href="/blog/pages/33f292/#prop、ref、emit-数据通信" class="sidebar-link">prop、ref、emit 数据通信</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/pages/33f292/#prop" class="sidebar-link">prop</a></li><li class="sidebar-sub-header"><a href="/blog/pages/33f292/#ref-2" class="sidebar-link">ref</a></li><li class="sidebar-sub-header"><a href="/blog/pages/33f292/#emit" class="sidebar-link">emit</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/pages/33f292/#jsx-语法" class="sidebar-link">jsx 语法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/pages/33f292/#table组件" class="sidebar-link">Table组件</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/pages/33f292/#event-bus" class="sidebar-link">event bus</a></li><li class="sidebar-sub-header"><a href="/blog/pages/33f292/#二级路径嵌套域名的部署配置" class="sidebar-link">二级路径嵌套域名的部署配置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/pages/33f292/#简单举例" class="sidebar-link">简单举例</a></li><li class="sidebar-sub-header"><a href="/blog/pages/33f292/#项目配置" class="sidebar-link">项目配置</a></li><li class="sidebar-sub-header"><a href="/blog/pages/33f292/#注意" class="sidebar-link">注意</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/pages/33f292/#结语" class="sidebar-link">结语</a></li></ul></li><li><a href="/blog/pages/394c89/" class="sidebar-link">vue编译为js的研究</a></li><li><a href="/blog/pages/f2d5b5/" class="sidebar-link">react状态管理器-zustand</a></li><li><a href="/blog/pages/efa13c/" class="sidebar-link">redux和redux-thunk分析</a></li><li><a href="/blog/pages/1280fe/" class="sidebar-link">react之不可变数据分析</a></li><li><a href="/blog/pages/1c6866/" class="sidebar-link">性能爆表的solidjs</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>精进</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>其他</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-583ea4e9><div class="articleInfo" data-v-583ea4e9><ul class="breadcrumbs" data-v-583ea4e9><li data-v-583ea4e9><a href="/blog/" title="首页" class="iconfont icon-home router-link-active" data-v-583ea4e9></a></li> <li data-v-583ea4e9><a href="/blog/frontend" title="前端-目录页" data-v-583ea4e9>前端</a></li> <li data-v-583ea4e9><a href="/blog/frontend/#框架" title="前端#框架" data-v-583ea4e9>框架</a></li> <!----></ul> <div class="info" data-v-583ea4e9><div title="作者" class="author iconfont icon-touxiang" data-v-583ea4e9><a href="https://github.com/JS-banana" target="_blank" title="作者" class="beLink" data-v-583ea4e9>sunss</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-583ea4e9><a href="javascript:;" data-v-583ea4e9>2021-11-29</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">
          vite + vue3 + ts 使用总结
        </h1> <!----> <div class="theme-vdoing-content content__default"><p>现阶段开发 <code>vue3</code> 项目使用 <code>vite</code> + <code>ts</code> 应该已成为标准范式了吧，新的语法体验 <code>vue composition api</code> 再配合 <code>script setup</code> 谁用谁知道啊，开发和构建方面，<code>vite</code> 作为下一代构建工具，想必大家也有所了解，使用 <code>ES6 module</code> + <code>ESbuild</code> 支持本地开发，速度和效率起飞啊，就一个字——爽，对于 <code>TypeScript</code>，感觉都没必要说了，现在还没上车的赶紧的了~</p> <h2 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h2> <p><code>vite</code> 作为一个构建工具，我们目前了解如何使用即可，该工具足够优秀，默认对很多功能都做到了支持（<code>css module</code>、<code>less</code>、<code>scss</code>），且其作为 <code>vue</code>之父尤大大的作品，对于 <code>vue</code>也有着较好的支持，目前使用率也已经很高了，<code>nuxt</code>等多个大项目都已支持，结合文档和社区，目前使用足够了，也无需担心疑难杂症~，快上车~</p> <p><code>vue3</code>，感觉变化最大的就是全面拥抱了函数式编程，结合 <code>composition api</code> 现在真的可以做到对于复杂业务代码的轻松管理，抛弃以前的 this this 一大堆，不友好的<code>mixin</code> ，使用现在的 <code>hooks</code>处理，逻辑复用、功能模块拆分简直太方便了，语法、api使用上也优雅方便了很多，很值得一试</p> <p>另一大亮点就是 <code>vue3</code>对 <code>TS</code>的良好支持，现在项目可以全面拥抱 TS写法了，然后与 <code>setup</code> 再结合我接下来推荐的几款工具，组合起来使用，简直不要太爽</p> <p>对于 <code>TS</code>，首先要做到对类型的定义，这是和传统写JS有所不同的地方，但是这一步却是很必要也很值得的，这对你接下来的工作或者说对于这个项目的以后都是有很大的好处</p> <p>如这样一个场景，和后端接口对接：</p> <p>在前期，我们拿到接口文档，按照格式和类型定义好对应 TS类型，并结合 Mock写好接口和业务逻辑，使用时通过TS可以高效的完成代码开发，同时可以极大的避免犯错，对于后期维护迭代有很大的保障</p> <h2 id="import-meta"><a href="#import-meta" class="header-anchor">#</a> import.meta</h2> <p>使用 vite做为构建工具，可以通过 <code>import.meta</code>获取对应方法方便快速的处理业务</p> <h3 id="环境变量获取"><a href="#环境变量获取" class="header-anchor">#</a> 环境变量获取</h3> <ul><li>在 <code>package.json</code>中以命令行的形式定义（<code>&quot;dev:development&quot;: &quot;vite --mode development&quot;</code>）</li> <li>在 <code>.env</code>中以配置文件的形式定义（<code>VITE_APP_ENV = development</code>）</li></ul> <p>当<code>.env.development</code> 文件如下配置时：</p> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>VITE_APP_ENV = dev
VITE_APP_TITLE = 我是标题
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>注意：</p> <p>当要读取在 <code>.env.development</code>中配置的变量时，需要确定 <code>vite --mode development</code>的 <code>mode</code>参数为 <code>development</code></p> <h4 id="在-vite-config-ts中"><a href="#在-vite-config-ts中" class="header-anchor">#</a> 在 <code>vite.config.ts</code>中</h4> <p>可以用函数式的写法直接读取到 <code>mode</code>参数（如果你想在该文件中读取<code>.env.development</code>中的配置信息，可以通过结合<code>dotenv</code>库实现）</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> UserConfig<span class="token punctuation">,</span> ConfigEnv <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vite'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> command<span class="token punctuation">,</span> mode <span class="token punctuation">}</span><span class="token operator">:</span> ConfigEnv<span class="token punctuation">)</span><span class="token operator">:</span> UserConfig <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>command<span class="token punctuation">,</span> mode<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="在组件中"><a href="#在组件中" class="header-anchor">#</a> 在组件中</h4> <p><code>console.log('my config env: ', import.meta.env)</code>打印内容如下</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">// console.log(import.meta.env)</span>
<span class="token punctuation">{</span>
  <span class="token constant">BASE_URL</span><span class="token operator">:</span> <span class="token string">&quot;/&quot;</span>
  <span class="token constant">DEV</span><span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token constant">MODE</span><span class="token operator">:</span> <span class="token string">&quot;development&quot;</span>
  <span class="token constant">PROD</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token constant">SSR</span><span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token constant">VITE_APP_ENV</span><span class="token operator">:</span> <span class="token string">&quot;dev&quot;</span>
  <span class="token constant">VITE_APP_TITLE</span><span class="token operator">:</span> <span class="token string">&quot;我是标题&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>注意：</p> <p>配合<code>.env</code>/<code>.env.development</code>/<code>.env.production</code>等文件设置环境变量使用时，变量<code>Key</code>应该以<code>VITE_</code>为前缀</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;script&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vite --mode development&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><blockquote><p>为了防止意外泄漏 env 变量给客户端，只有以 VITE_为前缀的变量才会暴露给 Vite 处理的代码。只会向您的客户端源代码VITE_SOME_KEY公开import.meta.env.VITE_SOME_KEY，但DB_PASSWORD不会。</p></blockquote> <h3 id="批量处理文件"><a href="#批量处理文件" class="header-anchor">#</a> 批量处理文件</h3> <p><code>import.meta.globEager</code></p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">// 读取当前目录下的所有 .ts文件</span>
<span class="token keyword">const</span> modules <span class="token operator">=</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span><span class="token function">globEager</span><span class="token punctuation">(</span><span class="token string">'./**/*.ts'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="ref和reactive"><a href="#ref和reactive" class="header-anchor">#</a> ref和reactive</h2> <p>都可以用来定义响应式数据</p> <h3 id="ref"><a href="#ref" class="header-anchor">#</a> ref</h3> <p>主要用于定义基本类型，使用时需要通过 <code>.value</code> 读取或修改</p> <p>基本类型：除去Object，包括：<code>String</code>、<code>Number</code>、<code>boolean</code>、<code>null</code>、<code>undefined</code></p> <p>控制台打印数据结构为 <code>RefImpl</code></p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">// ref</span>
<span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

count<span class="token punctuation">.</span>value<span class="token operator">++</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>count<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>在定义基本类型时，响应式原理是与 vue2.x类似的 <code>Object.defineProperty()</code>，通过 <code>get</code>、 <code>set</code>读取、修改数据</p> <p>不过，ref也可以定义引用类型的数据，注意，当定义引用类型时，其内部实现则是借助 reactive</p> <p>可以通过打印数据在控制台查看结构，分别为：<code>RefImpl</code>、<code>Proxy</code></p> <h3 id="reactive"><a href="#reactive" class="header-anchor">#</a> reactive</h3> <p><strong>只能</strong>定义引用类型，即Object，包括：<code>Object</code>、<code>Array</code>、<code>Date</code>、<code>function</code>，定义基本类型时会警告</p> <p>使用时，直接通过属性读写</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">// reactive</span>
<span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>count<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

state<span class="token punctuation">.</span>count<span class="token operator">++</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>reactive默认对对象内的所有属性都进行响应式处理，并可以实现深层监听</p> <p>该响应式能力是通过 <code>ES6 Proxy</code>实现的，其可以做到对属性的<strong>新增</strong>、<strong>删除</strong>监听，解决了 <code>defineProperty</code>的缺陷，并且对嵌套属性有着良好的支持，可以轻松实现 <code>a.b.c.d=xx</code>的响应式更新</p> <blockquote><p><code>Proxy</code>与 <code>Reflect</code>均为ES6语法，一般他俩是一起配合使用，可以很好的做到安全优雅的对属性做出劫持更新</p></blockquote> <h3 id="小结"><a href="#小结" class="header-anchor">#</a> 小结</h3> <p>模板 tempalte 会自动解包，在模板中使用时，不需要 <code>.value</code></p> <p>对于<em>引用类型</em>来说，简单理解即：<strong>ref本质也是reactive，ref(obj)等价于reactive({value: obj})</strong>，<code>ref</code> 的底层实现就是 <code>reactive</code></p> <p>可以发现，所谓响应式其实就是对属性的劫持</p> <p><code>ref</code>和<code>reactive</code>定义的数据，每一层都是响应式的</p> <h2 id="watch、watcheffect"><a href="#watch、watcheffect" class="header-anchor">#</a> watch、watchEffect</h2> <p>监听响应式数据的变化</p> <h3 id="watch"><a href="#watch" class="header-anchor">#</a> watch</h3> <p>基本语法和 vue2类似，不过在这里有一些不同的使用方式</p> <h4 id="监听-ref定义的响应式数据（基本类型）"><a href="#监听-ref定义的响应式数据（基本类型）" class="header-anchor">#</a> 监听 ref定义的响应式数据（基本类型）</h4> <ul><li>函数式写法需要 <code>.value</code>，监听的是一个值的变化</li></ul> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> str <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">'abc'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 1. 普通写法</span>
<span class="token comment">// watch可以省略 .value</span>
<span class="token function">watch</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span> <span class="token punctuation">(</span>val<span class="token punctuation">,</span> old<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">{</span> val<span class="token punctuation">,</span> old <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 2. 函数写法</span>
<span class="token function">watch</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> count<span class="token punctuation">.</span>value<span class="token punctuation">,</span>
  <span class="token punctuation">(</span>val<span class="token punctuation">,</span> old<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">{</span> val<span class="token punctuation">,</span> old <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 3. 数组写法</span>
<span class="token function">watch</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>count<span class="token punctuation">.</span>value<span class="token punctuation">,</span> str<span class="token punctuation">.</span>value<span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span>val<span class="token punctuation">,</span> old<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">{</span> val<span class="token punctuation">,</span> old <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h4 id="监听-ref定义的响应式数据（引用类型）"><a href="#监听-ref定义的响应式数据（引用类型）" class="header-anchor">#</a> 监听 ref定义的响应式数据（引用类型）</h4> <ul><li>需明白的是，<code>ref</code>定义引用类型，内部是使用 <code>reactive</code>实现的，因此，需要通过 <code>.value</code>拿到响应式对象，再进行属性监听</li></ul> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> refState <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  count<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  str<span class="token operator">:</span> <span class="token string">'abc'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 1. 普通写法，无效</span>
<span class="token comment">// =&gt; refState.value 有效</span>
<span class="token function">watch</span><span class="token punctuation">(</span>refState<span class="token punctuation">,</span> <span class="token punctuation">(</span>val<span class="token punctuation">,</span> old<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">{</span> val<span class="token punctuation">,</span> old <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 2. 函数写法</span>
<span class="token function">watch</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> refState<span class="token punctuation">.</span>value<span class="token punctuation">.</span>count<span class="token punctuation">,</span>
  <span class="token punctuation">(</span>val<span class="token punctuation">,</span> old<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">{</span> val<span class="token punctuation">,</span> old <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="监听-reactive定义的响应式数据"><a href="#监听-reactive定义的响应式数据" class="header-anchor">#</a> 监听 reactive定义的响应式数据</h4> <ul><li>需要针对属性监听 <code>state.count</code></li></ul> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  count<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  str<span class="token operator">:</span> <span class="token string">'abc'</span><span class="token punctuation">,</span>
  a<span class="token operator">:</span> <span class="token punctuation">{</span>
    b<span class="token operator">:</span> <span class="token punctuation">{</span>
        c<span class="token operator">:</span> <span class="token string">'a-b-c'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 1. 普通写法</span>
<span class="token comment">// 结果：val, old 新旧值相同，</span>
<span class="token comment">// watch(state, (val, old) =&gt; console.log({ val, old }));</span>

<span class="token comment">// 2. 函数写法</span>
<span class="token comment">// 结果：指定属性变化才会触发</span>
<span class="token function">watch</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>value<span class="token punctuation">.</span>a<span class="token punctuation">.</span>b<span class="token punctuation">.</span>c<span class="token punctuation">,</span> <span class="token comment">// 只监听指定的 属性</span>
  <span class="token punctuation">(</span>val<span class="token punctuation">,</span> old<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">{</span> val<span class="token punctuation">,</span> old <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="watcheffect"><a href="#watcheffect" class="header-anchor">#</a> watchEffect</h3> <p>接收一个函数，不需要设置监听对象，该方法会自动接管函数内部使用到的依赖，当依赖发生更新时，触发该函数执行</p> <p>该函数会初始化默认执行一次</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token function">watchEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>

  <span class="token keyword">if</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>count<span class="token operator">&gt;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 只要 count变化，这个 watchEffect函数就会执行一次</span>
    <span class="token comment">// 当 count &gt; 1时，做对应行为</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="watch、watcheffect-小结"><a href="#watch、watcheffect-小结" class="header-anchor">#</a> watch、watchEffect 小结</h3> <p>使用<code>watch</code>时，需要考虑的情况比较多</p> <p><code>watch</code>更强调结果，<code>watchEffect</code>强调过程</p> <p>就用法方面来说 <code>watchEffect</code>似乎更简单易用~</p> <h2 id="shallowref和shallowreactive"><a href="#shallowref和shallowreactive" class="header-anchor">#</a> shallowRef和shallowReactive</h2> <ul><li>递归监听和非递归监听</li></ul> <p><code>ref</code>和<code>reactive</code>都属于递归监听，也就是数据的每一层都是响应式的，如果数据量比较大，非常消耗性能，非递归监听只会监听数据的第一层。</p> <h2 id="script-setup-写法的-props-、context处理方式"><a href="#script-setup-写法的-props-、context处理方式" class="header-anchor">#</a> script setup 写法的 props 、context处理方式</h2> <p>在以 <code>&lt;script setup lang=&quot;ts&quot;&gt;</code>形式使用 setup时，默认整个 script都是setup的函数作用域，我们不必再一一 <code>return</code>定义的每个变量和方法，可以直接使用</p> <p>但，对于 <code>props</code>、<code>emit</code>的定义，以及 <code>ctx</code>属性的获取问题</p> <p>vue也针对此，为我们提供了3个新API</p> <ul><li><code>defineProps</code></li> <li><code>defineEmit</code></li> <li><code>useContext</code></li></ul> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">// 这3个api和setup 的属性一一对应</span>
<span class="token function">setup</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> <span class="token punctuation">{</span> emit<span class="token punctuation">,</span> ctx<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>如果想通过父组件获取子组件的属性，需要在子组件中通过 <code>defineExpose</code>定义需要暴露的属性</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">// 子组件 Child</span>
<span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token function">defineExpose</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  count<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 父组件</span>
<span class="token comment">// &lt;Child ref=&quot;ChildRef&quot; /&gt;</span>
<span class="token keyword">const</span> ChildRef <span class="token operator">=</span> <span class="token generic-function"><span class="token function">ref</span><span class="token generic class-name"><span class="token operator">&lt;</span>RefType<span class="token operator">&lt;</span><span class="token punctuation">{</span> count<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">}</span><span class="token operator">&gt;&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> count <span class="token operator">=</span> ChildRef<span class="token punctuation">.</span>value<span class="token punctuation">.</span>count
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>更多API见官方文档，说的很详细，这里就不再赘述了</p> <h2 id="props-type-类型定义问题"><a href="#props-type-类型定义问题" class="header-anchor">#</a> props Type 类型定义问题</h2> <p>抛开 vue默认的几种基本类型，在一些特殊场景需要定义比较复杂的类型，需要通过 <code>PropType</code> 配合使用</p> <p>如定义菜单路由类型</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code>props<span class="token operator">:</span> <span class="token punctuation">{</span>
    menuData<span class="token operator">:</span> <span class="token punctuation">{</span>
        type<span class="token operator">:</span> <span class="token builtin">Array</span> <span class="token keyword">as</span> PropType<span class="token operator">&lt;</span>MenuDataItem<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
        <span class="token function-variable function">default</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>这里如果按照常规类型 <code>Array</code>很难满足我们的需求（只知道是个数据，但是数据形状并不清楚），原始类型写法很难精确推导各属性的类型定义</p> <h2 id="prop、ref、emit-数据通信"><a href="#prop、ref、emit-数据通信" class="header-anchor">#</a> prop、ref、emit 数据通信</h2> <h3 id="prop"><a href="#prop" class="header-anchor">#</a> prop</h3> <p>强调单项数据流（父=&gt;子），类似react，主要用来传参给子组件</p> <h3 id="ref-2"><a href="#ref-2" class="header-anchor">#</a> ref</h3> <p>两种用法：</p> <ul><li><p>以引用的方式把子组件的实例指给 <code>ref</code>，使得可以在父组件中获取到子组件中的所有属性和方法，可以通过配合 <code>defineExpose</code> API来实现</p></li> <li><p>用于获取DOM元素</p></li></ul> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">// 如：在使用echarts绑定DOM节点时</span>
<span class="token comment">// &lt;div class=&quot;chart-box&quot; ref=&quot;chartRef&quot;&gt;&lt;/div&gt;</span>

<span class="token keyword">const</span> chartRef <span class="token operator">=</span> <span class="token generic-function"><span class="token function">ref</span><span class="token generic class-name"><span class="token operator">&lt;</span>HTMLDivElement <span class="token operator">|</span> <span class="token keyword">null</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
echarts<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token function">unref</span><span class="token punctuation">(</span>chartRef<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="emit"><a href="#emit" class="header-anchor">#</a> emit</h3> <p>主要用于子组件向父组件传递参数和通信<code>emit</code>（子=&gt;父），父组件通过事件方法<code>@event</code>接收</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 父组件 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'getMessage'</span><span class="token punctuation">,</span> <span class="token string">'我是父组件！'</span><span class="token punctuation">)</span>

<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 子组件 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>child @event<span class="token operator">=</span><span class="token string">&quot;handleMethod&quot;</span><span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="jsx-语法"><a href="#jsx-语法" class="header-anchor">#</a> jsx 语法</h2> <p>在使用的过程中发现，jsx配合模板语法有着极大的灵活性，对于jsx语法，有 react开发经验的应该会感到很熟悉，开发体验上很相似</p> <p>但是，对于vue来说，有着得天独厚的的优势，它本身作为模板语法，通过对实例方法的注入，指令的使用等，可以快速而高效的进行开发，在一些场景下， jsx语法 + vue模板语法有着完全不同的体验~</p> <blockquote><p>如：在模板中可以 <code>&lt;div @click=&quot;$router.push('xx')&quot; v-auth=&quot;create&quot;&gt;&lt;/div&gt;</code></p></blockquote> <h3 id="table组件"><a href="#table组件" class="header-anchor">#</a> Table组件</h3> <p>以比较常见的table组件为例，我们封装好可复用的分页逻辑后，再把 <code>columns</code>单出拆分出来用，使用jsx语法封装，根据不同组件使用做不同的配置，这样也更方便维护</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">columnsConfig</span><span class="token punctuation">(</span><span class="token function-variable function">refresh</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ... 其他业务逻辑</span>

  <span class="token keyword">const</span> columns<span class="token operator">:</span> ColumnProps<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      title<span class="token operator">:</span> <span class="token string">'IP地址和端口'</span><span class="token punctuation">,</span>
      dataIndex<span class="token operator">:</span> <span class="token string">'ip'</span><span class="token punctuation">,</span>
      width<span class="token operator">:</span> <span class="token number">150</span><span class="token punctuation">,</span>
      <span class="token function-variable function">customRender</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> record <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>record<span class="token punctuation">.</span>ip<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>record<span class="token punctuation">.</span>port<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      title<span class="token operator">:</span> <span class="token string">'操作'</span><span class="token punctuation">,</span>
      key<span class="token operator">:</span> <span class="token string">'action'</span><span class="token punctuation">,</span>
      width<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
      fixed<span class="token operator">:</span> <span class="token string">'right'</span><span class="token punctuation">,</span>
      <span class="token function-variable function">customRender</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> record <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Space</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Button</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/app/product/detail/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>record<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">详情</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Button</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Divider</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>vertical<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
          </span><span class="token punctuation">{</span>
            record<span class="token punctuation">.</span>isSelf <span class="token operator">&amp;&amp;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Popconfirm</span></span>
              <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>你确定要退出网络吗？<span class="token punctuation">&quot;</span></span>
              <span class="token attr-name">onConfirm</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> fetchApi<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>record<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                  message<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">已申请退出网络</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                  <span class="token comment">// 触发列表更新</span>
                  refresh<span class="token operator">?.</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
              <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
            <span class="token punctuation">&gt;</span></span><span class="token plain-text">
              </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Button</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">删除</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Button</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Popconfirm</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token punctuation">}</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Space</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> columns<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><p>当 action操作列 业务比较复杂时，需要频繁的和其他数据通信，我们也可以把action操作列剥离出，在 vue内部处理，再配合 Table组件的再封装处理</p> <p>Table组件封装</p> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a-table</span> <span class="token attr-name">:columns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>columns<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 函数式写法自定义 操作列 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">#action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{ record }<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>(action, index) in getActions<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>`${index}-${action.label}`<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- 气泡确认框 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a-popconfirm</span>
          <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>action.enable<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">:title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>action?.title<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">@confirm</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>action?.onConfirm(record)<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">@cancel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>action?.onCancel(record)<span class="token punctuation">&quot;</span></span>
        <span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">@click.prevent</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>() =&gt; {}<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>action.type<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ action.label }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a-popconfirm</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- 按钮 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">v-else</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>action?.onClick(record)<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>action.type<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ action.label }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- 分割线 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a-divider</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>vertical<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>index &lt; getActions.length - 1<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a-table</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token comment">// action 操作列</span>
<span class="token keyword">const</span> getActions <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function">toRaw</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>actions<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">hasPermission</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>auth<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> <span class="token punctuation">{</span> popConfirm <span class="token punctuation">}</span> <span class="token operator">=</span> action<span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'link'</span><span class="token punctuation">,</span>
        <span class="token operator">...</span>action<span class="token punctuation">,</span>
        <span class="token operator">...</span><span class="token punctuation">(</span>popConfirm <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">enable</span><span class="token operator">:</span> <span class="token operator">!</span><span class="token operator">!</span>popConfirm<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p>使用</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">// &lt;Table :columns=&quot;columns&quot; :actions=&quot;tableActions&quot;/&gt;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> columns <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token comment">// ...</span>
  <span class="token punctuation">{</span>
    title<span class="token operator">:</span> <span class="token string">'操作'</span><span class="token punctuation">,</span>
    key<span class="token operator">:</span> <span class="token string">'action'</span><span class="token punctuation">,</span>
    width<span class="token operator">:</span> <span class="token number">120</span><span class="token punctuation">,</span>
    slots<span class="token operator">:</span> <span class="token punctuation">{</span> customRender<span class="token operator">:</span> <span class="token string">'action'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

<span class="token keyword">const</span> tableActions <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    label<span class="token operator">:</span> <span class="token string">'编辑'</span><span class="token punctuation">,</span>
    auth<span class="token operator">:</span> AuthEnum<span class="token punctuation">.</span>user_update<span class="token punctuation">,</span> <span class="token comment">// 配置按钮权限</span>
    <span class="token function-variable function">onClick</span><span class="token operator">:</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>row<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      modalState<span class="token punctuation">.</span>visible <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> store<span class="token punctuation">.</span><span class="token function">fetchDetail</span><span class="token punctuation">(</span>row<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">)</span> formModel<span class="token punctuation">.</span>value <span class="token operator">=</span> res<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>这是我在上个项目中实战使用的一点心得，对于开发效率提升还是很明显的，维护起来也是很方便，更多用法也欢迎大家一起交流学习，就目前体验来说vue3很棒~</p> <h2 id="event-bus"><a href="#event-bus" class="header-anchor">#</a> event bus</h2> <p>vue3中移除了实例中挂载 <code>$emit</code>的行为，如果想继续使用可以单独下载对应的 npm包，如：<a href="https://github.com/developit/mitt" target="_blank" rel="noopener noreferrer">mitt<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，该包很轻量，仅 200byte</p> <p>api与用法类似，只是改变为了函数式创建，需要确保单个操作的 emitter创建唯一</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> mitt <span class="token keyword">from</span> <span class="token string">'mitt'</span>

<span class="token keyword">const</span> emitter <span class="token operator">=</span> <span class="token function">mitt</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> emitter
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="二级路径嵌套域名的部署配置"><a href="#二级路径嵌套域名的部署配置" class="header-anchor">#</a> 二级路径嵌套域名的部署配置</h2> <blockquote><p>2022.03.09更新</p></blockquote> <h3 id="简单举例"><a href="#简单举例" class="header-anchor">#</a> 简单举例</h3> <ul><li>无嵌套域名访问时，举例：<code>www.exmple.com</code></li> <li>存在嵌套域名访问时，举例 <code>www.exmple.com/my</code></li></ul> <h3 id="项目配置"><a href="#项目配置" class="header-anchor">#</a> 项目配置</h3> <p>针对生产环境，从<code>vite build</code> 入手</p> <ol><li>直接在 <code>vite.config.ts</code>中配置 <code>base</code>属性为 <code>base: '/my/'</code>（<code>base</code>默认为 <code>/</code>）</li> <li>在 <code>package.json</code>中配置 scripts中的构建命令，动态传参配置 <code>&quot;build&quot;: &quot;vite build --base=/my/&quot;</code></li></ol> <p>以上配置的属性值都可以通过 <code>import.meta.env.BASE_URL</code> 获取到</p> <h3 id="注意"><a href="#注意" class="header-anchor">#</a> 注意</h3> <p>当完成以上配置后，你会发现，通过链接和路由是可以正常访问的，但是存在两个问题</p> <ol><li>通过路由跳转的新的地址栏路径是缺少 <code>/my/</code>路径的</li> <li>手动刷新浏览器会返回 <code>www.exmple.com</code>，以及返回404的情况</li></ol> <p>问题一：</p> <p>是因为我们只配置了静态文件构建生成的路径参数，但是没有配置相关路由的，举例：路由跳转是 <code>router.push('/home')</code>，现在应该跳转为 <code>router.push('/my/home')</code>，这里需要同步配置 <code>route</code>的<code>base</code>属性保持一致。</p> <p>直接在全局实例的时候统一配置即可：</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">// vue3.x 新版本路由通过 createWebHashHistory 函数参数配置</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  history<span class="token operator">:</span> <span class="token function">createWebHashHistory</span><span class="token punctuation">(</span><span class="token string">'/my/'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
  routes<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// vue2.x 老版配置本如下</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  mode<span class="token operator">:</span> <span class="token string">'history'</span><span class="token punctuation">,</span>
  base<span class="token operator">:</span> <span class="token string">'/my/'</span><span class="token punctuation">,</span>
  routes
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>为了方便维护你也可以这样：<code>createWebHashHistory(import.meta.env.BASE_URL)</code></p> <p>问题二：</p> <p>那是因为在history模式下，只是动态的通过js操作window.history来改变浏览器地址栏里的路径，并没有发起http请求，但是当我直接在浏览器里输入这个地址的时候，就一定要对服务器发起http请求，但是这个目标在服务器上又不存在，所以会返回404</p> <p>不过通过以上配置过路由<code>base</code>之后，保持路径和路由一致也一同解决了</p> <h2 id="结语"><a href="#结语" class="header-anchor">#</a> 结语</h2> <p>这篇文章其实相当于自己的学习笔记，也是为了加深印象，在使用的过程中记录了遇到的一些问题，希望可以给自己和大家带来一些帮助。就内容而言属于入门使用水平，目前暂未涉及到深水区，本文会根据使用情况持续更新</p></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com/JS-banana/vuepress/edit/master/docs/01.前端/03.框架/01.vue3使用总结.md" target="_blank" rel="noopener noreferrer">编辑</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="tags"><a href="/blog/tags/?tag=vue" title="标签">#vue</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2025/09/01, 09:19:57</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/blog/pages/eb2149/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">【前端组件化】系列第二篇</div></a> <a href="/blog/pages/394c89/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">vue编译为js的研究</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/blog/pages/eb2149/" class="prev">【前端组件化】系列第二篇</a></span> <span class="next"><a href="/blog/pages/394c89/">vue编译为js的研究</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/blog/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/blog/pages/e4bf0d/"><div>说说call、apply、bind是如何改变this的</div></a> <span>03-29</span></dt></dl><dl><dd>02</dd> <dt><a href="/blog/pages/d865ca/"><div>从输入 URL 到页面加载完成发生了什么？</div></a> <span>03-29</span></dt></dl><dl><dd>03</dd> <dt><a href="/blog/pages/8d9372/"><div>JavaScript进阶—— new 的执行过程</div></a> <span>03-26</span></dt></dl> <dl><dd></dd> <dt><a href="/blog/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:213018@163.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/JS-banana" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://juejin.cn/user/1204720476890477" title="掘金" target="_blank" class="iconfont icon-juejin"></a></div> <span>sunss</span> 
    | © 2020.08-2025.09
    <span><a href="https://beian.miit.gov.cn/" target="_blank">浙ICP备2022002957号-1</a></span> <div class="cloud"><span id="timeDate">载入天数...</span> <span id="times">载入时分秒...</span>
     | 
    <span id="busuanzi_container_site_pv">
      总访问量 <span id="busuanzi_value_site_pv"></span> 次
    </span></div> <div class="cloud"><a href="https://cloud.tencent.com/" target="_blank"><img src="https://cloudcache.tencent-cloud.com/qcloud/portal/kit/images/slice/logo.f0c9ade4.svg" alt></a>
    提供CDN加速/云存储服务
  </div></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">跟随系统</li><li class="iconfont icon-rijianmoshi">浅色模式</li><li class="iconfont icon-yejianmoshi">深色模式</li><li class="iconfont icon-yuedu">阅读模式</li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><canvas id="erraticSignals-canvas" data-v-71426c40></canvas><div></div></div></div>
    <script src="/blog/assets/js/app.8943bfc3.js" defer></script><script src="/blog/assets/js/2.6ed24f91.js" defer></script><script src="/blog/assets/js/3.c0dae15f.js" defer></script><script src="/blog/assets/js/31.a2a4b158.js" defer></script>
  </body>
</html>